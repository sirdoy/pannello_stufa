---
phase: 11-foundation-tooling
plan: 03
type: execute
wave: 2
depends_on:
  - 11-01
files_modified:
  - eslint.config.mjs
  - package.json
  - app/globals.css
autonomous: true

must_haves:
  truths:
    - "ESLint warns on arbitrary color values in Tailwind classes"
    - "Design tokens are centralized with semantic aliases"
    - "Semantic tokens map intentions to specific color values"
  artifacts:
    - path: "eslint.config.mjs"
      contains: "eslint-plugin-tailwindcss"
    - path: "app/globals.css"
      contains: "--color-bg-primary"
  key_links:
    - from: "eslint.config.mjs"
      to: "eslint-plugin-tailwindcss"
      via: "plugin import"
      pattern: "tailwindcss"
    - from: "app/globals.css"
      to: "semantic tokens"
      via: "@theme directive"
      pattern: "--color-bg-.*var\\(--color-"
---

<objective>
Configure ESLint for design token enforcement and audit/consolidate design tokens

Purpose: ESLint rules enforce consistent token usage by warning on hard-coded colors. The token audit adds semantic aliases (bg-primary, text-primary, etc.) that map design intentions to specific values, enabling future theming and consistent component APIs.

Output: ESLint configuration with tailwindcss plugin, semantic design token aliases in globals.css
</objective>

<execution_context>
@/Users/federicomanfredi/.claude/get-shit-done/workflows/execute-plan.md
@/Users/federicomanfredi/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/11-foundation-tooling/11-RESEARCH.md

Prior plan context:
- 11-01 installed CVA, clsx, tailwind-merge
- cn() function available at lib/utils/cn.js

Reference files:
- eslint.config.mjs (current ESLint config)
- app/globals.css (current design tokens in @theme)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install eslint-plugin-tailwindcss</name>
  <files>package.json</files>
  <action>
Install the ESLint plugin for Tailwind CSS:

```bash
npm install --save-dev eslint-plugin-tailwindcss
```

Version to install: ^3.17.0 (latest compatible with ESLint 9)

Note: This is a devDependency because it's only used during linting.
  </action>
  <verify>
- `npm ls eslint-plugin-tailwindcss` shows version ^3.17.x
- Package appears in package.json devDependencies
  </verify>
  <done>
eslint-plugin-tailwindcss installed in devDependencies
  </done>
</task>

<task type="auto">
  <name>Task 2: Configure ESLint rules for token enforcement</name>
  <files>eslint.config.mjs</files>
  <action>
Update eslint.config.mjs to add the tailwindcss plugin and rules:

```javascript
import { dirname } from "path";
import { fileURLToPath } from "url";
import { FlatCompat } from "@eslint/eslintrc";
import tailwindcss from "eslint-plugin-tailwindcss";

const __filename = fileURLToPath(import.meta.url);
const __dirname = dirname(__filename);

const compat = new FlatCompat({
  baseDirectory: __dirname,
});

const eslintConfig = [
  ...compat.extends("next/core-web-vitals"),
  {
    plugins: {
      tailwindcss,
    },
    rules: {
      // Block arbitrary color values - enforce design tokens
      // Start with "warn" to establish baseline, promote to "error" after cleanup
      "tailwindcss/no-arbitrary-value": ["warn", {
        // Allow arbitrary values for properties that legitimately need flexibility
        ignoredProperties: [
          "content",           // CSS content property
          "grid-template-columns", // Grid layouts
          "grid-template-rows",    // Grid layouts
          "animation",         // Custom animations
          "box-shadow",        // Complex shadows (until all shadows use tokens)
        ],
      }],

      // Enforce consistent class ordering for readability
      "tailwindcss/classnames-order": "warn",

      // Enforce negative values use negative prefix (-mt-4 not mt-[-4px])
      "tailwindcss/enforces-negative-arbitrary-values": "warn",

      // Warn on shorthand conflicts (p-4 and px-2 together)
      "tailwindcss/enforces-shorthand": "warn",

      // Warn on redundant migration patterns
      "tailwindcss/migration-from-tailwind-2": "warn",

      // Ensure custom classes don't conflict with Tailwind
      "tailwindcss/no-custom-classname": "off", // Allow custom classes from globals.css
    },
  },
];

export default eslintConfig;
```

Key configuration choices:
1. `no-arbitrary-value`: "warn" to start (not "error") - allows gradual cleanup
2. `ignoredProperties`: Legitimate cases where arbitrary values are needed
3. `no-custom-classname`: "off" because we have custom classes in globals.css
4. All rules start as "warn" to avoid breaking the build during transition
  </action>
  <verify>
- eslint.config.mjs imports eslint-plugin-tailwindcss
- eslint.config.mjs has tailwindcss plugin configured
- eslint.config.mjs has no-arbitrary-value rule set to "warn"
- `npm run lint` runs without configuration errors
  </verify>
  <done>
ESLint configured with tailwindcss plugin and rules for design token enforcement (warnings mode)
  </done>
</task>

<task type="auto">
  <name>Task 3: Add semantic design token aliases to globals.css</name>
  <files>app/globals.css</files>
  <action>
Add semantic token aliases inside the existing @theme block in app/globals.css. Add this section AFTER the existing color definitions (after --color-neutral-950 mapping) and BEFORE the typography section:

```css
  /* ===== SEMANTIC TOKEN ALIASES ===== */
  /* These map design intentions to specific color values */
  /* Use these in components for consistent theming */

  /* Background tokens */
  --color-bg-primary: var(--color-slate-950);
  --color-bg-secondary: var(--color-slate-900);
  --color-bg-surface: var(--color-slate-850);
  --color-bg-elevated: var(--color-slate-800);
  --color-bg-muted: var(--color-slate-700);

  /* Text tokens */
  --color-text-primary: var(--color-slate-100);
  --color-text-secondary: var(--color-slate-200);
  --color-text-tertiary: var(--color-slate-300);
  --color-text-muted: var(--color-slate-400);
  --color-text-disabled: var(--color-slate-500);

  /* Border tokens */
  --color-border-default: rgba(255, 255, 255, 0.06);
  --color-border-hover: rgba(255, 255, 255, 0.1);
  --color-border-focus: rgba(255, 255, 255, 0.15);
  --color-border-muted: rgba(255, 255, 255, 0.04);

  /* Accent tokens (map to ember for primary actions) */
  --color-accent-primary: var(--color-ember-500);
  --color-accent-primary-hover: var(--color-ember-400);
  --color-accent-primary-active: var(--color-ember-600);

  /* Interactive state tokens */
  --color-interactive-hover: rgba(255, 255, 255, 0.06);
  --color-interactive-active: rgba(255, 255, 255, 0.1);
  --color-interactive-selected: rgba(237, 111, 16, 0.15);

  /* Focus ring tokens */
  --color-focus-ring: rgba(237, 111, 16, 0.5);
  --color-focus-ring-offset: var(--color-slate-900);

  /* Overlay tokens */
  --color-overlay-backdrop: rgba(12, 10, 9, 0.8);
  --color-overlay-scrim: rgba(0, 0, 0, 0.5);
```

Also add light mode overrides. Add a new @theme block inside the existing `html:not(.dark)` media query pattern at the end of @layer base (around line 276), or create a new section:

```css
/* ===== LIGHT MODE SEMANTIC OVERRIDES ===== */
@layer base {
  html:not(.dark) {
    /* Background overrides */
    --color-bg-primary: var(--color-slate-50);
    --color-bg-secondary: var(--color-slate-100);
    --color-bg-surface: var(--color-slate-200);
    --color-bg-elevated: white;
    --color-bg-muted: var(--color-slate-300);

    /* Text overrides */
    --color-text-primary: var(--color-slate-900);
    --color-text-secondary: var(--color-slate-800);
    --color-text-tertiary: var(--color-slate-700);
    --color-text-muted: var(--color-slate-600);
    --color-text-disabled: var(--color-slate-400);

    /* Border overrides */
    --color-border-default: rgba(0, 0, 0, 0.06);
    --color-border-hover: rgba(0, 0, 0, 0.1);
    --color-border-focus: rgba(0, 0, 0, 0.15);
    --color-border-muted: rgba(0, 0, 0, 0.04);

    /* Interactive overrides */
    --color-interactive-hover: rgba(0, 0, 0, 0.04);
    --color-interactive-active: rgba(0, 0, 0, 0.08);
    --color-interactive-selected: rgba(237, 111, 16, 0.1);

    /* Focus ring overrides */
    --color-focus-ring-offset: var(--color-slate-50);

    /* Overlay overrides */
    --color-overlay-backdrop: rgba(250, 250, 249, 0.9);
    --color-overlay-scrim: rgba(0, 0, 0, 0.3);
  }
}
```

These semantic tokens enable:
1. Consistent naming across components (bg-primary vs bg-slate-950)
2. Easy theme switching (change one variable, all components update)
3. Clear design intent (bg-elevated is clearer than bg-slate-800)
  </action>
  <verify>
- app/globals.css contains semantic token section
- Tokens include: bg-primary, text-primary, border-default, accent-primary, focus-ring
- Light mode overrides exist for key semantic tokens
- CSS is valid (no syntax errors when page loads)
  </verify>
  <done>
Semantic design token aliases added to globals.css with dark mode defaults and light mode overrides
  </done>
</task>

</tasks>

<verification>
1. ESLint plugin: `npm ls eslint-plugin-tailwindcss`
2. Lint runs: `npm run lint` (should complete, may show warnings)
3. Tokens accessible: In browser DevTools, check computed styles show --color-bg-primary resolving to slate-950
4. Light mode tokens: Toggle html.dark class and verify tokens change
</verification>

<success_criteria>
- eslint-plugin-tailwindcss installed in package.json devDependencies
- eslint.config.mjs has tailwindcss plugin with no-arbitrary-value rule
- app/globals.css has semantic token aliases (bg-primary, text-primary, etc.)
- Light mode semantic overrides defined
- `npm run lint` completes without configuration errors
</success_criteria>

<output>
After completion, create `.planning/phases/11-foundation-tooling/11-03-SUMMARY.md`
</output>
