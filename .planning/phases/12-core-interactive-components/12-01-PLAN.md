---
phase: 12-core-interactive-components
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - app/components/ui/Checkbox.js
  - app/components/ui/Switch.js
  - app/components/ui/Toggle.js
  - app/components/ui/__tests__/Checkbox.test.js
  - app/components/ui/__tests__/Switch.test.js
  - app/components/ui/index.js
autonomous: true

must_haves:
  truths:
    - "User can toggle Checkbox with Space/Enter keys"
    - "User can toggle Switch with Space/Enter keys"
    - "Checkbox supports indeterminate state"
    - "Switch animates smoothly on state change (250ms)"
    - "Focus ring shows ember glow on both components"
  artifacts:
    - path: "app/components/ui/Checkbox.js"
      provides: "Radix-based Checkbox with CVA variants"
      contains: "@radix-ui/react-checkbox"
    - path: "app/components/ui/Switch.js"
      provides: "Radix-based Switch with CVA variants"
      contains: "@radix-ui/react-switch"
    - path: "app/components/ui/__tests__/Checkbox.test.js"
      provides: "Checkbox a11y tests"
      contains: "toHaveNoViolations"
    - path: "app/components/ui/__tests__/Switch.test.js"
      provides: "Switch a11y tests"
      contains: "toHaveNoViolations"
  key_links:
    - from: "Checkbox.js"
      to: "@radix-ui/react-checkbox"
      via: "Radix Checkbox.Root + Checkbox.Indicator"
    - from: "Switch.js"
      to: "@radix-ui/react-switch"
      via: "Radix Switch.Root + Switch.Thumb"
    - from: "both components"
      to: "cn() utility"
      via: "import { cn } from '@/lib/utils/cn'"
---

<objective>
Build accessible Checkbox and Switch components using Radix UI primitives with CVA variants.

Purpose: Replace existing custom implementations with Radix-based components that provide full WAI-ARIA compliance, keyboard navigation, and consistent Ember Noir styling.

Output: Two production-ready form controls (Checkbox, Switch) with a11y tests.
</objective>

<execution_context>
@/Users/federicomanfredi/.claude/get-shit-done/workflows/execute-plan.md
@/Users/federicomanfredi/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/12-core-interactive-components/12-CONTEXT.md
@.planning/phases/12-core-interactive-components/12-RESEARCH.md
@app/components/ui/Checkbox.js
@app/components/ui/Toggle.js
@lib/utils/cn.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Checkbox with Radix Primitive</name>
  <files>
    - app/components/ui/Checkbox.js
    - app/components/ui/__tests__/Checkbox.test.js
  </files>
  <action>
Replace existing Checkbox with Radix-based implementation:

1. **Component structure** (Checkbox.js):
   - Import `@radix-ui/react-checkbox` (already installed)
   - Create `checkboxVariants` with CVA for size (sm/md/lg) and variant (primary/ember/ocean/sage/flame)
   - Use `forwardRef` pattern for ref forwarding
   - Wrap `CheckboxPrimitive.Root` with CVA classes
   - Use `CheckboxPrimitive.Indicator` with Check/Minus icons from lucide-react
   - Support `checked`, `onCheckedChange`, `disabled`, `label`, `size`, `variant` props
   - Indeterminate state via `checked="indeterminate"`

2. **Styling (Ember Noir)**:
   - Base: `rounded-md border-2 transition-all duration-200`
   - Focus: `focus-visible:ring-2 focus-visible:ring-ember-500/50 focus-visible:ring-offset-2 focus-visible:ring-offset-slate-900`
   - Light mode: `[html:not(.dark)_&]:focus-visible:ring-offset-slate-50`
   - Checked state: `data-[state=checked]:bg-ember-500 data-[state=checked]:border-ember-500`
   - Indeterminate: `data-[state=indeterminate]:bg-ember-500 data-[state=indeterminate]:border-ember-500`
   - Disabled: `disabled:opacity-50 disabled:cursor-not-allowed`
   - Touch target: Minimum 44px via wrapper padding or size variant

3. **API compatibility**:
   - Maintain `onChange` prop as alias for `onCheckedChange` (backwards compat)
   - Maintain `label`, `id`, `name`, `value` props
   - Maintain `indeterminate` boolean prop (convert to `checked="indeterminate"`)

4. **Tests** (Checkbox.test.js):
   - Import `axe, toHaveNoViolations` from jest-axe
   - Test unchecked state has no a11y violations
   - Test checked state has no a11y violations
   - Test indeterminate state has no a11y violations
   - Test keyboard interaction (Space toggles)
   - Test disabled state

Do NOT use arbitrary values (no `bg-[#color]`). Use design tokens and cn() for class merging.
  </action>
  <verify>
npm test -- --testPathPattern="Checkbox" --passWithNoTests
  </verify>
  <done>
Checkbox renders in all states (unchecked/checked/indeterminate), toggles with Space/Enter, passes jest-axe, shows ember glow focus ring.
  </done>
</task>

<task type="auto">
  <name>Task 2: Switch with Radix Primitive</name>
  <files>
    - app/components/ui/Switch.js
    - app/components/ui/Toggle.js
    - app/components/ui/__tests__/Switch.test.js
    - app/components/ui/index.js
  </files>
  <action>
Create new Switch component and update Toggle as re-export:

1. **Component structure** (Switch.js):
   - Import `@radix-ui/react-switch` (already installed)
   - Create `switchVariants` with CVA for size (sm/md/lg) and variant (ember/ocean/sage)
   - Use `forwardRef` pattern
   - Wrap `SwitchPrimitive.Root` with CVA classes
   - Use `SwitchPrimitive.Thumb` for sliding indicator
   - Support `checked`, `onCheckedChange`, `disabled`, `size`, `variant` props
   - Support `aria-label` or `aria-labelledby` for accessibility

2. **Styling (Ember Noir)**:
   - Track unchecked: `bg-slate-700 [html:not(.dark)_&]:bg-slate-300`
   - Track checked (ember): `data-[state=checked]:bg-gradient-to-r data-[state=checked]:from-ember-500 data-[state=checked]:to-flame-600`
   - Track checked (ocean): `data-[state=checked]:bg-gradient-to-r data-[state=checked]:from-ocean-500 data-[state=checked]:to-ocean-600`
   - Thumb: `bg-white shadow-lg rounded-full transition-transform duration-250`
   - Thumb translate: Use `data-[state=checked]:translate-x-*` for animation
   - Focus: `focus-visible:ring-2 focus-visible:ring-ember-500/50 focus-visible:ring-offset-2`
   - Disabled: `disabled:opacity-50 disabled:cursor-not-allowed`
   - Animation: `transition-all duration-250` (per CONTEXT decision)

3. **Size configuration**:
   - sm: track h-6 w-11, thumb h-5 w-5, translate-x-5 when checked
   - md: track h-8 w-14, thumb h-7 w-7, translate-x-6 when checked
   - lg: track h-10 w-18, thumb h-9 w-9, translate-x-8 when checked

4. **Toggle.js update**:
   - Convert to re-export: `export { default } from './Switch';`
   - Add deprecation comment: "// @deprecated Use Switch instead. Toggle is kept for backwards compatibility."

5. **Index update** (index.js):
   - Add `export { default as Switch } from './Switch';`
   - Keep Toggle export for backwards compat

6. **Tests** (Switch.test.js):
   - Test unchecked state has no a11y violations
   - Test checked state has no a11y violations
   - Test keyboard interaction (Space toggles)
   - Test disabled state
   - Test all size variants render correctly
   - Test animation class is present (duration-250)

Do NOT use arbitrary values. Use cn() for class merging.
  </action>
  <verify>
npm test -- --testPathPattern="Switch" --passWithNoTests
  </verify>
  <done>
Switch renders in all states, animates smoothly (250ms), toggles with Space/Enter, passes jest-axe. Toggle re-exports Switch for backwards compatibility.
  </done>
</task>

</tasks>

<verification>
```bash
# All tests pass
npm test -- --testPathPattern="(Checkbox|Switch)" --passWithNoTests

# Components render without errors
# (Manual check in dev server or via existing pages that use these components)
```
</verification>

<success_criteria>
1. Checkbox supports unchecked/checked/indeterminate states with visual indicators
2. Checkbox toggles via Space and Enter keys
3. Switch animates smoothly on toggle (250ms transition)
4. Switch toggles via Space and Enter keys
5. Both components show ember glow focus ring
6. Both components pass jest-axe accessibility tests
7. Toggle.js re-exports Switch for backwards compatibility
8. All styling uses design tokens (no arbitrary values)
</success_criteria>

<output>
After completion, create `.planning/phases/12-core-interactive-components/12-01-SUMMARY.md`
</output>
