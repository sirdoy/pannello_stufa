---
phase: 12-core-interactive-components
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - app/components/ui/RadioGroup.js
  - app/components/ui/Select.js
  - app/components/ui/__tests__/RadioGroup.test.js
  - app/components/ui/__tests__/Select.test.js
  - app/components/ui/index.js
  - package.json
autonomous: true

must_haves:
  truths:
    - "User can navigate RadioGroup options with Arrow keys"
    - "User can select RadioGroup option with Space"
    - "User can open Select dropdown with Space/Enter"
    - "User can navigate Select options with Arrow keys"
    - "User can select Select option with Enter"
    - "Focus ring shows ember glow on both components"
  artifacts:
    - path: "app/components/ui/RadioGroup.js"
      provides: "Radix-based RadioGroup with CVA variants"
      contains: "@radix-ui/react-radio-group"
    - path: "app/components/ui/Select.js"
      provides: "Radix-based Select with CVA variants"
      contains: "@radix-ui/react-select"
    - path: "app/components/ui/__tests__/RadioGroup.test.js"
      provides: "RadioGroup a11y tests"
      contains: "toHaveNoViolations"
    - path: "app/components/ui/__tests__/Select.test.js"
      provides: "Select a11y tests"
      contains: "toHaveNoViolations"
  key_links:
    - from: "RadioGroup.js"
      to: "@radix-ui/react-radio-group"
      via: "Radix RadioGroup.Root + RadioGroup.Item"
    - from: "Select.js"
      to: "@radix-ui/react-select"
      via: "Radix Select.Root + Select.Trigger + Select.Content"
    - from: "both components"
      to: "cn() utility"
      via: "import { cn } from '@/lib/utils/cn'"
---

<objective>
Build accessible RadioGroup and Select components using Radix UI primitives with CVA variants.

Purpose: Provide single-selection patterns for forms - RadioGroup for visible options, Select for dropdown selection. Both need full keyboard navigation and WAI-ARIA compliance.

Output: Two production-ready selection controls (RadioGroup, Select) with a11y tests.
</objective>

<execution_context>
@/Users/federicomanfredi/.claude/get-shit-done/workflows/execute-plan.md
@/Users/federicomanfredi/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/12-core-interactive-components/12-CONTEXT.md
@.planning/phases/12-core-interactive-components/12-RESEARCH.md
@app/components/ui/Select.js
@lib/utils/cn.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: RadioGroup with Radix Primitive</name>
  <files>
    - app/components/ui/RadioGroup.js
    - app/components/ui/__tests__/RadioGroup.test.js
    - app/components/ui/index.js
    - package.json
  </files>
  <action>
Install dependency and create RadioGroup component:

1. **Install dependency**:
   ```bash
   npm install @radix-ui/react-radio-group@^1.3.2
   ```

2. **Component structure** (RadioGroup.js):
   - Import `@radix-ui/react-radio-group`
   - Create compound component pattern with RadioGroup.Root, RadioGroup.Item
   - Create `radioGroupVariants` with CVA for variant (ember/ocean/sage) and size (sm/md/lg)
   - Use `forwardRef` pattern for both Root and Item
   - Support `value`, `onValueChange`, `disabled`, `orientation` props on Root
   - Support `value`, `disabled` props on Item
   - Default orientation: vertical (per CONTEXT decision)

3. **Styling (Ember Noir)**:
   - Root container: `flex flex-col gap-3` (vertical stack default)
   - Item wrapper: `flex items-center gap-3`
   - Radio circle base: `w-5 h-5 rounded-full border-2 border-slate-500 transition-all duration-200`
   - Radio circle focus: `focus-visible:ring-2 focus-visible:ring-ember-500/50 focus-visible:ring-offset-2`
   - Radio circle checked (ember): `data-[state=checked]:border-ember-500`
   - Radio indicator (inner dot): `h-2.5 w-2.5 rounded-full bg-ember-500` (only visible when checked)
   - Light mode: `[html:not(.dark)_&]:border-slate-400 [html:not(.dark)_&]:data-[state=checked]:border-ember-600`
   - Disabled: `data-[disabled]:opacity-50 data-[disabled]:cursor-not-allowed`
   - Touch target: Wrapper padding ensures 44px minimum

4. **Label pattern**:
   - Each Item can have a label prop or children
   - Label clicks should select the radio
   - Use Radix Label primitive or native label with htmlFor

5. **Export pattern**:
   - Named exports: `RadioGroup`, `RadioGroupItem`
   - Default export: RadioGroup with Item attached as `RadioGroup.Item`

6. **Index update** (index.js):
   - Add `export { default as RadioGroup, RadioGroupItem } from './RadioGroup';`

7. **Tests** (RadioGroup.test.js):
   - Test initial state with no selection has no a11y violations
   - Test with selected value has no a11y violations
   - Test Arrow key navigation (Up/Down changes selection)
   - Test disabled group cannot be interacted with
   - Test single item disabled while others work

Do NOT use arbitrary values. Use cn() for class merging.
  </action>
  <verify>
npm test -- --testPathPattern="RadioGroup" --passWithNoTests
  </verify>
  <done>
RadioGroup renders with multiple options, navigates with Arrow keys (roving tabindex), selects with Space, passes jest-axe. Default vertical layout per CONTEXT decision.
  </done>
</task>

<task type="auto">
  <name>Task 2: Select with Radix Primitive</name>
  <files>
    - app/components/ui/Select.js
    - app/components/ui/__tests__/Select.test.js
    - app/components/ui/index.js
  </files>
  <action>
Replace existing Select with Radix-based implementation:

1. **Component structure** (Select.js):
   - Import `@radix-ui/react-select` (already installed)
   - Create compound component pattern with Select.Root, Select.Trigger, Select.Content, Select.Item, Select.Value, Select.Group, Select.Label
   - Create `selectTriggerVariants` with CVA for variant (default/ember/ocean)
   - Create `selectItemVariants` with CVA for selected state
   - Use `forwardRef` pattern for Trigger, Content, Item

2. **API compatibility layer**:
   - Maintain simple API: `<Select options={[]} value={} onChange={} />`
   - Internal mapping: `options` array -> SelectItem children
   - Internal mapping: `onChange(event)` wrapper around `onValueChange(value)`
   - Keep `label`, `icon`, `disabled`, `variant`, `className` props

3. **Compound component exports** (for advanced usage):
   - `SelectRoot`, `SelectTrigger`, `SelectContent`, `SelectItem`, `SelectValue`, `SelectGroup`, `SelectLabel`
   - Default export maintains simple API

4. **Styling (Ember Noir)**:
   - Trigger: `w-full px-4 py-4 rounded-xl bg-slate-800/60 backdrop-blur-xl border border-slate-700/50`
   - Trigger focus: `focus-visible:ring-2 focus-visible:ring-ember-500/50 focus-visible:border-ember-500/60`
   - Trigger light mode: `[html:not(.dark)_&]:bg-white/80 [html:not(.dark)_&]:border-slate-300/60`
   - Content: `bg-slate-800/95 backdrop-blur-2xl border border-slate-700/60 rounded-xl shadow-lg`
   - Content positioning: `position="popper" sideOffset={4}` for proper dropdown placement
   - Content light mode: `[html:not(.dark)_&]:bg-white/95 [html:not(.dark)_&]:border-slate-200`
   - Item: `px-4 py-3 cursor-pointer transition-colors duration-150`
   - Item hover: `data-[highlighted]:bg-slate-700/50 [html:not(.dark)_&]:data-[highlighted]:bg-slate-100`
   - Item selected: `data-[state=checked]:bg-ember-900/40 data-[state=checked]:text-ember-300`
   - Item disabled: `data-[disabled]:opacity-40 data-[disabled]:cursor-not-allowed`
   - ChevronDown icon in trigger with rotation animation on open

5. **Portal usage**:
   - Wrap Content in `Select.Portal` to prevent z-index issues
   - Ensure dropdown renders at document root level

6. **Typeahead**:
   - Radix Select has built-in typeahead (user types letter, jumps to matching option)
   - No additional code needed - it's automatic

7. **Note on searchable**:
   - Per RESEARCH, Radix Select has typeahead but no visible search input
   - `searchable={true}` prop: Log warning that searchable requires Combobox pattern (future work)
   - For now, typeahead is the search experience

8. **Tests** (Select.test.js):
   - Update existing tests to work with Radix-based Select
   - Test closed state has no a11y violations
   - Test open state has no a11y violations
   - Test keyboard: Space/Enter opens dropdown
   - Test keyboard: Arrow keys navigate options
   - Test keyboard: Enter selects option
   - Test keyboard: Escape closes dropdown
   - Test disabled state

Do NOT use arbitrary values. Use cn() for class merging.
  </action>
  <verify>
npm test -- --testPathPattern="Select" --passWithNoTests
  </verify>
  <done>
Select opens with Space/Enter, navigates with Arrow keys, selects with Enter, closes with Escape, passes jest-axe. Simple API maintained for backwards compatibility, compound components available for advanced usage.
  </done>
</task>

</tasks>

<verification>
```bash
# RadioGroup package installed
npm ls @radix-ui/react-radio-group

# All tests pass
npm test -- --testPathPattern="(RadioGroup|Select)" --passWithNoTests
```
</verification>

<success_criteria>
1. RadioGroup renders with multiple options in vertical layout
2. RadioGroup navigates with Arrow Up/Down keys (roving tabindex)
3. RadioGroup selects with Space key
4. Select opens with Space/Enter keys
5. Select navigates options with Arrow Up/Down keys
6. Select selects option with Enter key
7. Select closes with Escape key
8. Both components show ember glow focus ring
9. Both components pass jest-axe accessibility tests
10. Select maintains backwards-compatible simple API
11. All styling uses design tokens (no arbitrary values)
</success_criteria>

<output>
After completion, create `.planning/phases/12-core-interactive-components/12-02-SUMMARY.md`
</output>
