---
phase: 13-foundation-refactoring
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - app/components/ui/Label.js
  - app/components/ui/Divider.js
  - app/components/ui/__tests__/Label.test.js
  - app/components/ui/__tests__/Divider.test.js
autonomous: true

must_haves:
  truths:
    - "Label component wraps Radix UI Label primitive for accessible form association"
    - "Label supports CVA variants (default, muted, required)"
    - "Divider component uses CVA for variants (solid, dashed, gradient)"
    - "Divider supports horizontal/vertical orientation and spacing options"
    - "Both components pass jest-axe accessibility tests"
  artifacts:
    - path: "app/components/ui/Label.js"
      provides: "Radix Label wrapper with CVA variants"
      exports: ["default", "Label", "labelVariants"]
    - path: "app/components/ui/Divider.js"
      provides: "CVA Divider with orientation support"
      exports: ["default", "Divider", "dividerVariants"]
    - path: "app/components/ui/__tests__/Label.test.js"
      provides: "Label a11y and variant tests"
      contains: "toHaveNoViolations"
    - path: "app/components/ui/__tests__/Divider.test.js"
      provides: "Divider variant and orientation tests"
  key_links:
    - from: "Label.js"
      to: "@radix-ui/react-label"
      via: "Radix primitive import"
      pattern: "import.*LabelPrimitive.*from.*@radix-ui/react-label"
---

<objective>
Create Label component (COMP-09) and refactor Divider component (COMP-10) with CVA patterns.

Purpose: Label enables accessible form control association; Divider provides consistent visual separators.
Output: New Label component with Radix primitive; refactored Divider with CVA variants.
</objective>

<execution_context>
@/Users/federicomanfredi/.claude/get-shit-done/workflows/execute-plan.md
@/Users/federicomanfredi/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/13-foundation-refactoring/13-CONTEXT.md
@.planning/phases/13-foundation-refactoring/13-RESEARCH.md

# Reference Phase 12 CVA pattern
@app/components/ui/Checkbox.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Label component with Radix primitive</name>
  <files>app/components/ui/Label.js</files>
  <action>
Create new Label.js wrapping Radix UI Label primitive:

1. Add 'use client' directive
2. Import forwardRef, * as LabelPrimitive from '@radix-ui/react-label', cva, cn
3. Create labelVariants with cva():
   - Base classes: font-medium font-display select-none
   - variants.size: sm (text-xs), md (text-sm), lg (text-base)
   - variants.variant:
     - default: text-slate-300 + light mode text-slate-700
     - muted: text-slate-400 + light mode text-slate-500
     - required: default color + after:content-["*"] after:ml-0.5 after:text-ember-500
   - defaultVariants: size='md', variant='default'

4. Create Label component with forwardRef:
   ```js
   const Label = forwardRef(({ className, size, variant, ...props }, ref) => (
     <LabelPrimitive.Root
       ref={ref}
       className={cn(labelVariants({ size, variant }), className)}
       {...props}
     />
   ));
   Label.displayName = 'Label';
   ```

5. Export both named and default:
   ```js
   export { Label, labelVariants };
   export default Label;
   ```

Key: Radix Label automatically handles htmlFor association when used with form controls.
  </action>
  <verify>File exists with Radix import, labelVariants CVA, forwardRef wrapper</verify>
  <done>Label component wraps Radix primitive with CVA variants for accessible form association</done>
</task>

<task type="auto">
  <name>Task 2: Refactor Divider with CVA variants</name>
  <files>app/components/ui/Divider.js</files>
  <action>
Refactor existing Divider.js to use CVA pattern:

1. Add 'use client' directive
2. Import forwardRef, cva, cn
3. Create dividerVariants with cva():
   - Base classes: (minimal - most styling handled per orientation)
   - variants.variant:
     - solid: bg-slate-700 + light mode bg-slate-300
     - dashed: border-dashed border-slate-600 + light mode border-slate-300
     - gradient: bg-gradient-to-r from-transparent via-slate-600/50 to-transparent + light mode
   - variants.spacing:
     - small: (handled by wrapper based on orientation)
     - medium: (handled by wrapper)
     - large: (handled by wrapper)
   - defaultVariants: variant='solid', spacing='medium'

4. Refactor component to use forwardRef:
   - Horizontal: h-px with variant classes
   - Vertical: w-px h-full with variant classes
   - With label: absolute inset-0 pattern with label badge

5. Keep label pill styling (backdrop-blur, rounded-full, etc.)

6. Export both named and default:
   ```js
   export { Divider, dividerVariants };
   export default Divider;
   ```

Note: spacing still handled conditionally based on orientation (my-N vs mx-N)
  </action>
  <verify>File exists with CVA imports, dividerVariants definition, forwardRef wrapper</verify>
  <done>Divider component uses CVA for variant styling with preserved orientation/label support</done>
</task>

<task type="auto">
  <name>Task 3: Create Label and Divider tests</name>
  <files>app/components/ui/__tests__/Label.test.js, app/components/ui/__tests__/Divider.test.js</files>
  <action>
Create test files following Phase 12 patterns:

**Label.test.js:**
1. Accessibility tests:
   - Each variant (default, muted, required) passes axe
   - Label with htmlFor + input passes axe

2. CVA Variants tests:
   - Size variants (sm, md, lg) apply correct text classes
   - Variant 'required' shows asterisk

3. Radix Integration tests:
   - Renders as label element
   - htmlFor prop works correctly
   - Clicking label focuses associated input

**Divider.test.js:**
1. Accessibility tests:
   - Horizontal divider passes axe (uses role="separator")
   - Vertical divider passes axe
   - Divider with label passes axe

2. CVA Variants tests:
   - solid variant applies correct classes
   - dashed variant applies border-dashed
   - gradient variant applies gradient classes

3. Orientation tests:
   - horizontal renders h-px
   - vertical renders w-px

4. Label tests:
   - Label text renders correctly
   - Label has proper styling
  </action>
  <verify>npm test -- --testPathPattern="(Label|Divider).test.js" passes</verify>
  <done>Label and Divider have comprehensive tests covering accessibility and all variants</done>
</task>

</tasks>

<verification>
1. Run `npm test -- --testPathPattern="(Label|Divider).test.js"` - all tests pass
2. Verify Label.js uses @radix-ui/react-label
3. Verify Divider.js exports dividerVariants
</verification>

<success_criteria>
- Label component wraps Radix UI primitive for automatic form association
- Label has CVA variants (default, muted, required)
- Divider uses CVA for variants (solid, dashed, gradient)
- Both components support forwardRef
- All jest-axe tests pass with no a11y violations
</success_criteria>

<output>
After completion, create `.planning/phases/13-foundation-refactoring/13-03-SUMMARY.md`
</output>
