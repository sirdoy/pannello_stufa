---
phase: 13-foundation-refactoring
plan: 05
type: execute
wave: 2
depends_on: ["13-01", "13-02"]
files_modified:
  - app/not-found.js
  - app/thermostat/page.js
  - app/settings/theme/page.js
  - app/settings/notifications/page.js
  - app/settings/notifications/NotificationSettingsForm.js
autonomous: true

must_haves:
  truths:
    - "All Button usages of variant='primary' migrated to variant='ember'"
    - "All Button usages of variant='secondary' migrated to variant='subtle'"
    - "All Button usages of liquid prop removed"
    - "Application builds and runs without Button-related errors"
  artifacts:
    - path: "app/not-found.js"
      provides: "Updated Button usage"
      contains: 'variant="ember"'
    - path: "app/thermostat/page.js"
      provides: "Updated Button usage"
    - path: "app/settings/theme/page.js"
      provides: "Updated Button usage"
    - path: "app/settings/notifications/page.js"
      provides: "Updated Button usage"
  key_links:
    - from: "app/**/*.js"
      to: "Button"
      via: "variant prop"
      pattern: 'variant="(ember|subtle|ghost|success|danger|outline)"'
---

<objective>
Migrate all codebase usages of legacy Button props to new CVA variants.

Purpose: Complete the clean break from legacy props by updating all consumers.
Output: All Button usages use new variant names (ember, subtle, etc.).
</objective>

<execution_context>
@/Users/federicomanfredi/.claude/get-shit-done/workflows/execute-plan.md
@/Users/federicomanfredi/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/13-foundation-refactoring/13-CONTEXT.md
@.planning/phases/13-foundation-refactoring/13-RESEARCH.md
@.planning/phases/13-foundation-refactoring/13-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate Button legacy prop usages across codebase</name>
  <files>app/not-found.js, app/thermostat/page.js, app/settings/theme/page.js, app/settings/notifications/page.js, app/settings/notifications/NotificationSettingsForm.js</files>
  <action>
Search and replace legacy Button props across the codebase:

**Migration mapping:**
- `variant="primary"` -> `variant="ember"`
- `variant="secondary"` -> `variant="subtle"`
- `liquid` prop -> REMOVE entirely
- `liquid variant="primary"` -> `variant="ember"`

**Files to update (from grep analysis):**

1. **app/not-found.js:**
   - `<Button liquid variant="primary"` -> `<Button variant="ember"`

2. **app/thermostat/page.js:**
   - `variant="primary"` -> `variant="ember"` (around line 215, 219)
   - `variant="secondary"` -> `variant="subtle"` (around line 219, 475)

3. **app/settings/theme/page.js:**
   - `variant="primary"` -> `variant="ember"` (around line 173)
   - `variant="secondary"` -> `variant="subtle"` (around line 176)

4. **app/settings/notifications/page.js:**
   - `variant="primary"` -> `variant="ember"` (multiple occurrences)
   - `variant="secondary"` -> `variant="subtle"` (multiple occurrences)

5. **app/settings/notifications/NotificationSettingsForm.js:**
   - `variant="primary"` -> `variant="ember"` (around line 396)

**Approach:**
For each file:
1. Read the file
2. Find all Button usages with legacy props
3. Replace with new variant names
4. Verify no other legacy props remain

**Note:** Text component `variant="secondary"` and `variant="ocean"` are VALID variants - do NOT change these. Only Button variants need migration.
  </action>
  <verify>grep -r 'variant="primary"\|variant="secondary"' app --include="*.js" | grep -v "Text" | grep "Button" returns empty</verify>
  <done>All Button usages in codebase use new CVA variant names (ember, subtle, etc.)</done>
</task>

<task type="auto">
  <name>Task 2: Search for any remaining legacy usages</name>
  <files>(scan entire codebase)</files>
  <action>
Run comprehensive search to ensure no legacy Button usages remain:

1. Search for liquid prop:
   `grep -r 'liquid' app --include="*.js" | grep -v node_modules`

2. Search for Button with primary/secondary:
   `grep -r '<Button.*variant="primary"\|<Button.*variant="secondary"' app --include="*.js"`

3. Search for IconButton legacy usages (if any):
   `grep -r 'IconButton' app --include="*.js"`

4. Search for ButtonGroup legacy usages (if any):
   `grep -r 'ButtonGroup' app --include="*.js"`

If any legacy usages found:
- Update them to use new API
- For IconButton -> Button.Icon or Button with iconOnly
- For ButtonGroup -> Button.Group

Report any remaining usages that need attention.
  </action>
  <verify>No legacy Button prop usages remain in codebase</verify>
  <done>Codebase audit complete - all Button usages follow new CVA API</done>
</task>

</tasks>

<verification>
1. Run grep to verify no `variant="primary"` or `variant="secondary"` on Button components
2. Run grep to verify no `liquid` prop on Button components
3. Run `npm run dev` to verify app starts without errors
4. Spot-check migrated pages render correctly
</verification>

<success_criteria>
- All `variant="primary"` on Button migrated to `variant="ember"`
- All `variant="secondary"` on Button migrated to `variant="subtle"`
- All `liquid` props removed from Button usages
- Application runs without Button-related runtime errors
- No regression in visual appearance (new variants match old behavior)
</success_criteria>

<output>
After completion, create `.planning/phases/13-foundation-refactoring/13-05-SUMMARY.md`
</output>
