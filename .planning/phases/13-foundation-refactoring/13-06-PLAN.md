---
phase: 13-foundation-refactoring
plan: 06
type: execute
wave: 1
depends_on: []
files_modified:
  - app/settings/devices/page.js
  - app/settings/notifications/page.js
  - app/settings/notifications/devices/page.js
  - app/settings/notifications/history/page.js
  - app/settings/notifications/NotificationSettingsForm.js
  - app/settings/theme/page.js
  - app/stove/errors/page.js
  - app/stove/maintenance/page.js
  - app/components/netatmo/RoomCard.js
  - app/components/netatmo/StoveSyncPanel.js
  - app/components/NotificationPreferencesPanel.js
  - app/components/scheduler/DayEditPanel.js
  - app/components/scheduler/WeeklySummaryCard.js
  - app/components/scheduler/DayAccordionItem.js
  - app/components/lights/EditSceneModal.js
  - app/components/lights/CreateSceneModal.js
  - app/components/sandbox/SandboxPanel.js
  - app/not-found.js
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "All Card usages of liquid prop migrated to variant='glass'"
    - "No legacy liquid prop remains on any Card component"
    - "Application builds and runs without Card-related errors"
    - "Visual appearance unchanged (glass variant matches old liquid behavior)"
  artifacts:
    - path: "app/settings/notifications/page.js"
      provides: "Updated Card usage"
      contains: 'variant="glass"'
    - path: "app/stove/maintenance/page.js"
      provides: "Updated Card usage"
      contains: 'variant="glass"'
    - path: "app/not-found.js"
      provides: "Updated Card usage"
      contains: 'variant="glass"'
  key_links:
    - from: "app/**/*.js"
      to: "Card"
      via: "variant prop"
      pattern: 'variant="glass"'
---

<objective>
Migrate all codebase usages of legacy Card liquid prop to new CVA variant.

Purpose: Close verification gap by updating all Card consumers to use variant="glass" instead of legacy liquid prop.
Output: All Card usages use the new CVA API with explicit variant names.
</objective>

<execution_context>
@/Users/federicomanfredi/.claude/get-shit-done/workflows/execute-plan.md
@/Users/federicomanfredi/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/13-foundation-refactoring/13-VERIFICATION.md
@.planning/phases/13-foundation-refactoring/13-02-SUMMARY.md
@.planning/phases/13-foundation-refactoring/13-05-SUMMARY.md
@app/components/ui/Card.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate Card liquid prop in settings pages</name>
  <files>app/settings/devices/page.js, app/settings/notifications/page.js, app/settings/notifications/devices/page.js, app/settings/notifications/history/page.js, app/settings/notifications/NotificationSettingsForm.js, app/settings/theme/page.js</files>
  <action>
Search and replace legacy Card liquid prop to variant="glass" in all settings pages:

**Migration pattern:**
- `<Card liquid` -> `<Card variant="glass"`
- `<Card liquid className=` -> `<Card variant="glass" className=`

**Files and occurrences:**

1. **app/settings/devices/page.js (3 usages):**
   - Line 153: `<Card liquid className="p-6">` -> `<Card variant="glass" className="p-6">`
   - Line 206: `<Card liquid className="p-4 sm:p-6">` -> `<Card variant="glass" className="p-4 sm:p-6">`
   - Line 240: `<Card liquid className="p-6 bg-ocean-900/10...` -> `<Card variant="glass" className="p-6 bg-ocean-900/10...`

2. **app/settings/notifications/page.js (8 usages):**
   - Line 248: `<Card liquid className="p-8 text-center">` -> `<Card variant="glass" className="p-8 text-center">`
   - Line 273: `<Card liquid className="p-6 sm:p-8">` -> `<Card variant="glass" className="p-6 sm:p-8">`
   - Line 301: `<Card liquid className="p-4 bg-sage-500/10...` -> `<Card variant="glass" className="p-4 bg-sage-500/10...`
   - Line 322: `<Card liquid className="p-6 sm:p-8">` -> `<Card variant="glass" className="p-6 sm:p-8">`
   - Line 418: `<Card liquid className="p-6 sm:p-8">` -> `<Card variant="glass" className="p-6 sm:p-8">`
   - Line 589: `<Card liquid className="p-4 sm:p-6">` -> `<Card variant="glass" className="p-4 sm:p-6">`
   - Line 611: `<Card liquid className="p-4 sm:p-6">` -> `<Card variant="glass" className="p-4 sm:p-6">`
   - Line 685: `<Card liquid className="p-4 sm:p-6">` -> `<Card variant="glass" className="p-4 sm:p-6">`

3. **app/settings/notifications/devices/page.js (4 usages):**
   - Line 87: `<Card liquid className="p-8 text-center">` -> `<Card variant="glass" className="p-8 text-center">`
   - Line 110: `<Card liquid className="p-8 text-center">` -> `<Card variant="glass" className="p-8 text-center">`
   - Line 154: `<Card liquid className="p-8">` -> `<Card variant="glass" className="p-8">`
   - Line 198: `<Card liquid className="p-4 mt-6">` -> `<Card variant="glass" className="p-4 mt-6">`

4. **app/settings/notifications/history/page.js (2 usages):**
   - Line 27: `<Card liquid className="p-8 text-center">` -> `<Card variant="glass" className="p-8 text-center">`
   - Line 62: `<Card liquid className="p-4 mt-6">` -> `<Card variant="glass" className="p-4 mt-6">`

5. **app/settings/notifications/NotificationSettingsForm.js (2 usages):**
   - Line 186: `<Card liquid className="p-6">` -> `<Card variant="glass" className="p-6">`
   - Line 309: `<Card liquid className="p-6">` -> `<Card variant="glass" className="p-6">`

6. **app/settings/theme/page.js (4 usages):**
   - Line 52: `<Card liquid>` -> `<Card variant="glass">`
   - Line 69: `<Card liquid className="p-6 sm:p-8">` -> `<Card variant="glass" className="p-6 sm:p-8">`
   - Line 155: `<Card liquid className="p-6 sm:p-8">` -> `<Card variant="glass" className="p-6 sm:p-8">`
   - Line 209: `<Card liquid className="p-6 sm:p-8 bg-ocean-50/50...` -> `<Card variant="glass" className="p-6 sm:p-8 bg-ocean-50/50...`

**Approach:**
For each file:
1. Read the file
2. Replace all `<Card liquid` with `<Card variant="glass"`
3. Verify no other liquid props remain
  </action>
  <verify>grep -r 'Card liquid' app/settings --include="*.js" returns empty</verify>
  <done>All 23 Card liquid usages in settings pages migrated to variant="glass"</done>
</task>

<task type="auto">
  <name>Task 2: Migrate Card liquid prop in remaining files</name>
  <files>app/stove/errors/page.js, app/stove/maintenance/page.js, app/components/netatmo/RoomCard.js, app/components/netatmo/StoveSyncPanel.js, app/components/NotificationPreferencesPanel.js, app/components/scheduler/DayEditPanel.js, app/components/scheduler/WeeklySummaryCard.js, app/components/scheduler/DayAccordionItem.js, app/components/lights/EditSceneModal.js, app/components/lights/CreateSceneModal.js, app/components/sandbox/SandboxPanel.js, app/not-found.js</files>
  <action>
Search and replace legacy Card liquid prop to variant="glass" in all remaining files:

**Files and occurrences:**

1. **app/stove/errors/page.js (4 usages):**
   - Line 91: `<Card liquid className="p-6">` -> `<Card variant="glass" className="p-6">`
   - Line 158: `<Card liquid className="p-12 text-center">` -> `<Card variant="glass" className="p-12 text-center">`
   - Line 171: `<Card liquid key={error.id} className="p-6">` -> `<Card variant="glass" key={error.id} className="p-6">`
   - Line 243: `<Card liquid className="p-4">` -> `<Card variant="glass" className="p-4">`

2. **app/stove/maintenance/page.js (4 usages):**
   - Line 101: `<Card liquid className="p-8 text-center">` -> `<Card variant="glass" className="p-8 text-center">`
   - Line 119: `<Card liquid className="p-6 sm:p-8">` -> `<Card variant="glass" className="p-6 sm:p-8">`
   - Line 173: `<Card liquid className="p-6 sm:p-8">` -> `<Card variant="glass" className="p-6 sm:p-8">`
   - Line 239: `<Card liquid className="p-6 sm:p-8 bg-ocean-50/50...` -> `<Card variant="glass" className="p-6 sm:p-8 bg-ocean-50/50...`

3. **app/components/netatmo/RoomCard.js (1 usage):**
   - Line 173: `<Card liquid className="p-5 sm:p-6...` -> `<Card variant="glass" className="p-5 sm:p-6...`

4. **app/components/netatmo/StoveSyncPanel.js (2 usages):**
   - Line 324: `<Card liquid className="p-6">` -> `<Card variant="glass" className="p-6">`
   - Line 336: `<Card liquid className="p-6">` -> `<Card variant="glass" className="p-6">`

5. **app/components/NotificationPreferencesPanel.js (2 usages):**
   - Line 107: `<Card liquid className="p-6">` -> `<Card variant="glass" className="p-6">`
   - Line 224: `<Card liquid className="p-6">` -> `<Card variant="glass" className="p-6">`

6. **app/components/scheduler/DayEditPanel.js (1 usage):**
   - Line 56: `<Card liquid className="p-4 md:p-6">` -> `<Card variant="glass" className="p-4 md:p-6">`

7. **app/components/scheduler/WeeklySummaryCard.js (1 usage):**
   - Line 24: `<Card liquid className="p-6">` -> `<Card variant="glass" className="p-6">`

8. **app/components/scheduler/DayAccordionItem.js (1 usage):**
   - Line 80: `<Card liquid className="overflow-hidden">` -> `<Card variant="glass" className="overflow-hidden">`

9. **app/components/lights/EditSceneModal.js (1 usage):**
   - Line 210: `<Card liquid className="animate-scale-in-center p-6 sm:p-8">` -> `<Card variant="glass" className="animate-scale-in-center p-6 sm:p-8">`

10. **app/components/lights/CreateSceneModal.js (1 usage):**
    - Line 218: `<Card liquid className="animate-scale-in-center p-6 sm:p-8">` -> `<Card variant="glass" className="animate-scale-in-center p-6 sm:p-8">`

11. **app/components/sandbox/SandboxPanel.js (2 usages):**
    - Line 242: `<Card liquid className="p-6">` -> `<Card variant="glass" className="p-6">`
    - Line 260: `<Card liquid className="p-6 space-y-6 bg-gradient-to-br...` -> `<Card variant="glass" className="p-6 space-y-6 bg-gradient-to-br...`

12. **app/not-found.js (1 usage):**
    - Line 7: `<Card liquid className="max-w-md w-full p-8">` -> `<Card variant="glass" className="max-w-md w-full p-8">`

**Approach:**
For each file:
1. Read the file
2. Replace all `<Card liquid` with `<Card variant="glass"`
3. Verify no other liquid props remain
  </action>
  <verify>grep -r 'Card liquid' app --include="*.js" returns empty (full codebase check)</verify>
  <done>All 22 Card liquid usages in remaining files migrated to variant="glass"</done>
</task>

</tasks>

<verification>
1. Run grep to verify no `<Card liquid` remains in codebase:
   `grep -r 'Card liquid' app --include="*.js"` returns empty
2. Run `npm run dev` to verify app starts without errors
3. Spot-check migrated pages render correctly with glass variant
4. Run Card tests to ensure no regressions: `npm test -- Card`
</verification>

<success_criteria>
- All 45 `<Card liquid` usages migrated to `<Card variant="glass"`
- No legacy `liquid` prop remains on any Card component in codebase
- Application runs without Card-related runtime errors
- No regression in visual appearance (glass variant matches old liquid behavior)
- Card component tests still pass
</success_criteria>

<output>
After completion, create `.planning/phases/13-foundation-refactoring/13-06-SUMMARY.md`
</output>
