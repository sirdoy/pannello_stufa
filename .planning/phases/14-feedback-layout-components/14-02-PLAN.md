---
phase: 14-feedback-layout-components
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - app/components/ui/Tooltip.js
  - app/components/ui/__tests__/Tooltip.test.js
  - app/components/ui/index.js
autonomous: true

must_haves:
  truths:
    - "User can hover over trigger to see tooltip"
    - "User can focus trigger with keyboard to see tooltip"
    - "Tooltip auto-positions to avoid viewport edges"
    - "Tooltip has arrow pointing to trigger"
  artifacts:
    - path: "app/components/ui/Tooltip.js"
      provides: "Tooltip component with Radix primitive"
      exports: ["default", "Tooltip", "TooltipTrigger", "TooltipContent", "TooltipProvider"]
    - path: "app/components/ui/__tests__/Tooltip.test.js"
      provides: "Accessibility and interaction tests"
      min_lines: 60
  key_links:
    - from: "app/components/ui/Tooltip.js"
      to: "@radix-ui/react-tooltip"
      via: "Radix Tooltip primitive"
      pattern: "TooltipPrimitive"
---

<objective>
Create Tooltip component using Radix Tooltip primitive with CVA styling.

Purpose: Provide accessible tooltips with keyboard support, automatic positioning, and Ember Noir styling.
Output: Tooltip component with provider, trigger, and content sub-components.
</objective>

<execution_context>
@/Users/federicomanfredi/.claude/get-shit-done/workflows/execute-plan.md
@/Users/federicomanfredi/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/14-feedback-layout-components/14-RESEARCH.md
@app/components/ui/Button.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Tooltip component with Radix primitive</name>
  <files>app/components/ui/Tooltip.js</files>
  <action>
Create the Tooltip component following established patterns:

1. Import dependencies:
   ```javascript
   'use client';

   import * as TooltipPrimitive from '@radix-ui/react-tooltip';
   import { forwardRef } from 'react';
   import { cn } from '@/lib/utils/cn';
   ```

2. Create TooltipProvider (wraps app once):
   ```javascript
   function TooltipProvider({ children, delayDuration = 400, skipDelayDuration = 300 }) {
     return (
       <TooltipPrimitive.Provider
         delayDuration={delayDuration}
         skipDelayDuration={skipDelayDuration}
       >
         {children}
       </TooltipPrimitive.Provider>
     );
   }
   ```

3. Create Tooltip root (convenience wrapper):
   ```javascript
   function TooltipRoot({ children, ...props }) {
     return <TooltipPrimitive.Root {...props}>{children}</TooltipPrimitive.Root>;
   }
   ```

4. Create TooltipTrigger:
   ```javascript
   const TooltipTrigger = TooltipPrimitive.Trigger;
   ```

5. Create TooltipContent with Ember Noir styling:
   ```javascript
   const TooltipContent = forwardRef(({ className, sideOffset = 4, children, ...props }, ref) => (
     <TooltipPrimitive.Portal>
       <TooltipPrimitive.Content
         ref={ref}
         sideOffset={sideOffset}
         className={cn(
           'z-50 px-3 py-1.5 text-sm',
           'bg-slate-800 [html:not(.dark)_&]:bg-slate-900',
           'text-slate-100',
           'rounded-lg shadow-lg',
           'border border-slate-700/50 [html:not(.dark)_&]:border-slate-700',
           // Animation
           'animate-fade-in',
           'data-[state=closed]:animate-fade-out',
           // Reduced motion
           'motion-reduce:animate-none',
           className
         )}
         {...props}
       >
         {children}
         <TooltipPrimitive.Arrow
           className="fill-slate-800 [html:not(.dark)_&]:fill-slate-900"
         />
       </TooltipPrimitive.Content>
     </TooltipPrimitive.Portal>
   ));
   TooltipContent.displayName = 'TooltipContent';
   ```

6. Create simple Tooltip convenience component:
   ```javascript
   /**
    * Simple Tooltip - single component API
    * @example <Tooltip content="Hello">Hover me</Tooltip>
    */
   function Tooltip({ children, content, side = 'top', ...props }) {
     return (
       <TooltipRoot {...props}>
         <TooltipTrigger asChild>{children}</TooltipTrigger>
         <TooltipContent side={side}>{content}</TooltipContent>
       </TooltipRoot>
     );
   }
   ```

7. Attach namespace components and export:
   ```javascript
   Tooltip.Provider = TooltipProvider;
   Tooltip.Root = TooltipRoot;
   Tooltip.Trigger = TooltipTrigger;
   Tooltip.Content = TooltipContent;

   export default Tooltip;
   export { Tooltip, TooltipProvider, TooltipTrigger, TooltipContent };
   ```

IMPORTANT:
- delayDuration=400 gives good UX (not too fast, not too slow)
- skipDelayDuration=300 allows fast hovering between tooltips
- sideOffset=4 gives comfortable spacing
- Arrow uses same fill color as content background
  </action>
  <verify>Component renders without errors</verify>
  <done>Tooltip with provider, trigger, content, and simple API created</done>
</task>

<task type="auto">
  <name>Task 2: Add Tooltip tests and export</name>
  <files>app/components/ui/__tests__/Tooltip.test.js, app/components/ui/index.js</files>
  <action>
Create tests and add to exports:

**Tooltip.test.js:**

1. Import dependencies:
   ```javascript
   import { render, screen, waitFor } from '@testing-library/react';
   import userEvent from '@testing-library/user-event';
   import { axe } from 'jest-axe';
   import Tooltip from '../Tooltip';
   ```

2. Test wrapper (provider is required):
   ```javascript
   const renderWithProvider = (ui) =>
     render(<Tooltip.Provider>{ui}</Tooltip.Provider>);
   ```

3. Test cases:

   **Rendering tests:**
   - "renders trigger but not content initially"
   - "shows content on hover after delay"
   - "hides content when mouse leaves"

   **Keyboard tests:**
   - "shows content on focus"
   - "hides content on blur"

   **Accessibility tests:**
   - "has no accessibility violations"
   - "tooltip has role=tooltip"
   - "trigger has aria-describedby pointing to tooltip"

   **Positioning tests:**
   - "accepts side prop (top, right, bottom, left)"
   - "accepts sideOffset prop"

   **Simple API tests:**
   - "simple Tooltip component works with content prop"

4. Use proper timing:
   ```javascript
   // Wait for tooltip delay (400ms default + buffer)
   await waitFor(() => {
     expect(screen.getByRole('tooltip')).toBeInTheDocument();
   }, { timeout: 1000 });
   ```

**index.js update:**
Add to exports:
```javascript
export { default as Tooltip, TooltipProvider, TooltipTrigger, TooltipContent } from './Tooltip';
```
  </action>
  <verify>npm test -- Tooltip.test.js --watchAll=false</verify>
  <done>Tests pass, Tooltip exported from index.js</done>
</task>

</tasks>

<verification>
- [ ] `npm test -- Tooltip.test.js --watchAll=false` passes
- [ ] Tooltip shows on hover after delay
- [ ] Tooltip shows on keyboard focus
- [ ] Tooltip auto-positions with arrow
- [ ] Exported from ui/index.js
</verification>

<success_criteria>
Tooltip component uses Radix Tooltip primitive. Shows on hover and focus. Has arrow pointing to trigger. Auto-positions to avoid viewport edges. Exported from index.js.
</success_criteria>

<output>
After completion, create `.planning/phases/14-feedback-layout-components/14-02-SUMMARY.md`
</output>
