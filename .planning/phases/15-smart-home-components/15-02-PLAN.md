---
phase: 15-smart-home-components
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - app/components/ui/Badge.js
  - app/components/ui/__tests__/Badge.test.js
autonomous: true

must_haves:
  truths:
    - "User sees status badges with consistent styling across all smart home devices"
    - "Active/online states show continuous pulse animation"
    - "Badge colors match Ember Noir palette variants"
  artifacts:
    - path: "app/components/ui/Badge.js"
      provides: "CVA-based badge component with pulse animation"
      exports: ["Badge", "badgeVariants"]
  key_links:
    - from: "app/components/ui/Badge.js"
      to: "lib/utils/cn.js"
      via: "class name merging"
      pattern: "cn\\("
---

<objective>
Create Badge component with CVA variants and dedicated pulse animation for status indicators.

Purpose: Provide a unified, reusable status indicator that replaces the inline statusBadge styling in DeviceCard with a proper component that can pulse when active.
Output: Badge.js component with CVA variants and pulse animation support.
</objective>

<execution_context>
@/Users/federicomanfredi/.claude/get-shit-done/workflows/execute-plan.md
@/Users/federicomanfredi/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/15-smart-home-components/15-CONTEXT.md
@.planning/phases/15-smart-home-components/15-RESEARCH.md
@app/components/ui/StatusBadge.js
@lib/utils/cn.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Badge component with CVA and pulse animation</name>
  <files>
    app/components/ui/Badge.js
    app/components/ui/__tests__/Badge.test.js
  </files>
  <action>
Create `app/components/ui/Badge.js` as a new extracted component (not modifying StatusBadge):

1. CVA configuration (`badgeVariants`):
   - Base classes: inline-flex items-center gap-1.5, font-display font-semibold, rounded-full, border, transition-all duration-200
   - Variants:
     - `variant`: ember, sage, ocean, warning, danger, neutral (using Ember Noir palette)
     - `size`: sm (px-2 py-0.5 text-xs), md (px-3 py-1 text-sm), lg (px-4 py-1.5 text-base)
     - `pulse`: boolean - when true, adds `animate-glow-pulse` class

2. Color definitions (each with light mode overrides using `[html:not(.dark)_&]:`):
   - ember: bg-ember-500/15, border-ember-400/25, text-ember-300
   - sage: bg-sage-500/15, border-sage-400/25, text-sage-300
   - ocean: bg-ocean-500/15, border-ocean-400/25, text-ocean-300
   - warning: bg-warning-500/15, border-warning-400/25, text-warning-300
   - danger: bg-danger-500/15, border-danger-400/25, text-danger-300
   - neutral: bg-slate-500/10, border-slate-400/20, text-slate-400

3. Props:
   - `children`: Badge text content
   - `icon`: Optional icon (ReactNode) displayed before text
   - `variant`: Color variant (default: 'neutral')
   - `size`: Size variant (default: 'md')
   - `pulse`: Enable pulse animation (default: false) - CONTEXT says always pulse when active/online
   - `className`: Additional classes
   - Forward ref support with forwardRef

4. Implementation:
   - Use `cn()` to merge badgeVariants with className
   - Render icon (if provided) with text-sm class
   - Render children as text content

5. Exports:
   - Named export: `Badge`, `badgeVariants`
   - Default export: `Badge`

Create `app/components/ui/__tests__/Badge.test.js`:
- Accessibility: no a11y violations (jest-axe with runAxeWithRealTimers)
- Renders children text
- Renders icon when provided
- Applies correct variant classes (check for ember-500, sage-500, etc.)
- Applies pulse animation when pulse=true (check for animate-glow-pulse)
- Supports className override
- Forwards ref correctly
  </action>
  <verify>npm test -- --testPathPattern="Badge" --passWithNoTests</verify>
  <done>Badge component created with CVA, pulse animation support, all tests pass</done>
</task>

<task type="auto">
  <name>Task 2: Add Badge to UI index and verify integration</name>
  <files>
    app/components/ui/index.js
  </files>
  <action>
Update `app/components/ui/index.js` to export Badge:

1. Add import: `import Badge, { badgeVariants } from './Badge';`
2. Add to exports object: `Badge, badgeVariants`

This makes Badge available via `@/app/components/ui` imports.

Note: StatusBadge remains as-is for backwards compatibility. The new Badge component is for new smart home components. StatusBadge can be deprecated in a future phase.
  </action>
  <verify>grep -q "Badge" app/components/ui/index.js && echo "Badge exported"</verify>
  <done>Badge exported from index.js, available for import</done>
</task>

</tasks>

<verification>
1. Run tests: `npm test -- --testPathPattern="Badge"`
2. Verify exports: `grep "badgeVariants" app/components/ui/Badge.js`
3. Verify index export: `grep "Badge" app/components/ui/index.js`
</verification>

<success_criteria>
- Badge.js exists with CVA configuration
- badgeVariants exported for external styling
- 6 color variants (ember, sage, ocean, warning, danger, neutral)
- 3 size variants (sm, md, lg)
- pulse boolean variant adds animate-glow-pulse
- All tests pass including accessibility
- Badge exported from index.js
</success_criteria>

<output>
After completion, create `.planning/phases/15-smart-home-components/15-02-SUMMARY.md`
</output>
