---
phase: 16-page-migration
plan: 07
type: execute
wave: 3
depends_on: ["16-03"]
files_modified:
  - app/settings/notifications/page.js
autonomous: true

must_haves:
  truths:
    - "Notifications settings page uses Card consistently"
    - "Form sections use proper design system components"
    - "Success/error feedback uses Banner component"
  artifacts:
    - path: "app/settings/notifications/page.js"
      provides: "Notifications settings with design system"
      contains: "Banner"
  key_links:
    - from: "app/settings/notifications/page.js"
      to: "app/components/ui"
      via: "imports"
      pattern: "from.*components/ui"
---

<objective>
Migrate Notifications settings page inline styles to design system

Purpose: Replace manual styling with design system components for consistency
Output: Notifications settings using Banner, Card, Badge consistently
</objective>

<execution_context>
@/Users/federicomanfredi/.claude/get-shit-done/workflows/execute-plan.md
@/Users/federicomanfredi/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/16-page-migration/16-CONTEXT.md
@app/settings/notifications/page.js
@app/components/ui/Banner.js
@app/components/ui/Badge.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Replace inline notification/warning boxes with Banner</name>
  <files>app/settings/notifications/page.js</files>
  <action>
Replace manual styled alert boxes with Banner component:

**Success banner (lines ~300-308):**
```javascript
// BEFORE
{saveSuccess && (
  <Card variant="glass" className="p-4 bg-sage-500/10 [html:not(.dark)_&]:bg-sage-50 border border-sage-500/30 [html:not(.dark)_&]:border-sage-200">
    <div className="flex items-center gap-3">
      <span className="text-2xl">✅</span>
      <Text variant="sage" weight="medium">
        Preferenze salvate con successo!
      </Text>
    </div>
  </Card>
)}

// AFTER
{saveSuccess && (
  <Banner
    variant="success"
    title="Preferenze salvate con successo!"
    dismissible
    onDismiss={() => setSaveSuccess(false)}
  />
)}
```

**Warning: No devices registered (lines ~450-465):**
```javascript
// BEFORE
<div className="p-4 bg-warning-500/10 [html:not(.dark)_&]:bg-warning-50 border border-warning-500/30 [html:not(.dark)_&]:border-warning-200 rounded-xl">
  <div className="flex items-start gap-3">
    <div className="text-2xl">⚠️</div>
    <div>
      <Text variant="warning" weight="medium" className="mb-1">
        Nessun dispositivo registrato
      </Text>
      <Text variant="secondary" size="sm">
        Il permesso notifiche è attivo ma questo dispositivo non è registrato...
      </Text>
    </div>
  </div>
</div>

// AFTER
<Banner
  variant="warning"
  icon="⚠️"
  title="Nessun dispositivo registrato"
  description="Il permesso notifiche è attivo ma questo dispositivo non è registrato. Registra il dispositivo per ricevere notifiche."
/>
```

**Error messages (multiple locations):**
```javascript
// BEFORE
<div className="p-3 bg-ember-500/10 [html:not(.dark)_&]:bg-ember-50 border border-ember-500/30 [html:not(.dark)_&]:border-ember-200 rounded-lg">
  <Text variant="ember" size="sm">
    {registrationError}
  </Text>
</div>

// AFTER
<Banner variant="error" description={registrationError} compact />
```

**Add Banner import if not present:**
```javascript
import { Banner } from '@/app/components/ui';
```
  </action>
  <verify>
- Test success message after saving preferences
- Test warning display when no devices
- Test error display on registration failure
  </verify>
  <done>All notification/warning boxes use Banner component</done>
</task>

<task type="auto">
  <name>Task 2: Replace inline badges with Badge component</name>
  <files>app/settings/notifications/page.js</files>
  <action>
Replace inline badge styling with Badge component:

**Device count badge (line ~425):**
```javascript
// BEFORE
<span className="px-2.5 py-1 text-xs font-semibold bg-ocean-500/20 text-ocean-400 [html:not(.dark)_&]:bg-ocean-100 [html:not(.dark)_&]:text-ocean-700 rounded-full">
  {devices.length}
</span>

// AFTER
<Badge variant="ocean" size="sm">{devices.length}</Badge>
```

**PWA badge (line ~516):**
```javascript
// BEFORE
<span className="px-2 py-0.5 text-xs font-medium bg-sage-500/20 text-sage-400 [html:not(.dark)_&]:bg-sage-100 [html:not(.dark)_&]:text-sage-700 rounded-full">
  PWA
</span>

// AFTER
<Badge variant="sage" size="sm">PWA</Badge>
```

**"This device" badge (line ~521):**
```javascript
// BEFORE
<span className="px-2 py-0.5 text-xs font-medium bg-ocean-500/20 text-ocean-400 [html:not(.dark)_&]:bg-ocean-100 [html:not(.dark)_&]:text-ocean-700 rounded-full">
  Questo dispositivo
</span>

// AFTER
<Badge variant="ocean" size="sm">Questo dispositivo</Badge>
```

**Add Badge import if not present:**
```javascript
import { Badge } from '@/app/components/ui';
```
  </action>
  <verify>
- Visual inspection of badge styling
- Verify all badges render correctly
  </verify>
  <done>All inline badges use Badge component</done>
</task>

<task type="auto">
  <name>Task 3: Clean up remaining inline styles</name>
  <files>app/settings/notifications/page.js</files>
  <action>
Review and cleanup remaining inline styles:

**Device list items (lines ~500-551):**
```javascript
// BEFORE
<div className="p-4 bg-slate-800/50 [html:not(.dark)_&]:bg-slate-100 border border-slate-700/50 [html:not(.dark)_&]:border-slate-200 rounded-xl">

// AFTER - Use design tokens or Card component
// Option A: Keep with cleaner tokens
<div className="p-4 bg-surface border border-default rounded-xl">

// Option B: Use Card component
<Card className="p-4">
```

**Link cards pattern (lines ~589-608, ~611-630):**
These follow a consistent pattern - verify they could use a shared LinkCard pattern or keep as-is if simple enough.

**iOS info card (lines ~632-679):**
```javascript
// BEFORE
<Card
  variant="glass"
  className="p-6 sm:p-8 bg-ocean-500/10 [html:not(.dark)_&]:bg-ocean-50 border-2 border-ocean-500/30 [html:not(.dark)_&]:border-ocean-200"
>

// This is intentionally styled ocean - acceptable as functional variation
// Could become Banner variant="info" but info content is more complex
// KEEP AS-IS - this is a detailed info section, not a simple alert
```

**Focus on:**
1. Consistent Card usage for list items
2. Remove redundant [html:not(.dark)_&] where covered by tokens
3. Ensure all imports from centralized index.js
  </action>
  <verify>
- Visual inspection of device list
- Verify light mode styling works
- No console errors
  </verify>
  <done>Notifications page has consistent styling with design tokens</done>
</task>

</tasks>

<verification>
1. Notifications settings loads at localhost:3000/settings/notifications
2. Permission button works
3. Test notification sends
4. Device list displays correctly
5. Success/error messages show as Banner
6. Badges display correctly
7. iOS info section displays
8. No console errors
</verification>

<success_criteria>
- Banner component used for all alerts/notifications
- Badge component used for all inline badges
- Consistent Card and styling patterns
- Proper imports from centralized index.js
</success_criteria>

<output>
After completion, create `.planning/phases/16-page-migration/16-07-SUMMARY.md`
</output>
