---
phase: 16-page-migration
plan: 10
type: execute
wave: 3
depends_on: ["16-07"]
files_modified:
  - app/settings/devices/page.js
  - app/settings/theme/page.js
autonomous: true

must_haves:
  truths:
    - "Settings/devices page uses Badge for active indicator"
    - "Settings/theme page uses Button component for mode selection"
    - "Both pages use consistent Card and Banner patterns"
  artifacts:
    - path: "app/settings/devices/page.js"
      provides: "Device settings with design system components"
      contains: "Badge"
    - path: "app/settings/theme/page.js"
      provides: "Theme settings with design system components"
      contains: "Button"
  key_links:
    - from: "app/settings/devices/page.js"
      to: "app/components/ui"
      via: "imports"
      pattern: "from.*components/ui"
    - from: "app/settings/theme/page.js"
      to: "app/components/ui"
      via: "imports"
      pattern: "from.*components/ui"
---

<objective>
Migrate remaining Settings pages (devices, theme) to design system

Purpose: Complete settings section migration for visual consistency
Output: Settings/devices and Settings/theme pages using all design system components
</objective>

<execution_context>
@/Users/federicomanfredi/.claude/get-shit-done/workflows/execute-plan.md
@/Users/federicomanfredi/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/16-page-migration/16-CONTEXT.md
@app/settings/devices/page.js
@app/settings/theme/page.js
@app/components/ui/Badge.js
@app/components/ui/Button.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate Settings/devices page</name>
  <files>app/settings/devices/page.js</files>
  <action>
Settings/devices page is already 90% migrated. Complete remaining items:

**Already using design system:**
- SettingsLayout wrapper
- Card variant="glass"
- Button variant="ember", variant="neutral"
- Banner variant="success", variant="info", variant="warning"
- Toggle component
- Skeleton, Heading, Text

**Migrate to Badge component (line ~180):**
```javascript
// BEFORE - inline active indicator
{isEnabled && (
  <Text as="span" variant="sage" size="xs" weight="medium" className="px-2 py-0.5 rounded-full bg-sage-900/30 [html:not(.dark)_&]:bg-sage-100">
    Attivo
  </Text>
)}

// AFTER - use Badge component
{isEnabled && (
  <Badge variant="sage" size="sm">Attivo</Badge>
)}
```

**Add Badge import:**
```javascript
import Badge from '@/app/components/ui/Badge';
// Or from centralized:
import { Badge } from '@/app/components/ui';
```

**Verify no remaining inline badge patterns exist.**
  </action>
  <verify>
- localhost:3000/settings/devices loads correctly
- Active badge displays for enabled devices
- Toggle state changes update badge correctly
  </verify>
  <done>Settings/devices uses Badge component for active indicator</done>
</task>

<task type="auto">
  <name>Task 2: Migrate Settings/theme page</name>
  <files>app/settings/theme/page.js</files>
  <action>
Settings/theme page has inline button styling that should use Button component:

**Convert theme selection buttons (lines ~76-141):**
```javascript
// BEFORE - custom button styling
<button
  onClick={() => handleThemeChange(THEMES.LIGHT)}
  disabled={isSaving}
  className={`
    w-full p-4 rounded-lg border-2 transition-all
    flex items-center justify-between
    ${theme === THEMES.LIGHT
      ? 'border-ember-500 bg-ember-50 ...'
      : 'border-slate-200 ...'
    }
  `}
>

// AFTER - consider using Card with onClick or keeping styled div
// NOTE: These are selection cards, not action buttons. Keep as styled divs
// but ensure consistent design token usage.
```

**Actually, these are selection cards (similar to radio buttons), not action buttons.**
The pattern is correct - they're styled interactive divs. Focus on:

1. **Clean up inline color classes to use design tokens:**
   - Replace `bg-ember-50` patterns with consistent tokens
   - Ensure dark mode classes are correct

2. **Convert saving status message to Banner (line ~146):**
```javascript
// BEFORE
{isSaving && (
  <div className="mt-4 p-3 bg-ocean-50 ...">
    <Text variant="ocean" size="sm">
      Salvataggio tema in corso...
    </Text>
  </div>
)}

// AFTER
{isSaving && (
  <Banner variant="info" compact>
    Salvataggio tema in corso...
  </Banner>
)}
```

3. **Verify Info Card uses Banner pattern (lines ~209-221):**
   Could be converted to Banner variant="info" with title/description, but current Card approach is also acceptable for complex content.

**Add Banner import if using for status message.**
  </action>
  <verify>
- localhost:3000/settings/theme loads correctly
- Theme selection works (light/dark toggle)
- Status message displays during save
- Preview section shows correctly
  </verify>
  <done>Settings/theme uses consistent design tokens, Banner for status messages</done>
</task>

</tasks>

<verification>
1. Settings/devices page loads at localhost:3000/settings/devices
2. Settings/theme page loads at localhost:3000/settings/theme
3. Device active indicators use Badge component
4. Theme selection visual feedback works
5. Both pages have consistent Card styling
6. No console errors
</verification>

<success_criteria>
- Badge component used for device active indicator
- Consistent design token usage in theme selection
- Banner used for status messages where appropriate
- Both pages visually consistent with rest of settings
</success_criteria>

<output>
After completion, create `.planning/phases/16-page-migration/16-10-SUMMARY.md`
</output>
