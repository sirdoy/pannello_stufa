---
phase: 18-documentation-polish
plan: 04
type: execute
wave: 2
depends_on: ["18-01", "18-02"]
files_modified:
  - docs/design-system.md
  - docs/accessibility.md
autonomous: true

must_haves:
  truths:
    - "docs/design-system.md documents complete v3.0 component library"
    - "docs/design-system.md references live examples at /debug/design-system"
    - "docs/accessibility.md provides centralized accessibility guide"
    - "Developer can find keyboard shortcuts for all interactive components"
  artifacts:
    - path: "docs/design-system.md"
      provides: "Complete v3.0 design system documentation"
      min_lines: 400
    - path: "docs/accessibility.md"
      provides: "Centralized accessibility reference"
      min_lines: 200
  key_links:
    - from: "docs/design-system.md"
      to: "/debug/design-system"
      via: "URL reference"
      pattern: "/debug/design-system"
    - from: "docs/accessibility.md"
      to: "component files"
      via: "keyboard and ARIA documentation"
      pattern: "keyboard|ARIA|screen reader"
---

<objective>
Update design system documentation and create accessibility guide.

Purpose: Provide comprehensive written documentation that complements the live showcase. Enable developers to find component APIs, patterns, and accessibility info quickly.
Output: Updated docs/design-system.md and new docs/accessibility.md
</objective>

<execution_context>
@/Users/federicomanfredi/.claude/get-shit-done/workflows/execute-plan.md
@/Users/federicomanfredi/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/18-documentation-polish/18-RESEARCH.md
@.planning/phases/18-documentation-polish/18-01-SUMMARY.md
@.planning/phases/18-documentation-polish/18-02-SUMMARY.md

# Existing documentation
@docs/design-system.md

# Component metadata for reference
@app/debug/design-system/data/component-docs.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update docs/design-system.md with v3.0 component library</name>
  <files>
    docs/design-system.md
  </files>
  <action>
Rewrite docs/design-system.md to document the complete v3.0 component library:

**Structure:**

```markdown
# Design System - Ember Noir v3.0

Dark-first design system with warm accents.

**Live Preview**: `/debug/design-system` (interactive examples with copy-to-clipboard)

---

## Quick Start

Use design system components instead of raw HTML:

```jsx
// Correct
import { Heading, Text, Button, Card } from '@/app/components/ui';
<Heading level={2} variant="ember">Title</Heading>
<Text variant="secondary">Description</Text>

// Wrong - never use raw HTML
<h2 className="text-ember-400">Title</h2>
<p className="text-slate-300">Description</p>
```

---

## Philosophy

1. **Dark Foundation** - Warm charcoal (slate), not cold black
2. **Ember Accents** - Copper/amber (#ed6f10) signature color
3. **Organic Shapes** - Generous border radius (12-20px)
4. **Layered Depth** - Subtle gradients and shadows
5. **Accessibility First** - WCAG AA compliant, full keyboard navigation

---

## Components by Category

### Form Controls
| Component | Description | Props |
|-----------|-------------|-------|
| Button | Primary action button | variant, size, icon, loading, disabled |
| Checkbox | Checkbox with Radix primitives | checked, onChange, label, indeterminate, variant |
| Switch | Toggle switch for settings | checked, onChange, label, variant, size |
| Input | Text input with validation | label, icon, error, helperText, variant |
| Select | Dropdown with Radix primitives | options, value, onChange, label, variant |
| Slider | Range slider | value, onChange, min, max, step |

### Feedback
| Component | Description | Props |
|-----------|-------------|-------|
| Modal | Dialog with focus trap | isOpen, onClose, maxWidth |
| Toast | Notification with auto-dismiss | message, variant, duration, onDismiss |
| Banner | Alert banner | variant, title, description, dismissible |
| Tooltip | Contextual tooltip | content, side, open |
| Spinner | Loading indicator | size, variant, label |
| Progress | Progress bar | value, variant, size, label |
| EmptyState | Empty content placeholder | icon, title, description, action |

### Layout
| Component | Description | Props |
|-----------|-------------|-------|
| Card | Container card | variant, hover, glow, padding |
| PageLayout | Page structure wrapper | header, footer, maxWidth, padding |
| Section | Semantic section with title | title, subtitle, spacing, level |
| Grid | Responsive grid | cols, gap, as |
| Divider | Content separator | variant, spacing, label |

### Smart Home
| Component | Description | Props |
|-----------|-------------|-------|
| Badge | Status badge with pulse | variant, size, pulse, icon |
| ConnectionStatus | Online/offline indicator | status, size, label |
| HealthIndicator | Health status display | status, size, label, pulse |
| SmartHomeCard | Device card base | icon, title, colorTheme, size |
| StatusCard | Extends SmartHomeCard | status, statusVariant, connectionStatus |
| DeviceCard | Legacy device card | (backwards compatible) |
| ControlButton | Increment/decrement button | type, variant, size, onChange |

### Typography
| Component | Description | Props |
|-----------|-------------|-------|
| Heading | Semantic headings h1-h6 | level, variant, size |
| Text | Body text | variant, size, weight, mono |
| Label | Form label | (Radix Label primitive) |

---

## Colors

[Keep existing color section, update if needed]

---

## Dark/Light Mode

[Keep existing dark/light mode section]

---

## Component Patterns

### CVA Variants

All components use class-variance-authority (CVA) for type-safe variants:

```jsx
// Button variants
<Button variant="ember">Primary</Button>
<Button variant="subtle">Secondary</Button>
<Button variant="ghost">Tertiary</Button>
<Button variant="danger">Destructive</Button>

// Card variants
<Card variant="default">Standard card</Card>
<Card variant="glass">Glass effect</Card>
<Card variant="elevated">Elevated shadow</Card>
```

### Namespace Components

Compound components use namespace pattern:

```jsx
// Button namespace
<Button.Icon icon="..." label="Settings" />
<Button.Group>
  <Button variant="subtle">Cancel</Button>
  <Button variant="ember">Confirm</Button>
</Button.Group>

// Card namespace
<Card>
  <Card.Header>
    <Card.Title icon="...">Title</Card.Title>
  </Card.Header>
  <Card.Content>Content</Card.Content>
  <Card.Footer>Actions</Card.Footer>
</Card>

// SmartHomeCard namespace
<SmartHomeCard icon="..." title="Device">
  <SmartHomeCard.Status><Badge>Active</Badge></SmartHomeCard.Status>
  <SmartHomeCard.Controls>Controls here</SmartHomeCard.Controls>
</SmartHomeCard>
```

### Layout Pattern

Standard page structure:

```jsx
<PageLayout maxWidth="2xl" padding="lg">
  <Section title="Section Title" level={1} spacing="lg">
    <Grid cols={3} gap="md">
      <Card>...</Card>
    </Grid>
  </Section>
</PageLayout>
```

---

## Accessibility

See [docs/accessibility.md](./accessibility.md) for complete accessibility guide.

Key principles:
- All interactive components support full keyboard navigation
- Focus indicators use ember glow ring
- Form controls have proper ARIA labels
- Toast/Banner use aria-live regions
- Respects prefers-reduced-motion

---

## See Also

- `/debug/design-system` - Live interactive examples
- [Accessibility Guide](./accessibility.md) - Keyboard navigation, ARIA, screen readers
```
  </action>
  <verify>
    - docs/design-system.md exists and is >400 lines
    - References /debug/design-system
    - Documents all 4 component categories
    - Includes Quick Start section
    - Includes Component Patterns section
    - References accessibility.md
  </verify>
  <done>
    - docs/design-system.md comprehensively documents v3.0 component library
    - All component categories listed with props
    - Pattern examples included (CVA, namespace, layout)
    - Links to live examples and accessibility guide
  </done>
</task>

<task type="auto">
  <name>Task 2: Create docs/accessibility.md</name>
  <files>
    docs/accessibility.md
  </files>
  <action>
Create docs/accessibility.md with centralized accessibility documentation:

```markdown
# Accessibility Guide - Ember Noir v3.0

WCAG AA compliant design system with full keyboard navigation.

---

## Principles

1. **Keyboard First** - All interactive components fully navigable with keyboard
2. **Screen Reader Friendly** - Proper ARIA labels and live regions
3. **Visible Focus** - Ember glow focus indicators
4. **Respects User Preferences** - prefers-reduced-motion honored
5. **Touch Accessible** - 44px minimum touch targets

---

## Keyboard Navigation by Component

### Form Controls

| Component | Keys | Action |
|-----------|------|--------|
| Button | Enter, Space | Activate |
| Button | Tab | Navigate |
| Checkbox | Space | Toggle |
| Checkbox | Tab | Navigate |
| Switch | Space, Enter | Toggle |
| Switch | Tab | Navigate |
| Input | Tab | Navigate |
| Input | Escape | Clear (if clearable) |
| Select | Enter, Space | Open dropdown |
| Select | ArrowDown/Up | Navigate options |
| Select | Escape | Close dropdown |
| Slider | ArrowRight/Left | Increase/Decrease by step |
| Slider | Home | Set to min |
| Slider | End | Set to max |
| Slider | PageUp/Down | Increase/Decrease by 10% |

### Feedback Components

| Component | Keys | Action |
|-----------|------|--------|
| Modal | Escape | Close |
| Modal | Tab | Cycle focus (trapped) |
| Tooltip | Tab | Show (on trigger focus) |
| Tooltip | Escape | Hide |
| Toast | Tab | Navigate to dismiss |
| Banner | Tab | Navigate to dismiss (if dismissible) |

### Smart Home Components

| Component | Keys | Action |
|-----------|------|--------|
| ControlButton | Enter, Space | Single increment/decrement |
| SmartHomeCard | Tab | Navigate internal elements |

---

## ARIA Patterns

### Buttons

```jsx
// Standard button - implicit role
<Button>Label</Button>
// Renders: <button>Label</button>

// Icon-only button - requires aria-label
<Button.Icon icon="..." aria-label="Settings" />
// Renders: <button aria-label="Settings">...</button>

// Loading button
<Button loading>Save</Button>
// Spinner hidden from screen readers
```

### Form Controls

```jsx
// Checkbox
<Checkbox label="Accept terms" checked={...} onChange={...} />
// Renders with role="checkbox", aria-checked, aria-labelledby

// Switch
<Switch label="Enable notifications" checked={...} onChange={...} />
// Renders with role="switch", aria-checked, aria-label

// Select
<Select label="Schedule" options={...} value={...} onChange={...} />
// Renders with role="combobox", aria-expanded, aria-haspopup

// Slider
<Slider aria-label="Brightness" value={...} onChange={...} />
// Renders with role="slider", aria-valuenow, aria-valuemin, aria-valuemax
```

### Modal

```jsx
<Modal isOpen={true} onClose={...}>
  <Card>Content</Card>
</Modal>
// Renders with role="dialog", aria-modal="true"
// Focus trapped inside modal
// Escape key closes
```

### Live Regions

```jsx
// Toast notifications
<Toast message="Saved!" variant="success" />
// Container has role="status", aria-live="polite"

// Error banners
<Banner variant="error" title="Error" description="..." />
// Has role="alert" for immediate announcement
```

---

## Focus Indicators

All interactive components use ember glow focus ring:

```css
focus-visible:ring-2
focus-visible:ring-ember-500/50
focus-visible:ring-offset-2
focus-visible:ring-offset-slate-900
```

This provides:
- 2px ring width for visibility
- Ember color for brand consistency
- 50% opacity for subtlety
- Offset for spacing from element

---

## Reduced Motion

The design system respects `prefers-reduced-motion`:

```css
@media (prefers-reduced-motion: reduce) {
  *, *::before, *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}
```

Components affected:
- Spinner (stops spinning)
- Progress (no animation)
- Pulse animations (disabled)
- Transitions (instant)

Essential feedback remains visible (colors, states).

---

## Color Contrast

All text meets WCAG AA contrast ratios:

| Element | Ratio | Requirement |
|---------|-------|-------------|
| Body text (slate-200 on slate-900) | 7.5:1 | 4.5:1 (normal) |
| Secondary text (slate-400 on slate-900) | 4.8:1 | 4.5:1 (normal) |
| Large headings | 7.5:1+ | 3:1 (large) |
| Ember accent | 4.6:1 | 3:1 (large/UI) |

---

## Touch Targets

All interactive elements have minimum 44x44px touch target:

```jsx
// Button sizes ensure touch compliance
<Button size="sm">44px height</Button>
<Button size="md">48px height</Button>
<Button size="lg">56px height</Button>
```

---

## Testing

### Automated

jest-axe tests verify WCAG compliance:

```javascript
import { axe, toHaveNoViolations } from 'jest-axe';
expect.extend(toHaveNoViolations);

it('has no accessibility violations', async () => {
  const { container } = render(<Button>Test</Button>);
  const results = await axe(container);
  expect(results).toHaveNoViolations();
});
```

### Manual

Test checklist:
- [ ] Tab through all interactive elements
- [ ] Activate with Enter/Space
- [ ] Close modals with Escape
- [ ] Test with screen reader (VoiceOver/NVDA)
- [ ] Test with reduced motion preference
- [ ] Verify focus visible on all elements

---

## See Also

- [Design System](./design-system.md) - Component reference
- `/debug/design-system` - Live interactive examples
```
  </action>
  <verify>
    - docs/accessibility.md exists and is >200 lines
    - Includes keyboard navigation table for all interactive components
    - Includes ARIA patterns section
    - Includes focus indicators section
    - Includes reduced motion section
    - Includes testing section
  </verify>
  <done>
    - docs/accessibility.md provides comprehensive accessibility guide
    - Keyboard navigation documented for all interactive components
    - ARIA patterns documented with code examples
    - Focus indicators, reduced motion, color contrast documented
    - Testing guidance included
  </done>
</task>

</tasks>

<verification>
1. docs/design-system.md is comprehensive (>400 lines)
2. docs/design-system.md lists all component categories
3. docs/design-system.md references /debug/design-system
4. docs/accessibility.md exists (>200 lines)
5. docs/accessibility.md has keyboard navigation tables
6. docs/accessibility.md has ARIA patterns
7. Both files cross-reference each other
</verification>

<success_criteria>
- [ ] docs/design-system.md updated with v3.0 component library
- [ ] All 4 component categories documented with props
- [ ] Component patterns section (CVA, namespace, layout)
- [ ] docs/accessibility.md created
- [ ] Keyboard navigation for all interactive components
- [ ] ARIA patterns documented
- [ ] Focus indicators documented
- [ ] Reduced motion documented
- [ ] Cross-references between both files
</success_criteria>

<output>
After completion, create `.planning/phases/18-documentation-polish/18-04-SUMMARY.md`
</output>
