---
phase: 21-lightscard-compliance
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - app/components/devices/lights/LightsCard.js
autonomous: true

must_haves:
  truths:
    - "User sees scene buttons with icon above text (vertical layout)"
    - "User can activate scenes by tapping scene buttons"
    - "Scene buttons have consistent Button component styling"
    - "Horizontal scroll container preserves snap-scroll behavior"
  artifacts:
    - path: "app/components/devices/lights/LightsCard.js"
      provides: "Scene buttons using design system Button component"
      contains: "<Button.*variant.*subtle"
  key_links:
    - from: "LightsCard.js scene Button"
      to: "handleSceneActivate"
      via: "onClick handler"
      pattern: "onClick.*handleSceneActivate"
---

<objective>
Replace raw `<button>` scene elements in LightsCard with the design system Button component.

Purpose: Achieve design system compliance for scene buttons while preserving the card-like vertical layout (icon above text) and horizontal scrolling behavior.

Output: Scene buttons use Button component with custom children layout for vertical icon+text arrangement.
</objective>

<execution_context>
@/Users/federicomanfredi/.claude/get-shit-done/workflows/execute-plan.md
@/Users/federicomanfredi/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/21-lightscard-compliance/21-CONTEXT.md
@.planning/phases/21-lightscard-compliance/21-RESEARCH.md
@app/components/devices/lights/LightsCard.js
@app/components/ui/Button.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Replace raw scene buttons with Button component</name>
  <files>app/components/devices/lights/LightsCard.js</files>
  <action>
Replace the raw `<button>` scene elements (lines 1149-1159) with the design system Button component.

**Key preservation requirements:**
1. Keep horizontal scroll container structure (flex, overflow-x-auto, snap-x)
2. Keep card-like vertical layout (icon above text)
3. Keep fixed width (w-32 sm:w-36) for horizontal scrolling
4. Keep snap-start for snap scroll behavior

**Implementation:**

Replace lines 1149-1159:
```jsx
<button
  key={scene.id}
  onClick={() => handleSceneActivate(scene.id)}
  disabled={refreshing}
  className="flex-shrink-0 w-32 sm:w-36 p-4 rounded-xl border bg-slate-800/50 border-slate-700/50 text-slate-300 hover:bg-warning-900/30 hover:border-warning-500/40 hover:text-warning-300 transition-all duration-200 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed snap-start font-display [html:not(.dark)_&]:bg-white/80 [html:not(.dark)_&]:border-slate-200 [html:not(.dark)_&]:text-slate-600 [html:not(.dark)_&]:hover:bg-warning-100/80 [html:not(.dark)_&]:hover:border-warning-300 [html:not(.dark)_&]:hover:text-warning-700"
>
  <div className="text-3xl mb-2">ðŸŽ¨</div>
  <div className="text-xs font-semibold truncate">
    {scene.metadata?.name || 'Scena'}
  </div>
</button>
```

With:
```jsx
<Button
  key={scene.id}
  variant="subtle"
  onClick={() => handleSceneActivate(scene.id)}
  disabled={refreshing}
  aria-label={`Attiva scena ${scene.metadata?.name || 'Scena'}`}
  className="flex-shrink-0 w-32 sm:w-36 !p-4 flex-col !h-auto snap-start"
>
  <span className="text-3xl mb-2" aria-hidden="true">ðŸŽ¨</span>
  <span className="text-xs font-semibold truncate w-full text-center">
    {scene.metadata?.name || 'Scena'}
  </span>
</Button>
```

**Key styling notes:**
- `variant="subtle"` - matches the glass effect of the current styling
- `!p-4` - override Button's default padding with important
- `flex-col` - changes flex direction to vertical (icon above text)
- `!h-auto` - override Button's min-height for card-like appearance
- `snap-start` - preserves horizontal scroll snapping
- `aria-label` - provides accessible name for screen readers

**Button already imported:** The Button component is already imported from `../../ui` in the existing imports.

**Do NOT change:**
- The scroll container structure (div with flex gap-3 overflow-x-auto)
- The scroll indicator at the bottom
- The Divider above the scenes section
  </action>
  <verify>
- Scene buttons render with vertical icon+text layout
- Horizontal scroll works (can swipe/scroll through scenes)
- Snap scrolling works (scrolling snaps to button boundaries)
- Click/tap activates scene (handleSceneActivate called)
- Disabled state works during refreshing
- Focus ring visible when navigating with keyboard
- `npm run dev` - no console errors
  </verify>
  <done>
- Raw `<button>` replaced with Button component
- Vertical layout preserved (icon above text)
- Horizontal scroll container unchanged
- Snap scroll behavior preserved
- Accessibility improved with aria-label
  </done>
</task>

<task type="auto">
  <name>Task 2: Verify adaptive styling integration</name>
  <files>app/components/devices/lights/LightsCard.js</files>
  <action>
Verify that scene buttons work correctly with the adaptive styling system.

**Current state:** Scene buttons are OUTSIDE the dynamic color container (they're in a separate section after Divider), so they don't need adaptive styling like the brightness controls do.

**Verification checklist:**
1. Scene buttons are in the "Scenes" section after the Divider
2. They don't inherit the dynamic room color background
3. The `subtle` variant provides appropriate styling for both light/dark mode via its built-in light mode classes

**No changes needed if:**
- Scene buttons are outside the dynamic color area (they are)
- Button subtle variant handles light/dark mode internally (it does)

**If scene buttons were inside dynamic color area:** Would need to add adaptive.buttonVariant and adaptive.buttonClass like the on/off buttons. But they're not, so skip this.

Review the structure to confirm scene buttons are positioned correctly (after the main control div closes).
  </action>
  <verify>
- Scene buttons use Button subtle variant
- Light/dark mode theming works via Button's built-in classes
- No adaptive.* classes needed for scenes (outside dynamic area)
  </verify>
  <done>
- Scene buttons correctly positioned outside adaptive color area
- Button subtle variant provides appropriate theming
- No additional adaptive styling needed
  </done>
</task>

</tasks>

<verification>
1. **Visual:** Scene buttons show icon above text in card-like appearance
2. **Scroll:** Horizontal scroll with snap behavior preserved
3. **Functional:** Tapping scene activates it correctly
4. **Accessibility:** Buttons focusable, have aria-label, show focus ring
5. **Theming:** Light/dark mode handled by Button component
6. **Design system:** Uses Button component from ../../ui
</verification>

<success_criteria>
- [ ] No raw `<button>` elements for scenes in LightsCard.js
- [ ] Button component with subtle variant used
- [ ] Vertical layout (icon above text) preserved
- [ ] Horizontal scroll container unchanged
- [ ] Snap scroll behavior works
- [ ] Accessibility improved (aria-label on buttons)
</success_criteria>

<output>
After completion, create `.planning/phases/21-lightscard-compliance/21-02-SUMMARY.md`
</output>
