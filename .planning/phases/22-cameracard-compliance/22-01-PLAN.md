---
phase: 22-cameracard-compliance
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - app/components/devices/camera/CameraCard.js
  - app/components/devices/camera/EventPreviewModal.js
autonomous: true

must_haves:
  truths:
    - "CameraCard refresh button uses Button.Icon instead of raw button element"
    - "EventPreviewModal close button uses Button.Icon instead of raw button element"
    - "EventPreviewModal play overlay button uses Button instead of raw button element"
    - "All buttons have proper aria-label for accessibility"
  artifacts:
    - path: "app/components/devices/camera/CameraCard.js"
      provides: "Design system compliant refresh button"
      contains: "Button.Icon"
    - path: "app/components/devices/camera/EventPreviewModal.js"
      provides: "Design system compliant close and play buttons"
      contains: "Button.Icon"
  key_links:
    - from: "CameraCard.js"
      to: "Button component"
      via: "import and usage"
      pattern: "Button\\.Icon"
    - from: "EventPreviewModal.js"
      to: "Button component"
      via: "import for icon buttons"
      pattern: "Button\\.Icon"
---

<objective>
Replace raw HTML button elements in CameraCard and EventPreviewModal with design system Button/Button.Icon components.

Purpose: Achieve design system compliance for camera UI components - replacing 3 raw buttons with accessible, consistently styled design system components.

Output: CameraCard.js and EventPreviewModal.js using Button.Icon for all icon-only buttons with proper aria-labels and preserved visual styling.
</objective>

<execution_context>
@/Users/federicomanfredi/.claude/get-shit-done/workflows/execute-plan.md
@/Users/federicomanfredi/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/22-cameracard-compliance/22-RESEARCH.md
@app/components/devices/camera/CameraCard.js
@app/components/devices/camera/EventPreviewModal.js
@app/components/ui/Button.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate CameraCard refresh button to Button.Icon</name>
  <files>app/components/devices/camera/CameraCard.js</files>
  <action>
1. Add lucide-react import for RefreshCw icon:
   ```javascript
   import { RefreshCw } from 'lucide-react';
   ```

2. Replace the raw button (lines 322-331) with Button.Icon:
   ```jsx
   <Button.Icon
     icon={<RefreshCw className={`w-4 h-4 text-white ${refreshing ? 'animate-spin' : ''}`} />}
     onClick={handleRefresh}
     variant="ghost"
     size="sm"
     aria-label="Aggiorna snapshot"
     className="absolute bottom-2 right-2 bg-slate-900/70 backdrop-blur-sm hover:bg-slate-800/90"
   />
   ```

Note: The Button import already exists on line 8. Preserve absolute positioning and backdrop blur classes in className.
  </action>
  <verify>
- No raw `<button>` element for refresh (grep confirms)
- Button.Icon used with aria-label
- RefreshCw icon imported from lucide-react
- Visual appearance unchanged (refresh button still bottom-right with spin animation)
  </verify>
  <done>CameraCard refresh button uses Button.Icon with proper aria-label and preserved overlay styling</done>
</task>

<task type="auto">
  <name>Task 2: Migrate EventPreviewModal close button to Button.Icon</name>
  <files>app/components/devices/camera/EventPreviewModal.js</files>
  <action>
1. Add lucide-react import for X icon:
   ```javascript
   import { X } from 'lucide-react';
   ```

2. Replace the close button (lines 117-125) with Button.Icon:
   ```jsx
   <Button.Icon
     icon={<X className="w-6 h-6" />}
     onClick={onClose}
     variant="ghost"
     size="md"
     aria-label="Chiudi"
     className="text-slate-400 hover:bg-slate-800 [html:not(.dark)_&]:hover:bg-slate-100"
   />
   ```

Note: Button import already exists on line 4. Preserve hover styling for dark/light mode.
  </action>
  <verify>
- No raw `<button>` for close in header
- Button.Icon used with aria-label="Chiudi"
- X icon imported from lucide-react
- Hover states preserved for dark/light modes
  </verify>
  <done>EventPreviewModal close button uses Button.Icon with accessibility and proper hover states</done>
</task>

<task type="auto">
  <name>Task 3: Migrate EventPreviewModal play overlay button to Button</name>
  <files>app/components/devices/camera/EventPreviewModal.js</files>
  <action>
1. Add Play icon to the lucide-react import:
   ```javascript
   import { X, Play } from 'lucide-react';
   ```

2. Replace the play overlay button (lines 165-174) with Button using children:
   ```jsx
   <Button
     variant="ghost"
     onClick={() => setIsPlaying(true)}
     className="absolute inset-0 flex items-center justify-center bg-black/30 hover:bg-black/40 rounded-none group"
     aria-label="Riproduci video"
   >
     <div className="w-20 h-20 rounded-full bg-white/90 group-hover:bg-white flex items-center justify-center shadow-lg transition-all group-hover:scale-110">
       <Play className="w-10 h-10 text-slate-900 ml-1" fill="currentColor" />
     </div>
   </Button>
   ```

Note: Use Button with children (not Button.Icon) because the play button has complex nested structure (circle + icon). Include "group" class on Button for hover effect propagation.
  </action>
  <verify>
- No raw `<button>` for play overlay
- Button component used with aria-label="Riproduci video"
- Play icon from lucide-react with fill="currentColor"
- Group hover scale effect still works (110% scale on hover)
  </verify>
  <done>EventPreviewModal play overlay uses Button with proper accessibility and preserved hover scale animation</done>
</task>

</tasks>

<verification>
Run these checks after all tasks complete:

```bash
# Verify no raw buttons remain in CameraCard (except design system Button)
grep -n "<button" app/components/devices/camera/CameraCard.js

# Verify no raw buttons remain in EventPreviewModal (except design system Button)
grep -n "<button" app/components/devices/camera/EventPreviewModal.js

# Verify lucide-react icons imported
grep -n "lucide-react" app/components/devices/camera/CameraCard.js
grep -n "lucide-react" app/components/devices/camera/EventPreviewModal.js

# Verify Button.Icon usage
grep -n "Button.Icon" app/components/devices/camera/CameraCard.js
grep -n "Button.Icon" app/components/devices/camera/EventPreviewModal.js

# Verify aria-labels present
grep -n "aria-label" app/components/devices/camera/CameraCard.js
grep -n "aria-label" app/components/devices/camera/EventPreviewModal.js
```

Expected results:
- grep for `<button` returns NO matches (all raw buttons replaced)
- lucide-react imports confirmed in both files
- Button.Icon usage confirmed
- aria-labels found for all interactive buttons
</verification>

<success_criteria>
1. Zero raw `<button>` elements in CameraCard.js (refresh uses Button.Icon)
2. Zero raw `<button>` elements in EventPreviewModal.js (close uses Button.Icon, play uses Button)
3. All buttons have aria-label for accessibility
4. Visual appearance unchanged (overlay positioning, backdrop blur, hover states preserved)
5. Spin animation on refresh still works when refreshing
6. Play button scale animation on hover still works
</success_criteria>

<output>
After completion, create `.planning/phases/22-cameracard-compliance/22-01-SUMMARY.md`
</output>
