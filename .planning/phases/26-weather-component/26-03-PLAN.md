---
phase: 26-weather-component
plan: 03
type: execute
wave: 2
depends_on: ["26-01"]
files_modified:
  - app/components/weather/ForecastRow.jsx
  - app/components/weather/ForecastDayCard.jsx
  - app/components/weather/ForecastDaySheet.jsx
  - app/styles/globals.css
autonomous: true

must_haves:
  truths:
    - "User can see 5-day forecast in horizontal scrollable row"
    - "User sees day name, icon, high/low temperatures for each forecast day"
    - "User sees precipitation chance on forecast days"
    - "User can tap a forecast day to see detailed information"
    - "Bottom sheet shows extended stats (humidity, wind, UV, sunrise/sunset)"
    - "Horizontal scroll has smooth touch-friendly behavior on iOS"
  artifacts:
    - path: "app/components/weather/ForecastRow.jsx"
      provides: "Horizontal scrollable forecast container"
      min_lines: 40
      exports: ["ForecastRow"]
    - path: "app/components/weather/ForecastDayCard.jsx"
      provides: "Single forecast day card"
      min_lines: 50
      exports: ["ForecastDayCard"]
    - path: "app/components/weather/ForecastDaySheet.jsx"
      provides: "Bottom sheet with day details"
      min_lines: 80
      exports: ["ForecastDaySheet"]
  key_links:
    - from: "app/components/weather/ForecastRow.jsx"
      to: "app/components/weather/ForecastDayCard.jsx"
      via: "renders day cards"
      pattern: "import.*ForecastDayCard"
    - from: "app/components/weather/ForecastDaySheet.jsx"
      to: "app/components/ui/BottomSheet.js"
      via: "BottomSheet wrapper"
      pattern: "import.*BottomSheet"
    - from: "app/components/weather/ForecastDayCard.jsx"
      to: "app/components/weather/WeatherIcon.jsx"
      via: "weather icon display"
      pattern: "import.*WeatherIcon"
---

<objective>
Create the 5-day forecast components with horizontal scroll and bottom sheet for day details.

Purpose: Completes the weather card by adding the forecast row (Apple Weather style horizontal scroll) and tappable day cards that open a bottom sheet with detailed information.

Output:
- ForecastRow.jsx - Horizontal scrollable container with snap points
- ForecastDayCard.jsx - Individual day card (day name, icon, high/low, precip)
- ForecastDaySheet.jsx - Bottom sheet with hourly breakdown and extended stats
- CSS utility for hiding scrollbar
</objective>

<execution_context>
@/Users/federicomanfredi/.claude/get-shit-done/workflows/execute-plan.md
@/Users/federicomanfredi/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/26-weather-component/26-CONTEXT.md
@.planning/phases/26-weather-component/26-RESEARCH.md
@.planning/phases/25-weather-foundation/25-01-SUMMARY.md

# Design system components
@app/components/ui/BottomSheet.js
@app/components/ui/Text.js
@app/components/ui/Badge.js

# Weather helpers from Plan 01
# Note: Plan 01 creates WeatherIcon and weatherHelpers
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ForecastDayCard component</name>
  <files>app/components/weather/ForecastDayCard.jsx</files>
  <action>
Create the individual forecast day card that appears in the horizontal row.

**Component structure:**
```jsx
'use client';

import { Text } from '@/app/components/ui';
import { WeatherIcon } from './WeatherIcon';
import { formatTemperature, getPrecipitationLabel } from './weatherHelpers';
import { format, parseISO } from 'date-fns';
import { it } from 'date-fns/locale';
```

**Props:**
- `day` (object): Forecast day data with:
  - `date` (string): ISO date string (e.g., "2026-02-03")
  - `tempMax` (number): Maximum temperature
  - `tempMin` (number): Minimum temperature
  - `condition` (object): { description, icon } from interpretWeatherCode
  - `precipChance` (number, optional): Precipitation probability percentage
  - `weatherCode` (number): WMO weather code (for WeatherIcon)
- `isToday` (boolean): Show "Oggi" instead of day name
- `onClick` (function): Callback when card is tapped
- `className` (string): Additional CSS classes

**Layout (vertical stack):**
1. Day name (e.g., "Lun", "Mar", "Oggi")
2. Weather icon (32px, centered)
3. High temperature (larger)
4. Low temperature (smaller, secondary)
5. Precipitation chance badge (if > 10%)

**Day name formatting:**
```jsx
const dayName = isToday
  ? 'Oggi'
  : format(parseISO(day.date), 'EEE', { locale: it });
// Capitalize first letter: "lun" -> "Lun"
```

**Precipitation badge:**
Only show if precipChance > 10:
```jsx
{day.precipChance > 10 && (
  <div className="flex items-center gap-0.5 text-ocean-400 mt-1">
    <Droplets className="w-3 h-3" />
    <Text size="xs">{day.precipChance}%</Text>
  </div>
)}
```

**Styling:**
```jsx
<div
  className={cn(
    'flex flex-col items-center p-3 rounded-xl cursor-pointer',
    'bg-slate-800/40 hover:bg-slate-800/60',
    '[html:not(.dark)_&]:bg-slate-100/80 [html:not(.dark)_&]:hover:bg-slate-200/80',
    'transition-colors duration-200',
    className
  )}
  onClick={onClick}
  role="button"
  tabIndex={0}
  onKeyDown={(e) => e.key === 'Enter' && onClick?.()}
>
```

**Export as named export and default export.**
  </action>
  <verify>
- File exists at app/components/weather/ForecastDayCard.jsx
- Shows day name (or "Oggi" for today)
- Shows weather icon matching condition
- Shows high/low temperatures with one decimal
- Shows precipitation badge only when > 10%
- Has hover state and click handler
- Is keyboard accessible
  </verify>
  <done>
ForecastDayCard displays individual day with icon, temperatures, and optional precipitation
  </done>
</task>

<task type="auto">
  <name>Task 2: Create ForecastRow component</name>
  <files>app/components/weather/ForecastRow.jsx</files>
  <action>
Create the horizontal scrollable container for forecast day cards.

**Component structure:**
```jsx
'use client';

import { ForecastDayCard } from './ForecastDayCard';
import { isToday } from 'date-fns';
```

**Props:**
- `forecast` (array): Array of forecast day objects from API
- `onDayClick` (function): Callback when a day is clicked - receives day data

**Layout:**

1. **Container with fade gradient:**
```jsx
<div className="relative">
  {/* Fade gradient indicator on right */}
  <div className="absolute inset-y-0 right-0 w-8 bg-gradient-to-l from-slate-900 to-transparent pointer-events-none z-10 [html:not(.dark)_&]:from-white" />

  {/* Scrollable row */}
  <div className="
    flex gap-3
    overflow-x-auto
    pb-2
    scrollbar-hide
    snap-x snap-mandatory
    [-webkit-overflow-scrolling:touch]
  ">
    {forecast.map((day, index) => (
      <ForecastDayCard
        key={day.date}
        day={day}
        isToday={index === 0}
        onClick={() => onDayClick(day)}
        className="flex-shrink-0 w-20 snap-start"
      />
    ))}
  </div>
</div>
```

**Important CSS classes:**
- `scrollbar-hide`: Hide scrollbar (defined in globals.css)
- `snap-x snap-mandatory`: Horizontal snap scrolling
- `[-webkit-overflow-scrolling:touch]`: Smooth iOS momentum scrolling
- `flex-shrink-0`: Prevent cards from shrinking
- `snap-start`: Snap to card start

**Note:** First day in API response is today, so use index === 0 for isToday.

**Export as named export and default export.**
  </action>
  <verify>
- File exists at app/components/weather/ForecastRow.jsx
- Renders ForecastDayCard for each day in forecast array
- Has horizontal scroll with snap points
- Has fade gradient on right edge
- First card shows "Oggi"
- Click handlers pass day data to onDayClick
  </verify>
  <done>
ForecastRow provides horizontal scrollable forecast with snap points and touch-friendly behavior
  </done>
</task>

<task type="auto">
  <name>Task 3: Create ForecastDaySheet bottom sheet</name>
  <files>app/components/weather/ForecastDaySheet.jsx</files>
  <action>
Create the bottom sheet component for detailed day forecast.

**Component structure:**
```jsx
'use client';

import BottomSheet from '@/app/components/ui/BottomSheet';
import { Text, Badge } from '@/app/components/ui';
import { WeatherIcon, getWeatherLabel } from './WeatherIcon';
import { formatTemperature, getUVIndexLabel, formatWindSpeed } from './weatherHelpers';
import { Sunrise, Sunset, Droplets, Wind, Sun, Thermometer } from 'lucide-react';
import { format, parseISO } from 'date-fns';
import { it } from 'date-fns/locale';
```

**Props:**
- `day` (object|null): Forecast day data (null when closed)
- `isOpen` (boolean): Sheet visibility
- `onClose` (function): Close handler

**Layout:**

1. **Header (handled by BottomSheet):**
   - Title: Full day name + date (e.g., "Lunedi 3 Febbraio")
   - Icon: WeatherIcon for the day's condition

2. **Temperature range (prominent):**
```jsx
<div className="text-center mb-6">
  <div className="flex items-center justify-center gap-4">
    <div>
      <Text variant="tertiary" size="xs" className="mb-1">Max</Text>
      <Text size="3xl" weight="bold" className="text-ember-400">
        {formatTemperature(day.tempMax)}°
      </Text>
    </div>
    <div className="w-px h-12 bg-slate-700/50" />
    <div>
      <Text variant="tertiary" size="xs" className="mb-1">Min</Text>
      <Text size="3xl" weight="bold" className="text-ocean-400">
        {formatTemperature(day.tempMin)}°
      </Text>
    </div>
  </div>
</div>
```

3. **Condition description:**
```jsx
<div className="text-center mb-6">
  <WeatherIcon code={day.weatherCode} size={48} className="mx-auto mb-2 text-ocean-400" />
  <Text size="lg">{day.condition.description}</Text>
</div>
```

4. **Extended stats grid (2 columns):**
```jsx
<div className="grid grid-cols-2 gap-4">
  {/* UV Index */}
  <div className="p-4 bg-slate-800/40 rounded-xl [html:not(.dark)_&]:bg-slate-100/80">
    <div className="flex items-center gap-2 mb-1">
      <Sun className="w-4 h-4 text-warning-400" fill="currentColor" strokeWidth={0} />
      <Text variant="tertiary" size="xs">Indice UV</Text>
    </div>
    <Text size="lg">{day.uvIndex || 'N/D'}</Text>
    {day.uvIndex && (
      <Text variant="secondary" size="xs">{getUVIndexLabel(day.uvIndex)}</Text>
    )}
  </div>

  {/* Humidity */}
  <div className="p-4 bg-slate-800/40 rounded-xl [html:not(.dark)_&]:bg-slate-100/80">
    <div className="flex items-center gap-2 mb-1">
      <Droplets className="w-4 h-4 text-ocean-400" />
      <Text variant="tertiary" size="xs">Umidita</Text>
    </div>
    <Text size="lg">{day.humidity || 'N/D'}%</Text>
  </div>

  {/* Wind Speed */}
  <div className="p-4 bg-slate-800/40 rounded-xl [html:not(.dark)_&]:bg-slate-100/80">
    <div className="flex items-center gap-2 mb-1">
      <Wind className="w-4 h-4 text-slate-400" />
      <Text variant="tertiary" size="xs">Vento</Text>
    </div>
    <Text size="lg">{day.windSpeed ? formatWindSpeed(day.windSpeed) : 'N/D'}</Text>
  </div>

  {/* Precipitation */}
  <div className="p-4 bg-slate-800/40 rounded-xl [html:not(.dark)_&]:bg-slate-100/80">
    <div className="flex items-center gap-2 mb-1">
      <Droplets className="w-4 h-4 text-ocean-400" fill="currentColor" strokeWidth={0} />
      <Text variant="tertiary" size="xs">Precipitazioni</Text>
    </div>
    <Text size="lg">{day.precipChance ?? 0}%</Text>
  </div>
</div>
```

5. **Sunrise/Sunset (if available):**
```jsx
{(day.sunrise || day.sunset) && (
  <div className="grid grid-cols-2 gap-4 mt-4">
    {day.sunrise && (
      <div className="p-4 bg-slate-800/40 rounded-xl [html:not(.dark)_&]:bg-slate-100/80">
        <div className="flex items-center gap-2 mb-1">
          <Sunrise className="w-4 h-4 text-warning-400" />
          <Text variant="tertiary" size="xs">Alba</Text>
        </div>
        <Text size="lg">{day.sunrise}</Text>
      </div>
    )}
    {day.sunset && (
      <div className="p-4 bg-slate-800/40 rounded-xl [html:not(.dark)_&]:bg-slate-100/80">
        <div className="flex items-center gap-2 mb-1">
          <Sunset className="w-4 h-4 text-ember-400" />
          <Text variant="tertiary" size="xs">Tramonto</Text>
        </div>
        <Text size="lg">{day.sunset}</Text>
      </div>
    )}
  </div>
)}
```

**Note on data availability:**
Phase 25 API only includes basic daily data (temp, condition).
Extended fields (uvIndex, humidity, windSpeed, sunrise, sunset, precipChance) may not be present.
Handle missing data gracefully with "N/D" (non disponibile) or conditional rendering.

**Export as named export and default export.**
  </action>
  <verify>
- File exists at app/components/weather/ForecastDaySheet.jsx
- Uses BottomSheet component for modal
- Shows temperature range (max in ember, min in ocean colors)
- Shows weather condition with icon and description
- Shows extended stats grid with UV, humidity, wind, precipitation
- Handles missing data gracefully with "N/D" or conditional rendering
- Close button and backdrop click work
  </verify>
  <done>
ForecastDaySheet provides detailed day view in bottom sheet with extended weather stats
  </done>
</task>

<task type="auto">
  <name>Task 4: Add scrollbar-hide CSS utility</name>
  <files>app/styles/globals.css</files>
  <action>
Add the scrollbar-hide utility class if not already present.

**Check if scrollbar-hide already exists in globals.css. If not, add:**

```css
/* Hide scrollbar for horizontal scroll containers */
.scrollbar-hide::-webkit-scrollbar {
  display: none;
}
.scrollbar-hide {
  -ms-overflow-style: none;  /* IE and Edge */
  scrollbar-width: none;  /* Firefox */
}
```

**Location:** Add near other utility classes or at the end of the file before any @layer statements.

**If already exists:** Skip this task, the class is already available.
  </action>
  <verify>
- globals.css contains .scrollbar-hide class
- Class hides scrollbar on WebKit browsers
- Class hides scrollbar on Firefox
- Class hides scrollbar on IE/Edge
  </verify>
  <done>
scrollbar-hide CSS utility available for horizontal scroll containers
  </done>
</task>

</tasks>

<verification>
After completing all tasks:
1. ForecastDayCard renders individual days with proper formatting
2. ForecastRow provides horizontal scroll with snap points
3. ForecastDaySheet opens on tap with detailed information
4. scrollbar-hide utility hides scrollbar across browsers
5. All components use Italian labels
6. No TypeScript/ESLint errors
</verification>

<success_criteria>
- 5-day forecast displays in horizontal scrollable row
- Each day shows name, icon, high/low, and precipitation (if > 10%)
- Horizontal scroll is smooth with snap points on touch devices
- Tapping a day opens bottom sheet with detailed stats
- Bottom sheet shows temperature range, condition, extended stats
- Missing data handled gracefully
- First day shows "Oggi" instead of day name
</success_criteria>

<output>
After completion, create `.planning/phases/26-weather-component/26-03-SUMMARY.md`
</output>
