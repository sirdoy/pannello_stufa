---
phase: 35-micro-interactions
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - app/globals.css
autonomous: true

must_haves:
  truths:
    - "Interactions feel smooth and consistent across the app"
    - "Lists and grids cascade smoothly into view"
    - "Users with motion sensitivity see instant state changes"
    - "Loading spinners still animate for users with reduced motion"
  artifacts:
    - path: "app/globals.css"
      provides: "Animation token system and stagger classes"
      contains: "--duration-smooth"
  key_links:
    - from: "app/globals.css"
      to: "@theme block"
      via: "CSS custom properties"
      pattern: "--duration-|--ease-|--stagger-"
---

<objective>
Establish the animation token foundation in globals.css with centralized timing tokens, stagger system CSS, and refined reduced motion support.

Purpose: Create consistent, accessible animation system that all components can reference
Output: Extended @theme block with animation tokens, stagger utility classes, refined reduced motion rules
</objective>

<execution_context>
@/Users/federicomanfredi/.claude/get-shit-done/workflows/execute-plan.md
@/Users/federicomanfredi/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/35-micro-interactions/35-CONTEXT.md
@.planning/phases/35-micro-interactions/35-RESEARCH.md
@app/globals.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add animation tokens to @theme block</name>
  <files>app/globals.css</files>
  <action>
Add animation tokens to the existing @theme block (after line 278, near --ease-spring):

```css
/* ===== ANIMATION TIMING TOKENS ===== */

/* Duration tokens - semantic naming */
--duration-instant: 0ms;      /* Reduced motion fallback */
--duration-fast: 150ms;       /* Hover/focus states */
--duration-smooth: 300ms;     /* Enter/exit, most animations */
--duration-slow: 500ms;       /* Complex transforms */

/* Ease curve tokens - named by use case */
--ease-enter: cubic-bezier(0.16, 1, 0.3, 1);      /* ease-out-expo - responsive feel */
--ease-exit: cubic-bezier(0.4, 0, 1, 1);          /* ease-in-quad - quick departure */
--ease-move: cubic-bezier(0.4, 0, 0.2, 1);        /* ease-in-out - smooth repositioning */
--ease-spring-subtle: cubic-bezier(0.34, 1.1, 0.64, 1); /* 5% overshoot for polish */

/* Stagger timing tokens */
--stagger-fast: 30ms;   /* Dense lists (20+ items) */
--stagger-base: 50ms;   /* Standard lists (10-15 items) */
--stagger-slow: 80ms;   /* Hero grids (3-6 items) */
```

Note: --ease-spring already exists (line 278), keep it. --ease-out-expo also exists (line 275), --ease-enter is an alias using the same values.

Do NOT duplicate existing values - add only the new tokens.
  </action>
  <verify>
Grep globals.css for "--duration-smooth" and "--ease-enter" - both should exist.
No CSS syntax errors - file should parse correctly.
  </verify>
  <done>
Animation tokens exist in @theme: --duration-instant, --duration-fast, --duration-smooth, --duration-slow, --ease-enter, --ease-exit, --ease-move, --ease-spring-subtle, --stagger-fast, --stagger-base, --stagger-slow
  </done>
</task>

<task type="auto">
  <name>Task 2: Create stagger animation system</name>
  <files>app/globals.css</files>
  <action>
Add stagger animation system after the existing animation utility classes (around line 997, after .animate-scaleIn):

```css
/* ===== STAGGER ANIMATION SYSTEM ===== */

/* Stagger item - use with style={{ '--stagger-index': index }} */
.stagger-item {
  animation: stagger-fade-in var(--duration-smooth) var(--ease-enter) both;
  animation-delay: calc(var(--stagger-index, 0) * var(--stagger-base));
}

/* Stagger variants */
.stagger-item-fast {
  animation: stagger-fade-in var(--duration-smooth) var(--ease-enter) both;
  animation-delay: calc(var(--stagger-index, 0) * var(--stagger-fast));
}

.stagger-item-slow {
  animation: stagger-fade-in var(--duration-smooth) var(--ease-enter) both;
  animation-delay: calc(var(--stagger-index, 0) * var(--stagger-slow));
}

@keyframes stagger-fade-in {
  from {
    opacity: 0;
    transform: translateY(8px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}
```

This enables usage like:
```jsx
{items.map((item, index) => (
  <li style={{ '--stagger-index': index }} className="stagger-item">
    {item.content}
  </li>
))}
```
  </action>
  <verify>
Grep globals.css for "stagger-fade-in" - keyframe should exist.
Grep globals.css for ".stagger-item" - class should exist.
  </verify>
  <done>
Stagger system available: .stagger-item, .stagger-item-fast, .stagger-item-slow with --stagger-index CSS variable support
  </done>
</task>

<task type="auto">
  <name>Task 3: Implement reduced motion support per user decision</name>
  <files>app/globals.css</files>
  <action>
Replace the current reduced motion block (lines 1054-1062) with rules that honor user decision:
- Decorative animations: INSTANT (animation: none, no transitions)
- Functional animations (spinners, progress, shimmer): KEEP ORIGINAL DURATION (not slowed)

```css
/* Reduced motion support - per user accessibility decision */
@media (prefers-reduced-motion: reduce) {
  /* Decorative animations - disable completely (instant state changes) */
  .animate-fade-in,
  .animate-fade-out,
  .animate-fade-in-up,
  .animate-fade-in-down,
  .animate-scale-in,
  .animate-scale-in-center,
  .animate-slide-down,
  .animate-slide-up,
  .animate-slide-in-from-bottom,
  .animate-slideInDown,
  .animate-dropdown,
  .animate-dropdown-up,
  .animate-spring-in,
  .animate-bounce-subtle,
  .animate-slideDown,
  .animate-fadeIn,
  .animate-fadeOut,
  .animate-scaleIn,
  .animate-accordion-down,
  .animate-accordion-up,
  .stagger-item,
  .stagger-item-fast,
  .stagger-item-slow {
    animation: none !important;
    opacity: 1 !important;
    transform: none !important;
  }

  /* Stagger delays - remove to show all items instantly */
  [style*="--stagger-index"] {
    animation-delay: 0ms !important;
  }

  /* Functional animations - KEEP ORIGINAL (loading spinners, progress, shimmer) */
  /* These are excluded from the above rules and retain their normal animation */
  /* .animate-spin, .animate-shimmer, .animate-pulse-ember, .animate-progress-indeterminate */
  /* No changes needed - they keep working as normal */

  /* Shake animation - keep for error feedback (functional) */
  /* .animate-shake keeps original duration */

  /* General transitions - instant state changes */
  *:not(.animate-spin):not(.animate-shimmer):not(.animate-shimmer-vertical):not(.animate-pulse-ember):not(.animate-glow-pulse):not(.animate-progress-indeterminate),
  *::before,
  *::after {
    transition-duration: 0.01ms !important;
  }

  /* Page transitions - disable completely */
  ::view-transition-old(root),
  ::view-transition-new(root) {
    animation: none !important;
  }
}
```

KEY CHANGES from original plan:
1. Functional animations (spinners, shimmer, progress) keep ORIGINAL duration - NOT slowed
2. General transitions use 0.01ms (effectively instant) - NOT 50ms
3. User decision: "Disable all animations (instant). Exception: Loading spinners remain animated (functional)"
  </action>
  <verify>
Grep globals.css for "transition-duration: 0.01ms" - should exist in reduced motion block.
Grep for ".animate-spin" - should NOT appear in the decorative animations list.
Functional animations should NOT have any duration override in reduced motion.
  </verify>
  <done>
Reduced motion rules: decorative animations disabled (instant), functional animations (spinners, progress, shimmer) keep original duration, transitions are instant (0.01ms)
  </done>
</task>

</tasks>

<verification>
1. All animation tokens present in @theme block
2. Stagger system works with --stagger-index CSS variable
3. Reduced motion: decorative animations instant, functional animations unchanged
4. No CSS syntax errors - dev server runs without issues
</verification>

<success_criteria>
- globals.css contains --duration-smooth, --ease-enter, --stagger-base tokens
- .stagger-item class exists with stagger-fade-in animation
- Reduced motion: transitions use 0.01ms, functional animations keep original duration
- npm run dev starts without CSS parsing errors
</success_criteria>

<output>
After completion, create `.planning/phases/35-micro-interactions/35-01-SUMMARY.md`
</output>
