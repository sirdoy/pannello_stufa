---
phase: 37-typescript-foundation
plan: 03
type: execute
wave: 2
depends_on: [37-02]
files_modified:
  - types/components/index.ts
  - types/components/common.ts
  - types/config/index.ts
  - types/config/constants.ts
  - types/index.ts
autonomous: true
user_setup: []

must_haves:
  truths:
    - "Developer can import component prop types from @/types/components"
    - "Developer can import config types from @/types/config"
    - "Types are consistent with existing component patterns"
  artifacts:
    - path: "types/components/common.ts"
      provides: "Common component prop types"
      contains: "ButtonProps"
    - path: "types/config/constants.ts"
      provides: "Configuration type definitions"
      contains: "AppConfig"
  key_links:
    - from: "types/index.ts"
      to: "types/components/index.ts"
      via: "Re-export"
      pattern: "export.*components"
    - from: "types/index.ts"
      to: "types/config/index.ts"
      via: "Re-export"
      pattern: "export.*config"
---

<objective>
Create component props types and configuration types.

Purpose: Complete the core types foundation for incremental migration.
Output: types/components/ and types/config/ directories (TYPE-03, TYPE-04).
</objective>

<execution_context>
@/Users/federicomanfredi/.claude/get-shit-done/workflows/execute-plan.md
@/Users/federicomanfredi/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/37-typescript-foundation/37-RESEARCH.md
@.planning/phases/37-typescript-foundation/37-02-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create common component prop types (TYPE-03)</name>
  <files>
types/components/index.ts
types/components/common.ts
  </files>
  <action>
Create types/components/ directory with common prop types used across the codebase.

**types/components/common.ts:**
```typescript
/**
 * Common component prop types
 *
 * These are shared prop patterns used across multiple components.
 * Individual component Props should be defined in the component file itself.
 */

import type { ReactNode, HTMLAttributes, ButtonHTMLAttributes } from 'react';

/**
 * Base props for components that accept children
 */
export interface WithChildren {
  children?: ReactNode;
}

/**
 * Base props for components that can be disabled
 */
export interface WithDisabled {
  disabled?: boolean;
}

/**
 * Base props for components with loading state
 */
export interface WithLoading {
  loading?: boolean;
}

/**
 * Base props for form-related components
 */
export interface WithFormField {
  name?: string;
  label?: string;
  error?: string;
  required?: boolean;
}

/**
 * Common size variants used in design system
 */
export type Size = 'xs' | 'sm' | 'md' | 'lg' | 'xl';

/**
 * Common color scheme variants (matches CVA variants)
 */
export type ColorScheme =
  | 'default'
  | 'primary'
  | 'secondary'
  | 'success'
  | 'warning'
  | 'danger'
  | 'ember'    // Custom theme color
  | 'ghost';

/**
 * Common variant prop for styled components
 */
export type Variant = 'solid' | 'outline' | 'ghost' | 'link';

/**
 * Base button props (extends HTML button attributes)
 */
export interface ButtonBaseProps extends ButtonHTMLAttributes<HTMLButtonElement> {
  variant?: Variant;
  size?: Size;
  colorScheme?: ColorScheme;
  loading?: boolean;
  leftIcon?: ReactNode;
  rightIcon?: ReactNode;
}

/**
 * Base card props
 */
export interface CardBaseProps extends HTMLAttributes<HTMLDivElement> {
  variant?: 'elevated' | 'outline' | 'filled';
  padding?: Size;
}

/**
 * Props for components that can be polymorphic (render as different elements)
 */
export interface AsChildProps {
  asChild?: boolean;
}

/**
 * Common icon props
 */
export interface IconProps {
  size?: number | string;
  color?: string;
  className?: string;
}

/**
 * Device card common props
 */
export interface DeviceCardBaseProps extends WithChildren {
  title: string;
  icon?: ReactNode;
  status?: 'online' | 'offline' | 'error' | 'loading';
  actions?: ReactNode;
  contextMenuItems?: ContextMenuItem[];
}

/**
 * Context menu item type
 */
export interface ContextMenuItem {
  label: string;
  icon?: ReactNode;
  onClick: () => void;
  disabled?: boolean;
  destructive?: boolean;
  shortcut?: string;
}

/**
 * Slot pattern for compound components
 */
export interface SlotProps {
  slot?: string;
}
```

**types/components/index.ts:**
```typescript
/**
 * Component type definitions barrel export
 */

export type {
  WithChildren,
  WithDisabled,
  WithLoading,
  WithFormField,
  Size,
  ColorScheme,
  Variant,
  ButtonBaseProps,
  CardBaseProps,
  AsChildProps,
  IconProps,
  DeviceCardBaseProps,
  ContextMenuItem,
  SlotProps,
} from './common';
```
  </action>
  <verify>
Create test file `temp-component-types.ts`:
```typescript
import type { ButtonBaseProps, Size, ColorScheme, DeviceCardBaseProps } from '@/types/components';

const buttonProps: ButtonBaseProps = {
  variant: 'solid',
  size: 'md',
  colorScheme: 'ember',
  onClick: () => {},
};

const size: Size = 'lg';
const color: ColorScheme = 'primary';

export { buttonProps, size, color };
```
Run `npx tsc --noEmit temp-component-types.ts` - should pass.
Delete temp file after verification.
  </verify>
  <done>Component types created with common prop patterns (TYPE-03)</done>
</task>

<task type="auto">
  <name>Task 2: Create configuration and constants types (TYPE-04)</name>
  <files>
types/config/index.ts
types/config/constants.ts
  </files>
  <action>
Create types/config/ directory with configuration and constants type definitions.

**types/config/constants.ts:**
```typescript
/**
 * Configuration and constants type definitions
 */

/**
 * Application environment
 */
export type AppEnvironment = 'development' | 'production' | 'test';

/**
 * Application configuration
 */
export interface AppConfig {
  env: AppEnvironment;
  apiBaseUrl: string;
  firebase: {
    databaseUrl: string;
    projectId: string;
  };
  auth: {
    domain: string;
    clientId: string;
  };
}

/**
 * Dashboard card identifiers
 */
export type DashboardCardId =
  | 'stove'
  | 'thermostat'
  | 'hue'
  | 'camera'
  | 'weather'
  | 'maintenance'
  | 'schedule'
  | 'monitoring';

/**
 * Dashboard card configuration
 */
export interface DashboardCardConfig {
  id: DashboardCardId;
  title: string;
  enabled: boolean;
  order: number;
}

/**
 * User dashboard preferences (stored in Firebase)
 */
export interface DashboardPreferences {
  cards: DashboardCardConfig[];
  lastUpdated?: string;
}

/**
 * Location configuration for weather
 */
export interface LocationConfig {
  city: string;
  latitude: number;
  longitude: number;
  timezone?: string;
}

/**
 * Weather display configuration
 */
export interface WeatherConfig {
  location: LocationConfig;
  units: 'metric' | 'imperial';
  showForecast: boolean;
  forecastDays: number;
}

/**
 * Stove configuration
 */
export interface StoveConfig {
  host: string;
  port: number;
  timeout: number;
  maintenanceThresholdHours: number;
}

/**
 * Netatmo OAuth configuration
 */
export interface NetatmoConfig {
  clientId: string;
  clientSecret: string;
  redirectUri: string;
  scope: string[];
}

/**
 * Hue bridge configuration
 */
export interface HueConfig {
  bridgeIp?: string;
  username?: string;
  clientKey?: string;
}

/**
 * Notification rate limit configuration
 */
export interface RateLimitConfig {
  windowMs: number;
  maxRequests: number;
  byType: Record<string, number>;
}

/**
 * Cron job configuration
 */
export interface CronConfig {
  enabled: boolean;
  secret: string;
  jobs: {
    healthCheck: { intervalMs: number };
    coordination: { intervalMs: number };
    tokenCleanup: { intervalMs: number };
  };
}

/**
 * Feature flags
 */
export interface FeatureFlags {
  enableWeather: boolean;
  enableDashboardCustomization: boolean;
  enableContextMenu: boolean;
  enableCommandPalette: boolean;
  enableAnimations: boolean;
}
```

**types/config/index.ts:**
```typescript
/**
 * Configuration type definitions barrel export
 */

export type {
  AppEnvironment,
  AppConfig,
  DashboardCardId,
  DashboardCardConfig,
  DashboardPreferences,
  LocationConfig,
  WeatherConfig,
  StoveConfig,
  NetatmoConfig,
  HueConfig,
  RateLimitConfig,
  CronConfig,
  FeatureFlags,
} from './constants';
```
  </action>
  <verify>
Create test file `temp-config-types.ts`:
```typescript
import type {
  AppConfig,
  DashboardPreferences,
  DashboardCardId,
  FeatureFlags
} from '@/types/config';

const config: AppConfig = {
  env: 'development',
  apiBaseUrl: 'http://localhost:3000',
  firebase: { databaseUrl: '', projectId: '' },
  auth: { domain: '', clientId: '' },
};

const cardId: DashboardCardId = 'stove';

const prefs: DashboardPreferences = {
  cards: [{ id: 'stove', title: 'Stufa', enabled: true, order: 0 }],
};

export { config, cardId, prefs };
```
Run `npx tsc --noEmit temp-config-types.ts` - should pass.
Delete temp file after verification.
  </verify>
  <done>Configuration types created covering app config, dashboard, and feature flags (TYPE-04)</done>
</task>

<task type="auto">
  <name>Task 3: Update root barrel export with all types</name>
  <files>types/index.ts</files>
  <action>
Update types/index.ts to include the new component and config exports.

**types/index.ts (updated):**
```typescript
/**
 * Pannello Stufa - Shared Type Definitions
 *
 * Usage:
 *   import type { StoveState, ApiResponse, ButtonBaseProps } from '@/types';
 *   import { isApiSuccess } from '@/types';
 *
 * Or import from specific subdirectories:
 *   import type { StoveState } from '@/types/firebase';
 *   import type { ApiResponse } from '@/types/api';
 *   import type { ButtonBaseProps } from '@/types/components';
 *   import type { AppConfig } from '@/types/config';
 */

// Firebase data structure types
export * from './firebase';

// API response/error types
export * from './api';

// Component prop types
export * from './components';

// Configuration types
export * from './config';
```
  </action>
  <verify>
Create test file `temp-all-types.ts`:
```typescript
// Test importing from all modules via root barrel
import type {
  // Firebase types
  StoveState,
  NotificationPreferences,
  Device,
  // API types
  ApiResponse,
  ErrorCode,
  // Component types
  ButtonBaseProps,
  Size,
  ColorScheme,
  // Config types
  AppConfig,
  DashboardPreferences,
} from '@/types';

import { isApiSuccess, isApiError } from '@/types';

// Verify types work
const stove: StoveState = { status: 'off', power: 1, targetTemperature: 20, lastUpdatedAt: '' };
const size: Size = 'md';
const code: ErrorCode = 'NOT_FOUND';

export { stove, size, code, isApiSuccess, isApiError };
```
Run `npx tsc --noEmit temp-all-types.ts` - should pass.
Delete temp file after verification.
  </verify>
  <done>Root barrel export updated to include all type subdirectories</done>
</task>

</tasks>

<verification>
After all tasks complete:

1. Directory structure complete:
   ```bash
   find types -name "*.ts" | sort
   ```
   Should show:
   - types/index.ts
   - types/api/errors.ts
   - types/api/index.ts
   - types/api/responses.ts
   - types/components/common.ts
   - types/components/index.ts
   - types/config/constants.ts
   - types/config/index.ts
   - types/firebase/devices.ts
   - types/firebase/index.ts
   - types/firebase/maintenance.ts
   - types/firebase/notifications.ts
   - types/firebase/stove.ts

2. Full type check:
   ```bash
   npx tsc --noEmit
   ```
   Should pass with no errors.

3. All phase success criteria from ROADMAP.md:
   - "Developer can create .ts files and import them from .js files without errors" (verified in Plan 01)
   - "Developer can use @/lib, @/components path aliases in TypeScript files" (verified in Plan 01)
   - "ESLint reports TypeScript-specific errors" (verified in Plan 01)
   - "types/ directory contains shared types for Firebase, API, components, and config" (verified now)
   - "`tsc --noEmit` passes on newly created TypeScript files" (verified now)
</verification>

<success_criteria>
1. types/components/ directory contains common.ts, index.ts with component prop types
2. types/config/ directory contains constants.ts, index.ts with configuration types
3. types/index.ts re-exports from all four subdirectories
4. All type files compile without errors
5. Types can be imported from @/types (root) or specific subdirectories
6. TYPE-03 and TYPE-04 requirements satisfied
7. All 8 Phase 37 requirements (SETUP-01 through TYPE-04) satisfied
</success_criteria>

<output>
After completion, create `.planning/phases/37-typescript-foundation/37-03-SUMMARY.md`
</output>
