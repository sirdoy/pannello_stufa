---
phase: 39-ui-components-migration
plan: 06
type: execute
wave: 4
depends_on: ["39-05"]
files_modified:
  - app/components/AppleSplashScreens.js
  - app/components/AxeDevtools.js
  - app/components/ClientProviders.js
  - app/components/CronHealthBanner.js
  - app/components/ForceUpdateModal.js
  - app/components/LocationSearch.js
  - app/components/MaintenanceBar.js
  - app/components/Navbar.js
  - app/components/NotificationPermissionButton.js
  - app/components/NotificationPreferencesPanel.js
  - app/components/PWAInitializer.js
  - app/components/SettingsLayout.js
  - app/components/StovePanel.js
  - app/components/ThemeScript.js
  - app/components/TransitionLink.js
  - app/components/VersionEnforcer.js
  - app/components/VersionNotifier.js
  - app/components/WhatsNewModal.js
autonomous: true

must_haves:
  truths:
    - "All 18 root-level application components have .tsx extension"
    - "Every component exports a Props interface or type (where props exist)"
    - "tsc --noEmit passes with zero errors"
  artifacts:
    - path: "app/components/Navbar.tsx"
      provides: "Main navigation component typed"
    - path: "app/components/StovePanel.tsx"
      provides: "Stove control panel typed"
    - path: "app/components/ClientProviders.tsx"
      provides: "Provider wrapper component typed"
    - path: "app/components/NotificationPreferencesPanel.tsx"
      provides: "Notification prefs panel typed"
    - path: "app/components/LocationSearch.tsx"
      provides: "Location search component typed"
  key_links:
    - from: "app/components/Navbar.tsx"
      to: "app/components/ui/index.ts"
      via: "import { Button, Tabs, ... } from '@/app/components/ui'"
      pattern: "from.*@/app/components/ui"
    - from: "app/components/StovePanel.tsx"
      to: "lib/ typed services"
      via: "import from @/lib/"
      pattern: "from.*@/lib/"
---

<objective>
Migrate 18 root-level application components from .js to .tsx with typed props.

Purpose: These are the top-level application components (Navbar, StovePanel, ClientProviders, etc.) that compose the design system. Now that the design system is fully typed (Plans 01-05), these components can benefit from typed imports and catch prop errors at compile time.

Output: 18 .tsx files with exported Props interfaces where applicable. Components without props (e.g., self-contained providers) get typed internal state and hooks.
</objective>

<execution_context>
@/Users/federicomanfredi/.claude/get-shit-done/workflows/execute-plan.md
@/Users/federicomanfredi/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/39-ui-components-migration/39-CONTEXT.md
@.planning/phases/39-ui-components-migration/39-RESEARCH.md
@types/components/common.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate infrastructure and provider components (9 files)</name>
  <files>
    app/components/AppleSplashScreens.js -> AppleSplashScreens.tsx
    app/components/AxeDevtools.js -> AxeDevtools.tsx
    app/components/ClientProviders.js -> ClientProviders.tsx
    app/components/PWAInitializer.js -> PWAInitializer.tsx
    app/components/ThemeScript.js -> ThemeScript.tsx
    app/components/TransitionLink.js -> TransitionLink.tsx
    app/components/VersionEnforcer.js -> VersionEnforcer.tsx
    app/components/VersionNotifier.js -> VersionNotifier.tsx
    app/components/SettingsLayout.js -> SettingsLayout.tsx
  </files>
  <action>
For each file:
1. `git mv ComponentName.js ComponentName.tsx` to preserve git history
2. Add Props interface where the component accepts props
3. Type internal state (useState, useRef) with explicit generics
4. Type event handlers and callbacks
5. Use `import type` for type-only imports
6. Preserve existing component API exactly

Specific notes:
- **ClientProviders**: Wraps app with providers — type children as ReactNode. Type any context values provided.
- **PWAInitializer**: May use service worker types — use existing lib/pwa/ types from Phase 38
- **ThemeScript**: Server component injecting script — minimal props
- **TransitionLink**: Wraps Next.js Link — extend `LinkProps` from 'next/link' + custom props
- **VersionEnforcer/VersionNotifier**: App version checking — type version comparison logic
- **SettingsLayout**: Layout wrapper — type children, activeTab, maybe navigation props
- **AppleSplashScreens**: PWA splash screen meta tags — minimal or no props
- **AxeDevtools**: Dev-only accessibility tool — minimal props

Components without external props still need typed internal state (useState<Type>, useRef<Type>).

Run `npx tsc --noEmit` after completing all 9 to verify zero errors.
  </action>
  <verify>Run `npx tsc --noEmit 2>&1 | grep -c "error TS"` — must be 0. Check files: `ls app/components/{AppleSplashScreens,AxeDevtools,ClientProviders,PWAInitializer,ThemeScript,TransitionLink,VersionEnforcer,VersionNotifier,SettingsLayout}.tsx`</verify>
  <done>9 infrastructure/provider components converted to .tsx, zero tsc errors</done>
</task>

<task type="auto">
  <name>Task 2: Migrate feature panel and UI components (9 files)</name>
  <files>
    app/components/CronHealthBanner.js -> CronHealthBanner.tsx
    app/components/ForceUpdateModal.js -> ForceUpdateModal.tsx
    app/components/LocationSearch.js -> LocationSearch.tsx
    app/components/MaintenanceBar.js -> MaintenanceBar.tsx
    app/components/Navbar.js -> Navbar.tsx
    app/components/NotificationPermissionButton.js -> NotificationPermissionButton.tsx
    app/components/NotificationPreferencesPanel.js -> NotificationPreferencesPanel.tsx
    app/components/StovePanel.js -> StovePanel.tsx
    app/components/WhatsNewModal.js -> WhatsNewModal.tsx
  </files>
  <action>
For each file:
1. `git mv ComponentName.js ComponentName.tsx` to preserve git history
2. Add Props interface where the component accepts props
3. Type internal state, event handlers, API calls
4. Use typed imports from `@/app/components/ui` (now .tsx)
5. Use typed imports from `@/lib/` (migrated in Phase 38)
6. Use `import type` for type-only imports
7. Preserve existing component API exactly

Specific notes:
- **Navbar** (687 lines): Large component — type navigation items, active route detection, mobile menu state. Uses many design system components. Type internal state carefully.
- **StovePanel** (599 lines): Large component — type stove state, temperature, power level, status. Uses typed services from lib/.
- **NotificationPreferencesPanel** (323 lines): Type preference options, toggle handlers, save/load state.
- **LocationSearch** (302 lines): Type search state, results, selection handler, geocoding response.
- **NotificationPermissionButton** (219 lines): Type permission state (granted/denied/default), request handler.
- **ForceUpdateModal**: Type onUpdate, currentVersion, latestVersion props.
- **WhatsNewModal**: Type changelog entries, version display.
- **CronHealthBanner**: Type health status, last check time.
- **MaintenanceBar**: Type maintenance state, cleaning needed flags.

For large components (Navbar, StovePanel): Focus on typing the component's external API (props) and critical internal state. For deeply nested internal logic, be pragmatic — allow selective `any` where full typing would be overly complex (per user's pragmatic decision).

Run `npx tsc --noEmit` after completing all 9 to verify zero errors.
  </action>
  <verify>Run `npx tsc --noEmit 2>&1 | grep -c "error TS"` — must be 0. Check files: `ls app/components/{CronHealthBanner,ForceUpdateModal,LocationSearch,MaintenanceBar,Navbar,NotificationPermissionButton,NotificationPreferencesPanel,StovePanel,WhatsNewModal}.tsx`</verify>
  <done>9 feature panel/UI components converted to .tsx, zero tsc errors across entire project</done>
</task>

</tasks>

<verification>
After both tasks:
1. `find app/components -maxdepth 1 -name "*.js" -o -name "*.jsx" | wc -l` = 0
2. `find app/components -maxdepth 1 -name "*.tsx" | wc -l` = 18
3. `npx tsc --noEmit 2>&1 | grep -c "error TS"` = 0
</verification>

<success_criteria>
- All 18 root-level application components have .tsx extension
- Props interfaces exported where components accept external props
- Internal state typed (useState, useRef generics)
- Typed imports from design system and lib/ used
- Large components (Navbar, StovePanel) have pragmatic typing
- Zero tsc errors
</success_criteria>

<output>
After completion, create `.planning/phases/39-ui-components-migration/39-06-SUMMARY.md`
</output>
