---
phase: 41-pages-migration
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - app/layout.tsx
  - app/template.tsx
  - app/not-found.tsx
  - app/context/ThemeContext.tsx
  - app/context/VersionContext.tsx
  - app/context/PageTransitionContext.tsx
  - app/page.tsx
  - app/offline/page.tsx
  - app/changelog/page.tsx
  - app/log/page.tsx
  - app/monitoring/page.tsx
autonomous: true

must_haves:
  truths:
    - "Root layout, template, and not-found are TypeScript files"
    - "All 3 context providers have typed context values and null + type guard pattern"
    - "Home, offline, changelog, log, monitoring pages are .tsx with proper typing"
    - "No .js files remain for root files, context providers, or these pages"
  artifacts:
    - path: "app/layout.tsx"
      provides: "Root layout with Metadata type and children: React.ReactNode"
      contains: "Metadata"
    - path: "app/context/ThemeContext.tsx"
      provides: "ThemeContext with typed value interface and useTheme hook"
      contains: "ThemeContextValue"
    - path: "app/context/VersionContext.tsx"
      provides: "VersionContext with typed value interface and useVersion hook"
      contains: "VersionContextValue"
    - path: "app/context/PageTransitionContext.tsx"
      provides: "PageTransitionContext with typed value interface"
      contains: "PageTransitionContextValue"
  key_links:
    - from: "app/layout.tsx"
      to: "app/context/ThemeContext.tsx"
      via: "imports ThemeProvider"
      pattern: "import.*ThemeProvider"
    - from: "app/context/ThemeContext.tsx"
      to: "ThemeContextValue"
      via: "createContext<ThemeContextValue | null>(null)"
      pattern: "createContext<.*\\| null>"
---

<objective>
Migrate root files (layout, template, not-found), all 3 context providers, and 5 simple standalone pages to TypeScript.

Purpose: Establish the TypeScript foundation for app/ — root layout and context providers are imported everywhere, so migrating them first prevents cascading import issues.
Output: 11 TypeScript files with proper typing, preserving git history via git mv.
</objective>

<execution_context>
@/Users/federicomanfredi/.claude/get-shit-done/workflows/execute-plan.md
@/Users/federicomanfredi/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/41-pages-migration/41-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate root files and context providers (6 files)</name>
  <files>
    app/layout.tsx
    app/template.tsx
    app/not-found.tsx
    app/context/ThemeContext.tsx
    app/context/VersionContext.tsx
    app/context/PageTransitionContext.tsx
  </files>
  <action>
    Use `git mv` for each file (.js -> .tsx) to preserve git history, then add TypeScript typing.

    **Root layout (app/layout.js -> layout.tsx):**
    - Add `import type { Metadata } from 'next'`
    - Type metadata export: `export const metadata: Metadata = { ... }`
    - Type layout function: `{ children }: { children: React.ReactNode }`
    - Keep all existing imports and logic unchanged

    **Template (app/template.js -> template.tsx):**
    - Type: `{ children }: { children: React.ReactNode }`
    - This is a client component ('use client') — type any state/effects

    **Not-found (app/not-found.js -> not-found.tsx):**
    - Simple component, likely no props. Just rename and ensure JSX return type.

    **Context providers (3 files in app/context/):**
    - For each: git mv .js -> .tsx
    - Define interface for context value (e.g., ThemeContextValue, VersionContextValue, PageTransitionContextValue)
    - Use `createContext<ValueType | null>(null)` pattern (null default + type guard)
    - Type provider props: `{ children }: { children: ReactNode }`
    - Type custom hook return: `export function useTheme(): ThemeContextValue`
    - Add runtime null check in hook: `if (!context) throw new Error('...')`
    - Type all state variables with explicit types (e.g., `useState<'light' | 'dark'>('light')`)
    - Type all callback functions with explicit parameter and return types
    - Pure migration: do NOT change any behavior or logic

    **Anti-patterns to avoid:**
    - Do NOT use React.FC for any component
    - Do NOT change context logic or behavior
    - Do NOT use 'any' unless absolutely necessary (these files are simple)
  </action>
  <verify>
    Run: `ls app/layout.tsx app/template.tsx app/not-found.tsx app/context/ThemeContext.tsx app/context/VersionContext.tsx app/context/PageTransitionContext.tsx`
    Confirm: All 6 files exist as .tsx
    Run: `ls app/layout.js app/template.js app/not-found.js app/context/ThemeContext.js app/context/VersionContext.js app/context/PageTransitionContext.js 2>/dev/null`
    Confirm: No .js originals remain
  </verify>
  <done>6 root/context files are .tsx with proper TypeScript typing. Context providers use null + type guard pattern with typed value interfaces.</done>
</task>

<task type="auto">
  <name>Task 2: Migrate 5 simple standalone pages (5 files)</name>
  <files>
    app/page.tsx
    app/offline/page.tsx
    app/changelog/page.tsx
    app/log/page.tsx
    app/monitoring/page.tsx
  </files>
  <action>
    Use `git mv` for each file (.js -> .tsx), then add TypeScript typing.

    **For each page:**
    - git mv page.js -> page.tsx
    - These are all client components ('use client') — they use hooks, NOT async props
    - Type all useState with explicit type parameters where non-obvious
    - Type all callback functions (onClick, onChange, etc.)
    - Type any fetched data with inline interfaces or imported types
    - Add `import type { Metadata } from 'next'` if page exports metadata
    - Use domain-specific callback types (not generic React events) where the component passes values

    **Specific notes:**
    - app/page.js (85 lines): Home page, likely imports dashboard components
    - app/offline/page.js (341 lines): Offline fallback page with service worker logic
    - app/changelog/page.js (334 lines): Changelog display page
    - app/log/page.js (281 lines): Log viewer page
    - app/monitoring/page.js (129 lines): Monitoring dashboard page

    **Anti-patterns to avoid:**
    - Do NOT add params/searchParams props to client pages (they use hooks)
    - Do NOT use React.FC
    - Aim for minimal 'any' usage — pages are simpler than API routes
  </action>
  <verify>
    Run: `ls app/page.tsx app/offline/page.tsx app/changelog/page.tsx app/log/page.tsx app/monitoring/page.tsx`
    Confirm: All 5 files exist as .tsx
    Run: `find app/page.js app/offline/page.js app/changelog/page.js app/log/page.js app/monitoring/page.js 2>/dev/null`
    Confirm: No .js originals remain
  </verify>
  <done>5 standalone pages are .tsx with proper TypeScript typing. All use hooks for state (not async props). No .js originals remain.</done>
</task>

</tasks>

<verification>
- `ls app/layout.tsx app/template.tsx app/not-found.tsx` — all exist
- `ls app/context/*.tsx` — 3 context providers exist as .tsx
- `ls app/page.tsx app/offline/page.tsx app/changelog/page.tsx app/log/page.tsx app/monitoring/page.tsx` — all exist
- `find app/layout.js app/template.js app/not-found.js app/context/*.js app/page.js app/offline/page.js app/changelog/page.js app/log/page.js app/monitoring/page.js 2>/dev/null` — returns empty
- Total: 11 files migrated
</verification>

<success_criteria>
- 11 files migrated from .js to .tsx with git mv
- Root layout has Metadata type import and typed children prop
- All 3 context providers have typed value interfaces and null + type guard hooks
- 5 standalone pages have typed state and callbacks
- No .js originals remain for any of these files
</success_criteria>

<output>
After completion, create `.planning/phases/41-pages-migration/41-01-SUMMARY.md`
</output>
