---
phase: 41-pages-migration
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - app/thermostat/page.tsx
  - app/thermostat/authorized/page.tsx
  - app/thermostat/schedule/page.tsx
  - app/thermostat/components/ThermostatTabs.tsx
  - app/thermostat/schedule/components/ActiveOverrideBadge.tsx
  - app/thermostat/schedule/components/DurationPicker.tsx
  - app/thermostat/schedule/components/ManualOverrideSheet.tsx
  - app/thermostat/schedule/components/ScheduleSelector.tsx
  - app/thermostat/schedule/components/TemperaturePicker.tsx
  - app/thermostat/schedule/components/TimelineSlot.tsx
  - app/thermostat/schedule/components/WeeklyTimeline.tsx
autonomous: true

must_haves:
  truths:
    - "Thermostat pages and schedule components are TypeScript files"
    - "Co-located schedule components have typed props with domain-specific callbacks"
    - "ThermostatTabs component has typed tab definitions"
    - "No .js files remain in thermostat directory (excluding page.test.js deferred to Phase 42)"
  artifacts:
    - path: "app/thermostat/page.tsx"
      provides: "Main thermostat page with typed state and effects"
      min_lines: 500
    - path: "app/thermostat/schedule/components/TemperaturePicker.tsx"
      provides: "Temperature picker with TemperaturePickerProps interface"
      contains: "TemperaturePickerProps"
    - path: "app/thermostat/schedule/components/WeeklyTimeline.tsx"
      provides: "Weekly timeline with typed schedule data"
      contains: "interface"
    - path: "app/thermostat/schedule/components/ManualOverrideSheet.tsx"
      provides: "Override sheet with typed callbacks"
      contains: "interface"
  key_links:
    - from: "app/thermostat/schedule/page.tsx"
      to: "app/thermostat/schedule/components/"
      via: "imports schedule components"
      pattern: "import.*from.*[./]components/"
    - from: "app/thermostat/schedule/components/TemperaturePicker.tsx"
      to: "onChange callback"
      via: "domain-specific number callback"
      pattern: "onChange.*number"
---

<objective>
Migrate thermostat pages (3) and all co-located thermostat components (8) to TypeScript.

Purpose: Complete vertical slice for thermostat feature — pages and their co-located schedule components migrated together.
Output: 11 TypeScript files with typed props, domain-specific callbacks, and schedule data typing.
</objective>

<execution_context>
@/Users/federicomanfredi/.claude/get-shit-done/workflows/execute-plan.md
@/Users/federicomanfredi/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/41-pages-migration/41-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate thermostat pages and ThermostatTabs (4 files)</name>
  <files>
    app/thermostat/page.tsx
    app/thermostat/authorized/page.tsx
    app/thermostat/schedule/page.tsx
    app/thermostat/components/ThermostatTabs.tsx
  </files>
  <action>
    Use `git mv` for each file (.js -> .tsx), then add TypeScript typing.

    **thermostat/page.js (548 lines):**
    - Client component ('use client') — uses hooks, NOT async props
    - Type all useState with explicit types
    - Type fetched Netatmo data with inline interfaces or imported types from @/types
    - Type callback functions with domain-specific signatures
    - Use pragmatic typing where data structures are complex (Netatmo API responses)

    **thermostat/authorized/page.js (43 lines):**
    - OAuth callback page — simple redirect logic
    - Type any URL parameters accessed via hooks

    **thermostat/schedule/page.js (163 lines):**
    - Client component with schedule management state
    - Type schedule data structures (use ScheduleInterval from @/lib/schedulerService if available)
    - Type override state and callbacks

    **thermostat/components/ThermostatTabs.js (76 lines):**
    - Tab definitions component
    - Type tab items interface (label, value, content)
    - Type any props received from parent

    **Anti-patterns to avoid:**
    - Do NOT add params/searchParams props to client pages
    - Do NOT over-type Netatmo API responses — pragmatic typing OK for complex nested data
    - Do NOT use generic React event types where domain callbacks are used
  </action>
  <verify>
    Run: `ls app/thermostat/page.tsx app/thermostat/authorized/page.tsx app/thermostat/schedule/page.tsx app/thermostat/components/ThermostatTabs.tsx`
    Confirm: All 4 files exist as .tsx
    Run: `find app/thermostat -name "*.js" -not -name "page.test.js" 2>/dev/null`
    Confirm: No .js files remain (page.test.js excluded — Phase 42)
  </verify>
  <done>4 thermostat page/component files are .tsx with proper typing. Netatmo data typed pragmatically.</done>
</task>

<task type="auto">
  <name>Task 2: Migrate 7 thermostat schedule components</name>
  <files>
    app/thermostat/schedule/components/ActiveOverrideBadge.tsx
    app/thermostat/schedule/components/DurationPicker.tsx
    app/thermostat/schedule/components/ManualOverrideSheet.tsx
    app/thermostat/schedule/components/ScheduleSelector.tsx
    app/thermostat/schedule/components/TemperaturePicker.tsx
    app/thermostat/schedule/components/TimelineSlot.tsx
    app/thermostat/schedule/components/WeeklyTimeline.tsx
  </files>
  <action>
    Use `git mv` for each file (.js -> .tsx), then add TypeScript typing.

    **For all 7 co-located schedule components:**
    - git mv .js -> .tsx
    - Define Props interface for each component (e.g., TemperaturePickerProps, DurationPickerProps)
    - Use domain-specific callback types:
      - TemperaturePicker: `onChange: (newValue: number) => void`
      - DurationPicker: `onChange: (minutes: number) => void`
      - ScheduleSelector: `onSelect: (scheduleId: string) => void`
      - ManualOverrideSheet: `onConfirm: (temp: number, duration: number) => void`
    - Type schedule data using ScheduleInterval type from @/lib/schedulerService if available
    - Type any internal state (useState) with explicit types

    **Specific file notes:**
    - ActiveOverrideBadge.js (128 lines): Badge showing active override info — type override data
    - DurationPicker.js (81 lines): Duration selector — type min/max/step/value/onChange
    - ManualOverrideSheet.js (178 lines): Bottom sheet for manual override — type onConfirm callback
    - ScheduleSelector.js (111 lines): Schedule dropdown — type schedule list and selection
    - TemperaturePicker.js (86 lines): Temperature stepper — type value/onChange/min/max/step
    - TimelineSlot.js (55 lines): Single timeline slot — type slot data (time, temp, active)
    - WeeklyTimeline.js (172 lines): Full week view — type day/slot data arrays

    **Anti-patterns to avoid:**
    - Do NOT use `onChange: (e: React.ChangeEvent) => void` when the component passes domain values
    - Do NOT leave props untyped — each component must have a Props interface
    - Do NOT change any component behavior
  </action>
  <verify>
    Run: `ls app/thermostat/schedule/components/*.tsx`
    Confirm: All 7 files exist as .tsx
    Run: `ls app/thermostat/schedule/components/*.js 2>/dev/null`
    Confirm: No .js originals remain
    Run: `grep -l "interface.*Props" app/thermostat/schedule/components/*.tsx | wc -l`
    Confirm: All 7 have Props interfaces
  </verify>
  <done>7 schedule components are .tsx with Props interfaces and domain-specific callbacks. No .js files remain in thermostat/schedule/components/.</done>
</task>

</tasks>

<verification>
- `find app/thermostat -name "*.js" -not -name "page.test.js" 2>/dev/null` — returns empty
- `ls app/thermostat/page.tsx app/thermostat/schedule/page.tsx app/thermostat/schedule/components/*.tsx` — all exist
- `grep -l "interface" app/thermostat/schedule/components/*.tsx | wc -l` — shows 7
- Total: 11 files migrated
</verification>

<success_criteria>
- 11 files migrated from .js to .tsx with git mv
- All schedule components have typed Props interfaces with domain-specific callbacks
- Thermostat pages have typed state and effects
- No .js files remain in thermostat/ (except page.test.js deferred to Phase 42)
</success_criteria>

<output>
After completion, create `.planning/phases/41-pages-migration/41-02-SUMMARY.md`
</output>
