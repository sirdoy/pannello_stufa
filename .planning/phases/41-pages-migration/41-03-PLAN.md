---
phase: 41-pages-migration
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - app/stove/page.tsx
  - app/stove/errors/page.tsx
  - app/stove/maintenance/page.tsx
  - app/stove/scheduler/page.tsx
  - app/lights/page.tsx
  - app/lights/authorized/page.tsx
  - app/lights/automation/page.tsx
  - app/lights/scenes/page.tsx
  - app/netatmo/page.tsx
  - app/netatmo/authorized/page.tsx
  - app/(pages)/camera/page.tsx
  - app/(pages)/camera/CameraDashboard.tsx
  - app/(pages)/camera/events/page.tsx
  - app/(pages)/camera/events/CameraEventsPage.tsx
autonomous: true

must_haves:
  truths:
    - "All stove pages (4) are TypeScript with typed state and callbacks"
    - "All lights pages (4) are TypeScript with typed Hue API data"
    - "Both netatmo pages are TypeScript"
    - "Camera pages and co-located components are TypeScript with typed camera data"
    - "No .js files remain in stove/, lights/, netatmo/, (pages)/camera/"
  artifacts:
    - path: "app/stove/page.tsx"
      provides: "Main stove control page with typed stove state"
      min_lines: 1000
    - path: "app/lights/page.tsx"
      provides: "Main lights control page with typed Hue data"
      min_lines: 1100
    - path: "app/stove/scheduler/page.tsx"
      provides: "Stove scheduler page with typed schedule data"
      min_lines: 800
    - path: "app/(pages)/camera/CameraDashboard.tsx"
      provides: "Camera dashboard with typed camera/event data"
      min_lines: 400
  key_links:
    - from: "app/(pages)/camera/page.tsx"
      to: "app/(pages)/camera/CameraDashboard.tsx"
      via: "imports CameraDashboard component"
      pattern: "import.*CameraDashboard"
    - from: "app/(pages)/camera/events/page.tsx"
      to: "app/(pages)/camera/events/CameraEventsPage.tsx"
      via: "imports CameraEventsPage component"
      pattern: "import.*CameraEventsPage"
---

<objective>
Migrate all stove (4), lights (4), netatmo (2), and camera (4) pages and co-located components to TypeScript.

Purpose: Complete vertical slices for all device-control pages — stove, lights, netatmo, and camera features fully migrated.
Output: 14 TypeScript files covering all device-control pages with typed state, API data, and callbacks.
</objective>

<execution_context>
@/Users/federicomanfredi/.claude/get-shit-done/workflows/execute-plan.md
@/Users/federicomanfredi/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/41-pages-migration/41-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate stove pages (4 files, ~2,426 lines)</name>
  <files>
    app/stove/page.tsx
    app/stove/errors/page.tsx
    app/stove/maintenance/page.tsx
    app/stove/scheduler/page.tsx
  </files>
  <action>
    Use `git mv` for each file (.js -> .tsx), then add TypeScript typing.

    **stove/page.js (1052 lines):**
    - Client component ('use client') — uses hooks
    - Large file: type the "edges" (props, state, handlers) — pragmatic typing for complex internals
    - Type stove state (temperature, status, power level, etc.) with inline interface or imported StoveStatus
    - Type all useState with explicit types
    - Type fetch response data structures
    - Use pragmatic 'any' for deeply nested Thermorossi API responses if needed

    **stove/errors/page.js (235 lines):**
    - Error display page — type error data interface
    - Type error list items with inline interface

    **stove/maintenance/page.js (264 lines):**
    - Maintenance tracking page — type maintenance data (hours, dates)
    - Type form state and submission callbacks

    **stove/scheduler/page.js (875 lines):**
    - Large scheduler page — type schedule intervals, modes
    - Import ScheduleInterval type from @/lib/schedulerService if available
    - Type scheduler mode: 'manual' | 'automatic' | 'semi-manual'
    - Pragmatic typing for complex schedule manipulation logic

    **Anti-patterns to avoid:**
    - Do NOT try to fully type every internal variable in 1000+ line files
    - Do NOT add async params/searchParams (these are client components)
    - Pragmatic approach: type boundaries (state, props, callbacks), allow flexibility inside
  </action>
  <verify>
    Run: `ls app/stove/page.tsx app/stove/errors/page.tsx app/stove/maintenance/page.tsx app/stove/scheduler/page.tsx`
    Confirm: All 4 files exist as .tsx
    Run: `find app/stove -name "*.js" 2>/dev/null`
    Confirm: No .js files remain
  </verify>
  <done>4 stove pages are .tsx with typed state and callbacks. Large files use pragmatic edge-typing approach.</done>
</task>

<task type="auto">
  <name>Task 2: Migrate lights and netatmo pages (6 files, ~2,104 lines)</name>
  <files>
    app/lights/page.tsx
    app/lights/authorized/page.tsx
    app/lights/automation/page.tsx
    app/lights/scenes/page.tsx
    app/netatmo/page.tsx
    app/netatmo/authorized/page.tsx
  </files>
  <action>
    Use `git mv` for each file (.js -> .tsx), then add TypeScript typing.

    **lights/page.js (1183 lines):**
    - Large client component — Hue light control page
    - Type light state (on/off, brightness, color) with inline interfaces
    - Type Hue API response data pragmatically (use 'any' for complex Hue v2 API structures per Phase 40 pattern)
    - Type callback handlers: toggle, brightness change, color change
    - Edge-typing approach: type state declarations, handler signatures, render props

    **lights/authorized/page.js (43 lines):**
    - OAuth callback page — simple redirect
    - Type URL parameters accessed via hooks

    **lights/automation/page.js (151 lines):**
    - Automation rules page — type rule data structures
    - Type form state for rule creation

    **lights/scenes/page.js (508 lines):**
    - Scene management page — type scene data (name, lights, states)
    - Type scene activation callbacks

    **netatmo/page.js (176 lines):**
    - Netatmo dashboard — type thermostat data
    - Pragmatic typing for Netatmo API data

    **netatmo/authorized/page.js (43 lines):**
    - OAuth callback page — simple redirect

    **Anti-patterns to avoid:**
    - Do NOT fully type Hue v2 API response objects (pragmatic 'any' per Phase 40 pattern)
    - Do NOT add async props to client pages
  </action>
  <verify>
    Run: `ls app/lights/page.tsx app/lights/authorized/page.tsx app/lights/automation/page.tsx app/lights/scenes/page.tsx app/netatmo/page.tsx app/netatmo/authorized/page.tsx`
    Confirm: All 6 files exist as .tsx
    Run: `find app/lights -name "*.js" 2>/dev/null && find app/netatmo -name "*.js" 2>/dev/null`
    Confirm: No .js files remain in lights/ or netatmo/
  </verify>
  <done>6 lights/netatmo pages are .tsx with typed state and pragmatic API data typing.</done>
</task>

<task type="auto">
  <name>Task 3: Migrate camera pages and co-located components (4 files, ~878 lines)</name>
  <files>
    app/(pages)/camera/page.tsx
    app/(pages)/camera/CameraDashboard.tsx
    app/(pages)/camera/events/page.tsx
    app/(pages)/camera/events/CameraEventsPage.tsx
  </files>
  <action>
    Use `git mv` for each file (.js -> .tsx), then add TypeScript typing.

    **camera/page.js (20 lines):**
    - Thin wrapper importing CameraDashboard
    - Simple migration — just rename and ensure import works

    **camera/CameraDashboard.js (457 lines):**
    - Main camera dashboard component
    - Define CameraDashboardProps interface (if it receives props)
    - Type camera data: name, status, snapshot URL, events
    - Type event handlers for camera controls
    - Pragmatic typing for Netatmo camera API data

    **camera/events/page.js (20 lines):**
    - Thin wrapper importing CameraEventsPage
    - Simple migration

    **camera/events/CameraEventsPage.js (381 lines):**
    - Camera events list component
    - Type event data interface (type, timestamp, camera, thumbnail)
    - Type pagination state
    - Type filter state and callbacks

    **Anti-patterns to avoid:**
    - Do NOT over-type Netatmo camera API responses (pragmatic 'any' acceptable)
  </action>
  <verify>
    Run: `ls "app/(pages)/camera/page.tsx" "app/(pages)/camera/CameraDashboard.tsx" "app/(pages)/camera/events/page.tsx" "app/(pages)/camera/events/CameraEventsPage.tsx"`
    Confirm: All 4 files exist as .tsx
    Run: `find "app/(pages)/camera" -name "*.js" 2>/dev/null`
    Confirm: No .js files remain in camera/
  </verify>
  <done>4 camera files are .tsx with typed camera/event data. No .js files remain in (pages)/camera/.</done>
</task>

</tasks>

<verification>
- `find app/stove app/lights app/netatmo "app/(pages)/camera" -name "*.js" 2>/dev/null` — returns empty
- All 14 files exist as .tsx
- Large files (stove/page, lights/page, stove/scheduler) use pragmatic edge-typing
- Camera co-located components have typed props interfaces
- Total: 14 files migrated
</verification>

<success_criteria>
- 14 files migrated from .js to .tsx with git mv
- All device-control pages have typed state and callbacks
- Large files (1000+ lines) use edge-typing approach with pragmatic 'any' for complex API data
- Camera co-located components have Props interfaces
- No .js files remain in stove/, lights/, netatmo/, (pages)/camera/
</success_criteria>

<output>
After completion, create `.planning/phases/41-pages-migration/41-03-SUMMARY.md`
</output>
