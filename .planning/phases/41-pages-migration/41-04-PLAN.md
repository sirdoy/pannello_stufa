---
phase: 41-pages-migration
plan: 04
type: execute
wave: 1
depends_on: []
files_modified:
  - app/settings/page.tsx
  - app/settings/dashboard/page.tsx
  - app/settings/devices/page.tsx
  - app/settings/location/page.tsx
  - app/settings/theme/page.tsx
  - app/settings/thermostat/page.tsx
  - app/settings/notifications/page.tsx
  - app/settings/notifications/devices/page.tsx
  - app/settings/notifications/history/page.tsx
  - app/settings/notifications/NotificationSettingsForm.tsx
autonomous: true

must_haves:
  truths:
    - "All settings pages (9) are TypeScript with typed state and form data"
    - "NotificationSettingsForm has typed form props and validation"
    - "No .js files remain in settings/ directory"
  artifacts:
    - path: "app/settings/page.tsx"
      provides: "Main settings page with typed tab/section state"
      min_lines: 650
    - path: "app/settings/notifications/page.tsx"
      provides: "Notification settings page with typed preference data"
      min_lines: 600
    - path: "app/settings/notifications/NotificationSettingsForm.tsx"
      provides: "Form component with typed form values and validation"
      contains: "interface"
    - path: "app/settings/dashboard/page.tsx"
      provides: "Dashboard settings with typed card order/visibility"
      min_lines: 200
  key_links:
    - from: "app/settings/notifications/page.tsx"
      to: "app/settings/notifications/NotificationSettingsForm.tsx"
      via: "imports form component"
      pattern: "import.*NotificationSettingsForm"
---

<objective>
Migrate all settings pages (9) and the NotificationSettingsForm co-located component to TypeScript.

Purpose: Complete vertical slice for all settings/configuration pages with typed form state and preferences.
Output: 10 TypeScript files covering all settings functionality with typed forms and preferences.
</objective>

<execution_context>
@/Users/federicomanfredi/.claude/get-shit-done/workflows/execute-plan.md
@/Users/federicomanfredi/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/41-pages-migration/41-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate main settings page and sub-pages (6 files)</name>
  <files>
    app/settings/page.tsx
    app/settings/dashboard/page.tsx
    app/settings/devices/page.tsx
    app/settings/location/page.tsx
    app/settings/theme/page.tsx
    app/settings/thermostat/page.tsx
  </files>
  <action>
    Use `git mv` for each file (.js -> .tsx), then add TypeScript typing.

    **settings/page.js (707 lines):**
    - Client component ('use client') — main settings hub
    - Type settings sections/tabs state
    - Type any navigation or section toggle callbacks
    - Edge-typing approach for this large file: focus on state types, handler signatures

    **settings/dashboard/page.js (227 lines):**
    - Dashboard card order/visibility settings
    - Type card configuration: `{ id: string; label: string; visible: boolean; order: number }`
    - Type reorder/toggle callbacks

    **settings/devices/page.js (261 lines):**
    - Device management page
    - Type device list items (id, name, type, status)
    - Type rename/remove callbacks

    **settings/location/page.js (164 lines):**
    - Location settings with geocoding
    - Type location data: `{ city: string; lat: number; lon: number }`
    - Type autocomplete suggestion interface

    **settings/theme/page.js (223 lines):**
    - Theme preference page
    - Type theme: `'light' | 'dark'`
    - Type theme change handler

    **settings/thermostat/page.js (27 lines):**
    - Simple thermostat settings redirect/wrapper
    - Minimal typing needed

    **Anti-patterns to avoid:**
    - Do NOT add async props to client pages
    - Do NOT use React.FC
  </action>
  <verify>
    Run: `ls app/settings/page.tsx app/settings/dashboard/page.tsx app/settings/devices/page.tsx app/settings/location/page.tsx app/settings/theme/page.tsx app/settings/thermostat/page.tsx`
    Confirm: All 6 files exist as .tsx
    Run: `find app/settings -maxdepth 2 -name "*.js" 2>/dev/null`
    Confirm: No .js files remain at settings root level
  </verify>
  <done>6 settings pages are .tsx with typed state, form data, and callbacks.</done>
</task>

<task type="auto">
  <name>Task 2: Migrate notification settings pages and form (4 files)</name>
  <files>
    app/settings/notifications/page.tsx
    app/settings/notifications/devices/page.tsx
    app/settings/notifications/history/page.tsx
    app/settings/notifications/NotificationSettingsForm.tsx
  </files>
  <action>
    Use `git mv` for each file (.js -> .tsx), then add TypeScript typing.

    **notifications/page.js (676 lines):**
    - Main notification settings page
    - Type notification preference data (type toggles, DND hours, rate limits)
    - Type form submission callbacks
    - May use React Hook Form + Zod — preserve existing validation, type form values

    **notifications/devices/page.js (219 lines):**
    - Notification device management
    - Type device list (token, name, lastUsed, platform)
    - Type remove/rename callbacks

    **notifications/history/page.js (245 lines):**
    - Notification history viewer
    - Type notification items (type, title, body, timestamp, status)
    - Type pagination and filter state

    **notifications/NotificationSettingsForm.js (414 lines):**
    - Reusable form component for notification preferences
    - Define NotificationSettingsFormProps interface
    - Type form field values interface
    - Type onSubmit callback: `(values: FormValues) => Promise<void>`
    - Type validation rules
    - If using React Hook Form: type useForm generic parameter

    **Anti-patterns to avoid:**
    - Do NOT change form validation behavior
    - Do NOT remove Zod schemas — just ensure they type-check
    - Type the form values interface to match existing Zod schema shape
  </action>
  <verify>
    Run: `ls app/settings/notifications/page.tsx app/settings/notifications/devices/page.tsx app/settings/notifications/history/page.tsx app/settings/notifications/NotificationSettingsForm.tsx`
    Confirm: All 4 files exist as .tsx
    Run: `find app/settings -name "*.js" 2>/dev/null`
    Confirm: No .js files remain anywhere in settings/
  </verify>
  <done>4 notification settings files are .tsx. NotificationSettingsForm has typed Props and form values. No .js files remain in settings/.</done>
</task>

</tasks>

<verification>
- `find app/settings -name "*.js" 2>/dev/null` — returns empty
- All 10 files exist as .tsx
- NotificationSettingsForm has Props interface with typed form values
- Settings pages have typed preference data and callbacks
- Total: 10 files migrated
</verification>

<success_criteria>
- 10 files migrated from .js to .tsx with git mv
- All settings pages have typed state and configuration data
- NotificationSettingsForm has typed form values and onSubmit callback
- No .js files remain in settings/ directory tree
</success_criteria>

<output>
After completion, create `.planning/phases/41-pages-migration/41-04-SUMMARY.md`
</output>
