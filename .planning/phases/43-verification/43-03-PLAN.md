---
phase: 43-verification
plan: 03
type: execute
wave: 2
depends_on: ["43-01"]
files_modified:
  - app/components/ui/__tests__/Accordion.test.tsx
  - app/components/ui/__tests__/Tabs.test.tsx
  - app/components/ui/__tests__/DashboardLayout.test.tsx
  - app/components/ui/__tests__/Sheet.test.tsx
  - app/components/ui/__tests__/Select.test.tsx
  - app/components/ui/__tests__/accessibility.test.tsx
  - app/components/ui/__tests__/Popover.test.tsx
  - app/components/ui/__tests__/Modal.test.tsx
autonomous: true

must_haves:
  truths:
    - "All 8 high-error UI component test files compile without tsc errors"
    - "Mock typing uses jest.mocked() pattern, not as any"
    - "All existing tests still pass after type fixes"
  artifacts:
    - path: "app/components/ui/__tests__/Accordion.test.tsx"
      provides: "Accordion tests with proper mock typing"
      min_lines: 50
    - path: "app/components/ui/__tests__/Tabs.test.tsx"
      provides: "Tabs tests with proper mock typing"
      min_lines: 50
  key_links:
    - from: "app/components/ui/__tests__/Accordion.test.tsx"
      to: "__tests__/__utils__/mockHelpers.ts"
      via: "import mock utilities"
      pattern: "import.*mockHelpers|jest\\.mocked"
---

<objective>
Fix mock type errors in the 8 highest-error UI component test files (687 errors total: Accordion 130, Tabs 112, DashboardLayout 98, Sheet 48, Select 32, accessibility 25, Popover 22, Modal 21).

Purpose: These 8 files account for ~46% of all test mock type errors. They share common patterns: Radix UI mocks, component render mocks, and event handler mocks. Fixing them establishes the pattern for remaining files.

Output: 8 UI component test files compile with zero tsc errors while all existing tests continue to pass.
</objective>

<execution_context>
@/Users/federicomanfredi/.claude/get-shit-done/workflows/execute-plan.md
@/Users/federicomanfredi/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/43-verification/43-RESEARCH.md
@.planning/phases/43-verification/43-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix mock types in Accordion, Tabs, DashboardLayout, Sheet tests</name>
  <files>
    app/components/ui/__tests__/Accordion.test.tsx
    app/components/ui/__tests__/Tabs.test.tsx
    app/components/ui/__tests__/DashboardLayout.test.tsx
    app/components/ui/__tests__/Sheet.test.tsx
  </files>
  <action>
Fix all tsc errors in these 4 files (388 total errors). Run `npx tsc --noEmit 2>&1 | grep "error TS" | grep -E "Accordion\.test|Tabs\.test|DashboardLayout\.test|Sheet\.test"` to see exact errors.

**Common pattern for all files — Apply jest.mocked() pattern:**

1. For every `jest.mock('module')` call, find the imported functions/objects from that module and wrap with `jest.mocked()`:
   ```typescript
   import { SomeComponent } from '@/components/ui/SomeComponent';
   jest.mock('@/components/ui/SomeComponent');
   const MockedSomeComponent = jest.mocked(SomeComponent);
   ```

2. For Radix UI mocks (common in Accordion, Tabs, Sheet): These components are often mocked at the module level. The mock return type needs to match what the test expects. Use `jest.mocked()` on the entire import:
   ```typescript
   import * as AccordionPrimitive from '@radix-ui/react-accordion';
   jest.mock('@radix-ui/react-accordion');
   const MockedAccordion = jest.mocked(AccordionPrimitive);
   ```

3. For `mockReturnValue`, `mockImplementation`, etc. on mocked functions — these should be typed automatically after `jest.mocked()`. If there are remaining errors, check if the mock return value matches the function's actual return type.

4. For component render mocks that return JSX — ensure the mock implementation returns `React.ReactElement` or `JSX.Element`.

5. Import and use mock utilities from `__tests__/__utils__/mockHelpers.ts` where they reduce boilerplate (e.g., `createMockResponse` for fetch mocks).

**Specific per file:**
- **Accordion.test.tsx (130 errors):** Likely Radix Accordion primitive mocks. Apply jest.mocked() to all Radix imports.
- **Tabs.test.tsx (112 errors):** Similar Radix pattern. Apply jest.mocked() to Tab primitive imports.
- **DashboardLayout.test.tsx (98 errors):** Component composition mocks. May need typed context providers.
- **Sheet.test.tsx (48 errors):** Radix Dialog/Sheet primitive mocks.

After fixing, run `npm test -- --testPathPattern="Accordion|Tabs|DashboardLayout|Sheet" --silent` to verify tests still pass.
  </action>
  <verify>
`npx tsc --noEmit 2>&1 | grep "error TS" | grep -E "Accordion\.test|Tabs\.test|DashboardLayout\.test|Sheet\.test" | wc -l` returns 0.
`npm test -- --testPathPattern="Accordion\.test|Tabs\.test|DashboardLayout\.test|Sheet\.test" --silent` shows all tests passing.
  </verify>
  <done>Accordion.test.tsx, Tabs.test.tsx, DashboardLayout.test.tsx, and Sheet.test.tsx compile with zero tsc errors and all tests pass.</done>
</task>

<task type="auto">
  <name>Task 2: Fix mock types in Select, accessibility, Popover, Modal tests</name>
  <files>
    app/components/ui/__tests__/Select.test.tsx
    app/components/ui/__tests__/accessibility.test.tsx
    app/components/ui/__tests__/Popover.test.tsx
    app/components/ui/__tests__/Modal.test.tsx
  </files>
  <action>
Fix all tsc errors in these 4 files (100 total errors). Run `npx tsc --noEmit 2>&1 | grep "error TS" | grep -E "Select\.test|accessibility\.test|Popover\.test|Modal\.test"` to see exact errors.

Apply the same jest.mocked() pattern as Task 1:

1. Wrap all mocked imports with `jest.mocked()`.
2. For Radix UI mocks (Select, Popover use Radix primitives), apply `jest.mocked()` on the Radix import namespace.
3. Fix any component prop type mismatches in render calls.
4. For accessibility tests — these likely mock multiple components for a11y testing. Each mocked component needs `jest.mocked()`.
5. For Modal — likely uses Radix Dialog under the hood. Mock the Dialog primitive properly.

Import from `__tests__/__utils__/mockHelpers.ts` if mock utilities from Plan 43-01 are available and reduce boilerplate.

After fixing, run tests for these specific files to verify they still pass.
  </action>
  <verify>
`npx tsc --noEmit 2>&1 | grep "error TS" | grep -E "Select\.test|accessibility\.test|Popover\.test|Modal\.test" | wc -l` returns 0.
`npm test -- --testPathPattern="Select\.test|accessibility\.test|Popover\.test|Modal\.test" --silent` shows all tests passing.
  </verify>
  <done>Select.test.tsx, accessibility.test.tsx, Popover.test.tsx, and Modal.test.tsx compile with zero tsc errors and all tests pass.</done>
</task>

</tasks>

<verification>
- `npx tsc --noEmit 2>&1 | grep "error TS" | grep "app/components/ui/__tests__" | grep -E "Accordion|Tabs|DashboardLayout|Sheet|Select|accessibility|Popover|Modal" | wc -l` returns 0
- All 8 test files' tests still pass (no regressions)
- Mock typing uses jest.mocked() pattern, NOT `as any`
</verification>

<success_criteria>
- 688 mock type errors eliminated across 8 files (from ~1483 total test errors)
- All existing tests in these files continue to pass
- jest.mocked() pattern established and proven for UI component tests
</success_criteria>

<output>
After completion, create `.planning/phases/43-verification/43-03-SUMMARY.md`
</output>
