---
phase: 43-verification
plan: 06
type: execute
wave: 2
depends_on: ["43-01"]
files_modified:
  - app/components/ui/__tests__/Alert.test.tsx
  - app/components/ui/__tests__/Badge.test.tsx
  - app/components/ui/__tests__/Banner.test.tsx
  - app/components/ui/__tests__/Button.test.tsx
  - app/components/ui/__tests__/ButtonGroup.test.tsx
  - app/components/ui/__tests__/Card.test.tsx
  - app/components/ui/__tests__/Checkbox.test.tsx
  - app/components/ui/__tests__/Chip.test.tsx
  - app/components/ui/__tests__/ConfirmDialog.test.tsx
  - app/components/ui/__tests__/DeviceStatusIndicator.test.tsx
  - app/components/ui/__tests__/EmptyState.test.tsx
  - app/components/ui/__tests__/Heading.test.tsx
  - app/components/ui/__tests__/HealthIndicator.test.tsx
  - app/components/ui/__tests__/InfoBox.test.tsx
  - app/components/ui/__tests__/Input.test.tsx
  - app/components/ui/__tests__/Kbd.test.tsx
  - app/components/ui/__tests__/Label.test.tsx
  - app/components/ui/__tests__/PageLayout.test.tsx
  - app/components/ui/__tests__/RadioGroup.test.tsx
  - app/components/ui/__tests__/Skeleton.test.tsx
  - app/components/ui/__tests__/Switch.test.tsx
  - app/components/ui/__tests__/Text.test.tsx
  - app/components/ui/__tests__/Tooltip.test.tsx
  - app/hooks/__tests__/useVersionCheck.test.ts
  - app/hooks/__tests__/useSafeState.test.ts
  - app/hooks/__tests__/useHueConnection.test.ts
  - app/context/__tests__/VersionContext.test.tsx
  - app/thermostat/page.test.tsx
  - app/components/navigation/__tests__/DropdownComponents.test.tsx
  - __tests__/components/monitoring/StatusCards.test.tsx
  - __tests__/components/devices/thermostat/ThermostatCard.schedule.test.tsx
  - __tests__/maintenanceService.concurrency.test.ts
autonomous: true

must_haves:
  truths:
    - "All remaining test files compile without tsc errors"
    - "Combined with plans 03-05, zero test file tsc errors remain"
    - "All existing tests still pass after type fixes"
  artifacts:
    - path: "app/components/ui/__tests__/PageLayout.test.tsx"
      provides: "PageLayout tests with proper mock typing"
      min_lines: 20
    - path: "__tests__/components/monitoring/StatusCards.test.tsx"
      provides: "StatusCards tests with proper discriminated union typing"
      min_lines: 30
  key_links:
    - from: "app/components/ui/__tests__/*.test.tsx"
      to: "app/components/ui/*.tsx"
      via: "component import + jest.mocked"
      pattern: "jest\\.mocked|jest\\.mock"
---

<objective>
Fix mock type errors in all remaining test files not covered by Plans 03-05 (~445 errors across ~44 files). This includes the 23 remaining UI component tests, app hooks/context tests, and scattered test files.

Purpose: After Plans 03-05 fix the high-error files, these remaining files have 1-15 errors each. Many follow identical patterns (jest.mocked on component imports, Radix mock typing). Batch processing is efficient here.

Output: All remaining test files compile with zero tsc errors. Combined with Plans 03-05, the entire test suite has zero tsc errors.
</objective>

<execution_context>
@/Users/federicomanfredi/.claude/get-shit-done/workflows/execute-plan.md
@/Users/federicomanfredi/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/43-verification/43-RESEARCH.md
@.planning/phases/43-verification/43-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix remaining UI component test mock types</name>
  <files>
    app/components/ui/__tests__/Alert.test.tsx
    app/components/ui/__tests__/Badge.test.tsx
    app/components/ui/__tests__/Banner.test.tsx
    app/components/ui/__tests__/Button.test.tsx
    app/components/ui/__tests__/ButtonGroup.test.tsx
    app/components/ui/__tests__/Card.test.tsx
    app/components/ui/__tests__/Checkbox.test.tsx
    app/components/ui/__tests__/Chip.test.tsx
    app/components/ui/__tests__/ConfirmDialog.test.tsx
    app/components/ui/__tests__/DeviceStatusIndicator.test.tsx
    app/components/ui/__tests__/EmptyState.test.tsx
    app/components/ui/__tests__/Heading.test.tsx
    app/components/ui/__tests__/HealthIndicator.test.tsx
    app/components/ui/__tests__/InfoBox.test.tsx
    app/components/ui/__tests__/Input.test.tsx
    app/components/ui/__tests__/Kbd.test.tsx
    app/components/ui/__tests__/Label.test.tsx
    app/components/ui/__tests__/PageLayout.test.tsx
    app/components/ui/__tests__/RadioGroup.test.tsx
    app/components/ui/__tests__/Skeleton.test.tsx
    app/components/ui/__tests__/Switch.test.tsx
    app/components/ui/__tests__/Text.test.tsx
    app/components/ui/__tests__/Tooltip.test.tsx
  </files>
  <action>
Fix all tsc errors in these 23 remaining UI component test files. These files have 1-15 errors each (most have fewer than 10).

Run `npx tsc --noEmit 2>&1 | grep "error TS" | grep "app/components/ui/__tests__" | grep -v -E "Accordion|Tabs|DashboardLayout|Sheet|Select|accessibility|Popover|Modal"` to get the exact error list (excluding files already fixed in Plan 03).

**Batch-safe patterns (apply to all files):**

1. **jest.mocked() for component mocks:** For each `jest.mock()` call, find corresponding imports and wrap with `jest.mocked()`.

2. **Radix primitive mocks:** Files testing Radix-based components (Checkbox, RadioGroup, Switch, Tooltip) need `jest.mocked()` on Radix imports.

3. **Component prop type mismatches:** Some test render calls pass props that don't match the typed component interface. Fix by:
   - Adding missing required props to render calls
   - Removing invalid prop values
   - Using correct variant literal types

4. **TS2339 (Property does not exist):** Usually from accessing mock methods (.mockReturnValue, .mockImplementation) on non-mocked imports. Fix with `jest.mocked()`.

5. **TS2741 (Missing required property):** Add the missing property to test fixtures/render props.

**Files likely needing special attention:**
- **PageLayout.test.tsx:** May need proper layout context provider typing
- **EmptyState.test.tsx:** Check for missing props in test renders
- **ConfirmDialog.test.tsx:** Dialog component may use Radix AlertDialog

After fixing all 23 files, run their tests to verify no regressions.
  </action>
  <verify>
`npx tsc --noEmit 2>&1 | grep "error TS" | grep "app/components/ui/__tests__" | wc -l` returns 0 (ALL UI component tests, including those from Plan 03).
`npm test -- --testPathPattern="app/components/ui/__tests__" --silent` shows all tests passing.
  </verify>
  <done>All 23 remaining UI component test files compile with zero tsc errors and all tests pass.</done>
</task>

<task type="auto">
  <name>Task 2: Fix app hooks, context, and remaining scattered test files</name>
  <files>
    app/hooks/__tests__/useVersionCheck.test.ts
    app/hooks/__tests__/useSafeState.test.ts
    app/hooks/__tests__/useHueConnection.test.ts
    app/context/__tests__/VersionContext.test.tsx
    app/thermostat/page.test.tsx
    app/components/navigation/__tests__/DropdownComponents.test.tsx
    __tests__/components/monitoring/StatusCards.test.tsx
    __tests__/components/devices/thermostat/ThermostatCard.schedule.test.tsx
    __tests__/maintenanceService.concurrency.test.ts
  </files>
  <action>
Fix all tsc errors in these 9 remaining test files. Run `npx tsc --noEmit 2>&1 | grep "error TS" | grep -E "app/hooks/__tests__|app/context/__tests__|app/thermostat/page\.test|app/components/navigation|__tests__/components/(monitoring|devices)|__tests__/maintenanceService"` to see exact errors.

**app/hooks/__tests__/ (3 files, ~30 errors):**
- useVersionCheck.test.ts (15 errors): Mock fetch and version checking utilities with `jest.mocked()`.
- useSafeState.test.ts: Hook testing utilities, likely simple mock typing fixes.
- useHueConnection.test.ts: Mock Hue connection service with `jest.mocked()`.

**app/context/__tests__/VersionContext.test.tsx (10 errors):**
- Context provider test needs typed mock values matching the context interface.
- Apply `jest.mocked()` to any mocked dependencies.

**app/thermostat/page.test.tsx (1 error):**
- Likely a single type mismatch or missing mock typing.

**DropdownComponents.test.tsx:**
- Navigation component test. Apply `jest.mocked()` to component imports.
- Fix component prop types in render calls.

**StatusCards.test.tsx (15 errors):**
- Monitoring component test. Errors likely from:
  - Missing required `error` field in test fixtures
  - Discriminated union property access without type narrowing
  - Apply `jest.mocked()` and add complete test fixture data

**ThermostatCard.schedule.test.tsx:**
- Thermostat card schedule section test. Fix mock data types and component prop types.

**maintenanceService.concurrency.test.ts (13 errors):**
- Firebase and maintenance service mocks. Apply `jest.mocked()` pattern.

After ALL plans 03-06 are complete, run a full tsc check to verify ZERO test file errors remain:
`npx tsc --noEmit 2>&1 | grep "error TS" | grep -E "__tests__|\.test\." | wc -l` should return 0.
  </action>
  <verify>
`npx tsc --noEmit 2>&1 | grep "error TS" | grep -E "app/hooks/__tests__|app/context/__tests__|app/thermostat/page\.test|app/components/navigation|__tests__/components|__tests__/maintenanceService" | wc -l` returns 0.
`npm test -- --testPathPattern="useVersionCheck|useSafeState|useHueConnection|VersionContext|thermostat/page\.test|DropdownComponents|StatusCards|ThermostatCard\.schedule|maintenanceService\.concurrency" --silent` shows all tests passing.
  </verify>
  <done>All 9 remaining scattered test files compile with zero tsc errors and all tests pass. Combined with Plans 03-05, the entire test suite should have zero tsc errors.</done>
</task>

</tasks>

<verification>
- After this plan + Plans 03-05: `npx tsc --noEmit 2>&1 | grep "error TS" | grep -E "__tests__|\.test\." | wc -l` returns 0
- ALL test files pass: `npm test --silent` shows 0 failures from type-related changes
- No `as any` patterns introduced for mock typing
</verification>

<success_criteria>
- All remaining ~445 test file tsc errors eliminated
- Combined with Plans 03-05: zero test file tsc errors total
- All existing tests continue to pass
</success_criteria>

<output>
After completion, create `.planning/phases/43-verification/43-06-SUMMARY.md`
</output>
