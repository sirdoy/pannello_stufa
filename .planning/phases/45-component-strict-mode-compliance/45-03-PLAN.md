---
phase: 45-component-strict-mode-compliance
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - app/components/ui/DataTable.tsx
  - app/components/ui/DataTableToolbar.tsx
  - app/components/ui/FormModal.tsx
  - app/components/ui/HealthIndicator.tsx
  - app/components/ui/Checkbox.tsx
  - app/components/ui/Button.tsx
  - app/components/ui/CardAccentBar.tsx
  - app/components/ui/StatusBadge.tsx
  - app/components/ui/ConnectionStatus.tsx
  - app/components/ui/Section.tsx
  - app/components/ui/Select.tsx
  - app/components/ui/Slider.tsx
  - app/components/ui/Switch.tsx
  - app/components/ui/ToastProvider.tsx
  - app/components/ui/BottomSheet.tsx
  - app/components/ui/LoadingOverlay.tsx
  - app/components/ui/DeviceCard.tsx
  - app/components/ui/RadioGroup.tsx
  - app/components/ui/RoomSelector.tsx
  - app/components/ui/SmartHomeCard.tsx
autonomous: true

must_haves:
  truths:
    - "All 20 UI source component files have zero tsc errors under strict mode"
    - "DataTable sorting, filtering, and pagination still function"
    - "FormModal form submission and validation still work"
  artifacts:
    - path: "app/components/ui/DataTable.tsx"
      provides: "Strict-mode compliant DataTable with TanStack Table"
    - path: "app/components/ui/FormModal.tsx"
      provides: "Strict-mode compliant form modal"
  key_links:
    - from: "app/components/ui/DataTable.tsx"
      to: "@tanstack/react-table"
      via: "import"
      pattern: "import.*@tanstack/react-table"
---

<objective>
Fix all 56 strict-mode TypeScript errors across 20 UI source component files in app/components/ui/.

Purpose: Make all design system UI components strict-mode compliant. Most files have 1-3 small errors; DataTable (20) and DataTableToolbar (7) are the largest.
Output: All 20 UI component source files with zero tsc errors.
</objective>

<execution_context>
@/Users/federicomanfredi/.claude/get-shit-done/workflows/execute-plan.md
@/Users/federicomanfredi/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix strict-mode errors in DataTable.tsx and DataTableToolbar.tsx</name>
  <files>app/components/ui/DataTable.tsx, app/components/ui/DataTableToolbar.tsx</files>
  <action>
**DataTable.tsx (20 errors):**
- TS7006 (noImplicitAny) ~4: Add parameter types to callback functions. For TanStack Table callbacks: use the generic `Row<TData>` and `Column<TData>` types from the import.
- TS7031 (binding element implicitly any) ~4: Add types to destructured parameters in render functions and callbacks.
- TS2322 (type mismatch) ~2: Fix prop type mismatches, likely in JSX attributes or state assignments.
- TS2339 (property does not exist) ~8: Properties accessed on generic `TData` type. Use type assertions or constrain `TData` generics. For column accessor: use `(row as Record<string, unknown>)[key]` or add proper generic constraints. If accessing `.getValue()` on cells, ensure the column definition types are correct.
- Other ~2: Additional type fixes.

Key approach for DataTable generics:
- The component uses `<TData>` generic. Ensure all internal usage properly threads this generic.
- For column rendering: `flexRender(cell.column.columnDef.cell, cell.getContext())` should already be typed.
- For row selection: Ensure `onRowClick` callback gets `Row<TData>` type.

**DataTableToolbar.tsx (7 errors):**
- TS2345 (argument type) ~1: Fix argument type passed to filter/sort functions.
- TS7006 (noImplicitAny) ~4: Add types to event handlers and callback params.
- TS2322 (type mismatch) ~1: Fix prop or state type mismatch.
- Other ~1: Additional type fix.

Do NOT change any table rendering, sorting, or filtering behavior.
  </action>
  <verify>npx tsc --noEmit 2>&1 | grep -E "app/components/ui/DataTable(Toolbar)?\.tsx" | wc -l returns 0</verify>
  <done>DataTable.tsx (0 errors, was 20) and DataTableToolbar.tsx (0 errors, was 7) compile cleanly.</done>
</task>

<task type="auto">
  <name>Task 2: Fix strict-mode errors in 18 remaining UI components</name>
  <files>app/components/ui/FormModal.tsx, app/components/ui/HealthIndicator.tsx, app/components/ui/Checkbox.tsx, app/components/ui/Button.tsx, app/components/ui/CardAccentBar.tsx, app/components/ui/StatusBadge.tsx, app/components/ui/ConnectionStatus.tsx, app/components/ui/Section.tsx, app/components/ui/Select.tsx, app/components/ui/Slider.tsx, app/components/ui/Switch.tsx, app/components/ui/ToastProvider.tsx, app/components/ui/BottomSheet.tsx, app/components/ui/LoadingOverlay.tsx, app/components/ui/DeviceCard.tsx, app/components/ui/RadioGroup.tsx, app/components/ui/RoomSelector.tsx, app/components/ui/SmartHomeCard.tsx</files>
  <action>
Fix 29 errors across 18 files. Most files have 1-3 errors each — batch efficiently.

**Common error patterns and fixes:**

TS2538 (type null/undefined cannot be used as index type) — 8 occurrences across Button(2), Checkbox(2), HealthIndicator(3), ConnectionStatus(1), Section(1):
- These occur when a CVA variant key could be null/undefined. Fix: add nullish coalescing to default value, e.g., `variants[variant ?? 'default']` or add a type guard.

TS7006 (noImplicitAny) — 8 occurrences across FormModal(2), Select(1), Slider(1), StatusBadge(2), Switch(1), ToastProvider(1):
- Add explicit parameter types to event handlers and callbacks.
- FormModal: form field change handlers need `(e: React.ChangeEvent<HTMLInputElement>)` or similar.
- Select: `(value: string)` for onValueChange.
- Slider: `(value: number[])` for onValueChange.

TS7031 (binding element implicitly any) — 1 in FormModal:
- Add types to destructured callback parameters.

TS18047/TS18048 (possibly null/undefined) — 3 across FormModal(1), DeviceCard(1):
- Add null checks or optional chaining.

TS7016 (no declaration file) — 2 across BottomSheet(1), LoadingOverlay(1):
- Add `// @ts-expect-error no type declarations` or create minimal type declarations for untyped imports. Check what's being imported — if it's a CSS module or similar, use appropriate declaration.

TS2320 (interface cannot simultaneously extend) — 1 in RadioGroup:
- Fix interface extending conflicting types. Likely needs to use `Omit<>` to exclude conflicting properties before extending.

TS2322 (type mismatch) — 3 across RoomSelector(1), SmartHomeCard(1), other:
- Fix prop type mismatches with appropriate type narrowing.

Do NOT change any component visual behavior or API surface.
  </action>
  <verify>npx tsc --noEmit 2>&1 | grep "app/components/ui/" | grep -v "__tests__" | wc -l returns 0</verify>
  <done>All 18 remaining UI component files compile with zero tsc errors. Total: 20 UI source files, 0 errors (was 56).</done>
</task>

</tasks>

<verification>
```bash
# All UI source files must have zero errors (excluding tests)
npx tsc --noEmit 2>&1 | grep "app/components/ui/" | grep -v "__tests__" | wc -l
# Expected: 0

# Existing UI tests still pass
npx jest --testPathPattern="app/components/ui/__tests__" --passWithNoTests 2>&1 | tail -5
```
</verification>

<success_criteria>
- Zero tsc errors across all 20 UI source component files (was 56 total)
- DataTable generic type threading correct
- No component API surface changes
- Existing tests still pass
</success_criteria>

<output>
After completion, create `.planning/phases/45-component-strict-mode-compliance/45-03-SUMMARY.md`
</output>
