---
phase: 46-api-page-strict-mode-compliance
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - app/stove/scheduler/page.tsx
autonomous: true

must_haves:
  truths:
    - "Scheduler page compiles with zero tsc strict-mode errors"
    - "All scheduler function parameters are explicitly typed"
    - "All dynamic day/index access uses proper type guards"
    - "Scheduler page renders and functions identically to before"
  artifacts:
    - path: "app/stove/scheduler/page.tsx"
      provides: "Strict-mode compliant scheduler page"
      contains: "WeekSchedule"
  key_links:
    - from: "app/stove/scheduler/page.tsx"
      to: "lib/types"
      via: "ScheduleInterval, WeekSchedule types"
      pattern: "ScheduleInterval|WeekSchedule"
---

<objective>
Fix all 45 strict-mode TypeScript errors in the stove scheduler page.

Purpose: The scheduler page is the largest error source (45 of 231 errors). Fixing it eliminates ~19% of all phase 46 errors in one plan.
Output: `app/stove/scheduler/page.tsx` with zero tsc strict-mode errors.
</objective>

<execution_context>
@/Users/federicomanfredi/.claude/get-shit-done/workflows/execute-plan.md
@/Users/federicomanfredi/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@app/stove/scheduler/page.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Type all function parameters and variables in scheduler page</name>
  <files>app/stove/scheduler/page.tsx</files>
  <action>
Fix 45 tsc errors in app/stove/scheduler/page.tsx. The errors cluster into these categories:

**TS7006 (implicit any parameters) - 17 errors:**
- Line 325: `day`, `index`, `field`, `value` params — type as `(day: string, index: number, field: string, value: string | number)`
- Line 477: `day`, `index` params — type as `(day: string, index: number)`
- Line 487: `_`, `i` params — type as `(_: unknown, i: number)`
- Line 516: `sourceDay` param — type as `(sourceDay: string)`
- Line 523: `targetDays` param — type as `(targetDays: string[])`
- Line 538: `interval` param — type as `(interval: ScheduleInterval)`
- Line 642, 694, 717: `scheduleId` params — type as `(scheduleId: string)`
- Line 694: `newName` param — type as `newName: string`

**TS7031 (binding element implicit any) - 7 errors:**
- Line 570: `{ start, end, duration, power, fan }` — type the destructured param as `ScheduleInterval`
- Line 670: `{ name, copyFromId }` — type as `{ name: string; copyFromId?: string }`

**TS7034/TS7005 (variable implicit any) - 3 errors:**
- Line 167: `scheduleSlotsUnsubscribe` — type as `let scheduleSlotsUnsubscribe: (() => void) | null = null`
- Lines 174, 211 reference this variable

**TS7053 (implicit any index access) - 3 errors:**
- Line 326: index into WeekSchedule with `day` — use `day as keyof WeekSchedule`
- Line 539: similar pattern — cast to keyof

**TS2538 (invalid index type - null) - 4 errors:**
- Lines 487, 525, 574, 580: `selectedDay` used as index but can be null — add null guard: `if (!selectedDay) return;`

**TS2464 (computed property name type) - 2 errors:**
- Lines 488, 589: computed property `[selectedDay]` where selectedDay can be null — guarded by null check above

**TS2345 (argument type mismatch) - 5 errors:**
- Lines 492, 543, 594, 597, 604: `selectedDay` (which is `DayName | null`) passed where `DayName` expected — add non-null assertion after guard

**TS2322 (type assignment mismatch) - 2 errors:**
- Line 849: `SaveStatus | null` not assignable to `{ isSaving: boolean } | undefined` — use `saveStatus ?? undefined`
- Line 868-869: `string | null` not assignable to `string` — use `value ?? ''` or non-null assertion

**TS18046 (unknown catch errors) - 3 errors:**
- Lines 687, 710, 733: `error` is unknown — use `error instanceof Error ? error.message : String(error)`

**Established patterns from phases 44-45:**
- `error instanceof Error ? error.message : String(error)` for catch blocks
- `keyof typeof` / `as keyof` for safe dynamic index access
- Non-null assertions (`!`) where data known to exist after guard
- Nullish coalescing (`??`) for null-to-undefined/default conversions
- Explicit `Unsubscribe` type for Firebase listeners (or `(() => void) | null`)
  </action>
  <verify>npx tsc --noEmit 2>&1 | grep "app/stove/scheduler/page.tsx" | wc -l should return 0</verify>
  <done>Zero tsc errors in app/stove/scheduler/page.tsx. All 45 errors fixed with explicit types, null guards, and established patterns.</done>
</task>

<task type="auto">
  <name>Task 2: Verify scheduler page functionality preserved</name>
  <files>app/stove/scheduler/page.tsx</files>
  <action>
Run any existing tests that cover the scheduler page:

```bash
npx jest --testPathPatterns="scheduler" --passWithNoTests 2>&1
```

Also verify that the file still compiles cleanly:

```bash
npx tsc --noEmit 2>&1 | grep "app/stove/scheduler" | wc -l
```

Expected: 0 errors, tests pass (or no tests exist).
  </action>
  <verify>npx tsc --noEmit 2>&1 | grep "app/stove/scheduler/page.tsx" returns empty. Tests pass or skip with no failures.</verify>
  <done>Scheduler page has zero tsc strict-mode errors and all related tests pass.</done>
</task>

</tasks>

<verification>
```bash
# Zero errors in scheduler page
npx tsc --noEmit 2>&1 | grep "app/stove/scheduler/page.tsx" | wc -l
# Expected: 0
```
</verification>

<success_criteria>
- app/stove/scheduler/page.tsx compiles with zero tsc strict-mode errors
- All 45 errors fixed using established patterns (no new patterns needed)
- No behavioral changes to the scheduler page
</success_criteria>

<output>
After completion, create `.planning/phases/46-api-page-strict-mode-compliance/46-01-SUMMARY.md`
</output>
