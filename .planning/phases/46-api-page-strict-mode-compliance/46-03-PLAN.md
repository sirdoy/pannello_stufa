---
phase: 46-api-page-strict-mode-compliance
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - app/lights/scenes/page.tsx
  - app/(pages)/camera/CameraDashboard.tsx
  - app/(pages)/camera/events/CameraEventsPage.tsx
  - app/settings/notifications/history/page.tsx
  - app/log/page.tsx
  - app/thermostat/page.tsx
  - app/settings/page.tsx
  - app/settings/notifications/page.tsx
  - app/page.tsx
  - app/hooks/useContextMenuLongPress.ts
  - app/hooks/useLongPress.ts
  - eslint.config.ts
autonomous: true

must_haves:
  truths:
    - "All listed pages compile with zero tsc strict-mode errors"
    - "All hooks have explicitly typed parameters"
    - "Notification history page has typed DataTable accessors"
    - "Camera pages handle null/undefined properly"
  artifacts:
    - path: "app/lights/scenes/page.tsx"
      provides: "Strict-mode compliant scenes page"
    - path: "app/settings/notifications/history/page.tsx"
      provides: "Strict-mode compliant notification history page"
  key_links:
    - from: "app/settings/notifications/history/page.tsx"
      to: "app/components/ui/DataTable"
      via: "column definitions with typed getValue"
      pattern: "getValue|ColumnDef"
---

<objective>
Fix 33 strict-mode TypeScript errors across 12 smaller files: scenes page (12), notification history (10), camera pages (6), log page (3), hooks (3), and single-error pages (5).

Purpose: Clear all remaining page and hook errors that don't belong to the major page files or debug/API groupings.
Output: 12 files with zero tsc strict-mode errors each.
</objective>

<execution_context>
@/Users/federicomanfredi/.claude/get-shit-done/workflows/execute-plan.md
@/Users/federicomanfredi/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@app/lights/scenes/page.tsx
@app/settings/notifications/history/page.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix scenes page (12) and notification history page (10) errors</name>
  <files>
    app/lights/scenes/page.tsx
    app/settings/notifications/history/page.tsx
  </files>
  <action>
**app/lights/scenes/page.tsx — 12 errors:**

TS7006 (implicit any) - 4 errors:
- Line 111: `sceneId`, `sceneName` params — type as `(sceneId: string, sceneName: string)`
- Line 140: `data` param — type based on API response
- Line 164: `data` param — type based on API response

TS18046 (unknown catch) - 5 errors:
- Lines 98, 128, 160, 186, 210: `err` is unknown — use `err instanceof Error ? err.message : String(err)`

TS18047 (possibly null) - 3 errors:
- Lines 197, 205, 206: `scene` is possibly null — add `if (!scene) return;` guard before the block that uses scene

**app/settings/notifications/history/page.tsx — 10 errors:**

TS7031 (binding element implicit any) - 4 errors:
- Lines 72, 81, 101, 124: `getValue` in column cell render functions — type the destructuring param. These are DataTable column definitions. Type the cell parameter as `{ getValue: () => string }` or use the proper TanStack Table CellContext type (e.g., `CellContext<NotificationHistoryRow, string>`)

TS7053 (implicit any index access) - 5 errors:
- Line 30: string index into type map — use `as keyof typeof typeColorMap`
- Lines 91, 114, 115: `getValue()` result used to index a color/status map — the getValue return is `any` because of the binding element; once binding element is typed, these resolve
- Line 220: `row` parameter in sort function

TS7006 (implicit any parameters) - 2 errors:
- Lines 220, 221: `row` params in sort callback — type as the DataTable row type

Define a `NotificationHistoryRow` interface at the top of the file for the row data shape, then use it in column definitions.
  </action>
  <verify>npx tsc --noEmit 2>&1 | grep -E "(scenes/page|history/page)" | wc -l should return 0</verify>
  <done>Zero tsc errors in scenes page (12 fixed) and notification history page (10 fixed).</done>
</task>

<task type="auto">
  <name>Task 2: Fix camera pages (6), log page (3), hooks (3), and single-error files (5)</name>
  <files>
    app/(pages)/camera/CameraDashboard.tsx
    app/(pages)/camera/events/CameraEventsPage.tsx
    app/log/page.tsx
    app/hooks/useContextMenuLongPress.ts
    app/hooks/useLongPress.ts
    app/thermostat/page.tsx
    app/settings/page.tsx
    app/settings/notifications/page.tsx
    app/page.tsx
    eslint.config.ts
  </files>
  <action>
**app/(pages)/camera/CameraDashboard.tsx — 3 errors:**
- Lines 98, 105: `err` is unknown (TS18046) — `err instanceof Error ? err.message : String(err)`
- Line 313: `string | null` not assignable to `string` (TS2322) — use `value ?? ''` or non-null assertion

**app/(pages)/camera/events/CameraEventsPage.tsx — 3 errors:**
- Line 119: `event` implicit any (TS7006) — type the parameter based on context
- Line 122: `html` implicit any (TS7006) — type as `string`
- Line 376: `ParsedCamera | undefined` not assignable to `ParsedCamera | null` (TS2322) — use `value ?? null` to convert undefined to null

**app/log/page.tsx — 3 errors:**
- Line 116: `undefined` used as index type (TS2538) — add undefined guard
- Line 129: implicit any index (TS7053) — use `as keyof typeof colorMap`
- Line 267: function type mismatch (TS2322) — match the expected signature `(timestamp: string | number) => string`

**app/hooks/useContextMenuLongPress.ts — 2 errors:**
- Line 65: `event` and `meta` implicit any (TS7006) — type based on the handler context (likely `React.TouchEvent | React.MouseEvent` and metadata type)

**app/hooks/useLongPress.ts — 1 error:**
- Line 106: `e` implicit any (TS7006) — type as the appropriate event type

**Single-error files:**
- `app/thermostat/page.tsx` line 483: string index into mode map (TS7053) — `as keyof typeof modeConfig`
- `app/settings/page.tsx` line 690: `value` implicit any (TS7006) — type parameter
- `app/settings/notifications/page.tsx` line 32: no declaration file for useNotificationPreferences (TS7016) — add `// @ts-expect-error no type definitions for useNotificationPreferences` (same pattern as phase 45-04)
- `app/page.tsx` line 35: `session` possibly null (TS18047) — add null guard
- `eslint.config.ts`: module declaration issue (TS7016) — add `// @ts-expect-error` for untyped eslint plugin
  </action>
  <verify>npx tsc --noEmit 2>&1 | grep -E "(camera/|log/page|hooks/use|thermostat/page|settings/(page|notifications/page)|app/page\.tsx|eslint\.config)" | wc -l should return 0</verify>
  <done>Zero tsc errors in all 10 files. All 17 errors fixed.</done>
</task>

</tasks>

<verification>
```bash
# Zero errors in all files
npx tsc --noEmit 2>&1 | grep -E "(scenes/page|history/page|camera/|log/page|hooks/use|thermostat/page|settings/(page|notifications/page)|app/page\.tsx|eslint\.config)" | wc -l
# Expected: 0
```
</verification>

<success_criteria>
- All 12 files compile with zero tsc strict-mode errors
- 33 total errors fixed across all files
- No behavioral changes to any page or hook
</success_criteria>

<output>
After completion, create `.planning/phases/46-api-page-strict-mode-compliance/46-03-SUMMARY.md`
</output>
