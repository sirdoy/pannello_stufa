---
phase: 47-test-strict-mode-and-index-access
plan: 05
type: execute
wave: 2
depends_on: [47-01, 47-02, 47-03]
files_modified:
  - app/debug/design-system/page.tsx
  - app/stove/scheduler/page.tsx
  - app/components/scheduler/AddIntervalModal.tsx
  - app/components/scheduler/DayAccordionItem.tsx
  - app/components/scheduler/TimeBar.tsx
  - app/components/scheduler/WeeklyTimeline.tsx
  - app/components/scheduler/ScheduleInterval.tsx
  - app/components/scheduler/IntervalBottomSheet.tsx
  - app/components/scheduler/WeeklySummaryCard.tsx
autonomous: true

must_haves:
  truths:
    - "design-system page has zero tsc errors with noUncheckedIndexedAccess"
    - "All scheduler components have zero tsc errors with noUncheckedIndexedAccess"
    - "Stove scheduler page has zero tsc errors with noUncheckedIndexedAccess"
  artifacts:
    - path: "app/debug/design-system/page.tsx"
      provides: "Index-access-safe design system documentation page"
    - path: "app/components/scheduler/AddIntervalModal.tsx"
      provides: "Index-access-safe scheduler interval modal"
    - path: "app/stove/scheduler/page.tsx"
      provides: "Index-access-safe stove scheduler page"
  key_links:
    - from: "app/components/scheduler/*.tsx"
      to: "lib/schedulerService.ts"
      via: "schedule data types"
      pattern: "import.*schedulerService"
---

<objective>
Fix 117 noUncheckedIndexedAccess errors across the design-system page (56 errors) and 8 scheduler-related source files (61 errors).

Purpose: These two clusters represent the largest source-file error concentrations. The design-system page has heavy array/object access for component examples, and scheduler components access schedule interval arrays extensively.
Output: Design-system page and all scheduler components compile cleanly with noUncheckedIndexedAccess.
</objective>

<execution_context>
@/Users/federicomanfredi/.claude/get-shit-done/workflows/execute-plan.md
@/Users/federicomanfredi/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@app/debug/design-system/page.tsx
@app/components/scheduler/AddIntervalModal.tsx
@app/stove/scheduler/page.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix design-system page (56 errors) and stove scheduler page (15 errors)</name>
  <files>app/debug/design-system/page.tsx, app/stove/scheduler/page.tsx</files>
  <action>
Fix 71 noUncheckedIndexedAccess errors in these 2 pages.

**design-system/page.tsx (56 errors):**
This page has heavy use of example arrays and object lookups for component documentation. Errors are mostly from:
- Array index access: `examples[0]` becomes `examples[0] | undefined`
- Object key lookup: `variantMap[variant]` becomes `variantMap[variant] | undefined`
- Component prop arrays: accessing items in prop example arrays

Fix strategies:
1. For array access where index is known valid (e.g., after `.map()`, known-length arrays): use non-null assertion `!`
2. For object key lookup with known keys: use `as Record<string, T>` or cast the key type
3. For example data arrays: add undefined checks or use nullish coalescing
4. Consider adding helper: `function defined<T>(x: T | undefined): T { if (x === undefined) throw new Error('unexpected undefined'); return x; }` if many assertions needed

**stove/scheduler/page.tsx (15 errors):**
Schedule interval access and day-of-week lookup. Similar patterns:
- `schedule.intervals[dayIndex]` needs undefined check
- `dayNames[day]` object lookup needs null handling
- Fix with optional chaining and nullish coalescing

Run tsc to verify both files clean.
  </action>
  <verify>npx tsc --noEmit 2>&1 | grep -c "design-system/page\|stove/scheduler/page" outputs 0</verify>
  <done>Both pages compile cleanly with noUncheckedIndexedAccess. Design-system page renders correctly.</done>
</task>

<task type="auto">
  <name>Task 2: Fix 7 scheduler components (46 errors total)</name>
  <files>
    app/components/scheduler/AddIntervalModal.tsx,
    app/components/scheduler/DayAccordionItem.tsx,
    app/components/scheduler/TimeBar.tsx,
    app/components/scheduler/WeeklyTimeline.tsx,
    app/components/scheduler/ScheduleInterval.tsx,
    app/components/scheduler/IntervalBottomSheet.tsx,
    app/components/scheduler/WeeklySummaryCard.tsx
  </files>
  <action>
Fix 46 noUncheckedIndexedAccess errors across 7 scheduler components. These components work with schedule interval arrays and time slot data.

Common patterns in scheduler:
- `intervals[index]` — Array access by computed index. Add `if (!intervals[index]) return;` guard or use `!` after bounds check.
- `daySchedule[dayOfWeek]` — Object property by string key. Use `daySchedule[dayOfWeek] ?? []` for array defaults.
- `timeSlots[i]` — Iteration access. Inside `.map()` callback the element is already typed, but direct index access needs handling.
- `selectedInterval?.zones[0]` — Nested array access. Use `selectedInterval?.zones[0] ?? defaultZone`.

For each file:
1. Read the tsc errors with `npx tsc --noEmit 2>&1 | grep "FileName"`
2. Add appropriate undefined handling (prefer nullish coalescing > optional chaining > non-null assertion)
3. Verify the file compiles cleanly

After all 7 files, verify the full scheduler directory is clean:
```bash
npx tsc --noEmit 2>&1 | grep "scheduler" | grep -v test | wc -l
```
  </action>
  <verify>npx tsc --noEmit 2>&1 | grep "scheduler" | grep -v "test" | grep -c "error TS" outputs 0</verify>
  <done>All 7 scheduler components compile cleanly with noUncheckedIndexedAccess. Scheduler UI functions correctly.</done>
</task>

</tasks>

<verification>
```bash
# Verify zero errors in design-system and scheduler files
npx tsc --noEmit 2>&1 | grep "error TS" | grep "design-system\|scheduler" | grep -v test | wc -l
# Expected: 0

# Verify dev server can render these pages
# (manual check if needed)
```
</verification>

<success_criteria>
- 0 tsc errors in app/debug/design-system/page.tsx (was 56)
- 0 tsc errors in app/stove/scheduler/page.tsx (was 15)
- 0 tsc errors in all 7 app/components/scheduler/*.tsx files (was 46)
- Total: 117 noUncheckedIndexedAccess errors resolved
</success_criteria>

<output>
After completion, create `.planning/phases/47-test-strict-mode-and-index-access/47-05-SUMMARY.md`
</output>
