---
phase: 47-test-strict-mode-and-index-access
plan: 06
type: execute
wave: 2
depends_on: [47-01, 47-02, 47-03]
files_modified:
  - app/debug/components/tabs/StoveTab.tsx
  - app/debug/api/components/tabs/StoveTab.tsx
  - app/debug/components/tabs/NetatmoTab.tsx
  - app/debug/api/components/tabs/NetatmoTab.tsx
  - app/debug/components/tabs/HueTab.tsx
  - app/debug/api/components/tabs/HueTab.tsx
  - app/debug/components/tabs/FirebaseTab.tsx
  - app/debug/api/components/tabs/FirebaseTab.tsx
  - app/debug/components/tabs/SchedulerTab.tsx
  - app/debug/api/components/tabs/SchedulerTab.tsx
  - app/debug/components/tabs/WeatherTab.tsx
  - app/debug/api/components/tabs/WeatherTab.tsx
  - app/debug/stove/page.tsx
  - app/debug/notifications/page.tsx
  - app/debug/notifications/components/DeliveryChart.tsx
  - app/debug/api/page.tsx
  - app/api/netatmo/homesdata/route.ts
  - app/api/notifications/register/route.ts
  - app/api/netatmo/devices-temperatures/route.ts
  - app/api/geocoding/reverse/route.ts
  - app/api/admin/sync-changelog/route.ts
  - app/api/netatmo/camera/route.ts
  - app/api/netatmo/calibrate/route.ts
  - app/api/health-monitoring/logs/route.ts
autonomous: true

must_haves:
  truths:
    - "All debug tab components have zero tsc errors with noUncheckedIndexedAccess"
    - "All debug pages have zero tsc errors with noUncheckedIndexedAccess"
    - "All API routes have zero tsc errors with noUncheckedIndexedAccess"
  artifacts:
    - path: "app/debug/components/tabs/StoveTab.tsx"
      provides: "Index-access-safe debug stove tab"
    - path: "app/debug/api/components/tabs/StoveTab.tsx"
      provides: "Index-access-safe debug API stove tab"
    - path: "app/api/netatmo/homesdata/route.ts"
      provides: "Index-access-safe homesdata API route"
  key_links:
    - from: "app/debug/components/tabs/*.tsx"
      to: "app/debug/api/components/tabs/*.tsx"
      via: "mirrored structure"
      pattern: "identical error patterns"
---

<objective>
Fix ~95 noUncheckedIndexedAccess errors across debug tabs (12 files, ~74 errors), debug pages (4 files, ~10 errors), and API routes (7 files, ~11 errors).

Purpose: Debug tabs come in mirrored pairs (app/debug/components/ and app/debug/api/components/) with identical error patterns. Fixing them together ensures consistency. API routes have minimal errors (1-7 each) for quick fixes.
Output: All debug and API route source files compile cleanly with noUncheckedIndexedAccess.
</objective>

<execution_context>
@/Users/federicomanfredi/.claude/get-shit-done/workflows/execute-plan.md
@/Users/federicomanfredi/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@app/debug/components/tabs/StoveTab.tsx
@app/debug/api/components/tabs/StoveTab.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix 12 debug tab components (74 errors) and 4 debug pages (10 errors)</name>
  <files>
    app/debug/components/tabs/StoveTab.tsx, app/debug/api/components/tabs/StoveTab.tsx,
    app/debug/components/tabs/NetatmoTab.tsx, app/debug/api/components/tabs/NetatmoTab.tsx,
    app/debug/components/tabs/HueTab.tsx, app/debug/api/components/tabs/HueTab.tsx,
    app/debug/components/tabs/FirebaseTab.tsx, app/debug/api/components/tabs/FirebaseTab.tsx,
    app/debug/components/tabs/SchedulerTab.tsx, app/debug/api/components/tabs/SchedulerTab.tsx,
    app/debug/components/tabs/WeatherTab.tsx, app/debug/api/components/tabs/WeatherTab.tsx,
    app/debug/stove/page.tsx, app/debug/notifications/page.tsx,
    app/debug/notifications/components/DeliveryChart.tsx, app/debug/api/page.tsx
  </files>
  <action>
Fix 84 noUncheckedIndexedAccess errors across 16 debug files.

**Key insight:** Debug tabs under `app/debug/components/tabs/` and `app/debug/api/components/tabs/` are mirrored pairs. Each pair (e.g., StoveTab.tsx) has the same error patterns. Fix one, then apply the same pattern to its mirror.

Common patterns in debug tabs:
- API response data access: `data.devices[0]` → `data.devices[0]!` (after existence check) or `data.devices?.[0]`
- Status object property: `status[key]` → `status[key] ?? 'unknown'`
- Array destructuring: `const [first] = arr` → `const first = arr[0]; if (!first) return;`
- Nested data: `room.modules[0].data[key]` → chain with optional: `room.modules?.[0]?.data?.[key]`

For StoveTab (12+12 = 24 errors): Stove state/data property access
For NetatmoTab (8+8 = 16 errors): Netatmo room/module data access
For HueTab (7+7 = 14 errors): Hue light/scene data access
For FirebaseTab (5+5 = 10 errors): Firebase data access
For SchedulerTab (4+4 = 8 errors): Schedule data access
For WeatherTab (1+1 = 2 errors): Weather data access
For debug pages (10 errors): Mixed data access patterns

Run `npx tsc --noEmit 2>&1 | grep "error TS" | grep "debug/" | grep -v test | wc -l` to verify.
  </action>
  <verify>npx tsc --noEmit 2>&1 | grep "debug/" | grep -v "test" | grep -c "error TS" outputs 0</verify>
  <done>All 16 debug files compile cleanly with noUncheckedIndexedAccess.</done>
</task>

<task type="auto">
  <name>Task 2: Fix 7 API route files (11 errors total)</name>
  <files>
    app/api/netatmo/homesdata/route.ts,
    app/api/notifications/register/route.ts,
    app/api/netatmo/devices-temperatures/route.ts,
    app/api/geocoding/reverse/route.ts,
    app/api/admin/sync-changelog/route.ts,
    app/api/netatmo/camera/route.ts,
    app/api/netatmo/calibrate/route.ts,
    app/api/health-monitoring/logs/route.ts
  </files>
  <action>
Fix 11 noUncheckedIndexedAccess errors across 7 API routes (1-7 errors each).

- homesdata/route.ts (7 errors): Netatmo API response data — nested room/module access. Use optional chaining for response.body.homes[0]?.rooms etc.
- notifications/register/route.ts (3 errors): Token data access. Add undefined check before using.
- devices-temperatures/route.ts (2 errors): Temperature data array access. Use nullish coalescing.
- geocoding/reverse/route.ts (2 errors): Geocoding result access. Add undefined check.
- sync-changelog/route.ts (2 errors): Changelog entry access. Nullish coalescing.
- camera/route.ts (1 error): Camera data access. Non-null assertion after validation.
- calibrate/route.ts (1 error): Calibration data access. Non-null assertion.
- health-monitoring/logs/route.ts (1 error): Log entry access. Non-null assertion.

Each is a quick fix. Run tsc to verify zero API route errors.
  </action>
  <verify>npx tsc --noEmit 2>&1 | grep "app/api/" | grep -v "test" | grep -c "error TS" outputs 0</verify>
  <done>All 7 API route files compile cleanly with noUncheckedIndexedAccess.</done>
</task>

</tasks>

<verification>
```bash
# Verify zero errors in debug and API files
npx tsc --noEmit 2>&1 | grep "error TS" | grep "debug/\|app/api/" | grep -v test | wc -l
# Expected: 0
```
</verification>

<success_criteria>
- 0 tsc errors in all 12 debug tab components (was 74)
- 0 tsc errors in all 4 debug pages (was 10)
- 0 tsc errors in all 7 API routes (was 11)
- Total: ~95 noUncheckedIndexedAccess errors resolved
</success_criteria>

<output>
After completion, create `.planning/phases/47-test-strict-mode-and-index-access/47-06-SUMMARY.md`
</output>
