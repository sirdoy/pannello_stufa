---
phase: 47-test-strict-mode-and-index-access
plan: 10
type: execute
wave: 4
depends_on: [47-08, 47-09]
files_modified: []
autonomous: true

must_haves:
  truths:
    - "npx tsc --noEmit reports zero errors with strict + noUncheckedIndexedAccess"
    - "npx jest reports zero failures across all 3032+ tests"
    - "tsconfig.json has strict: true and noUncheckedIndexedAccess: true"
  artifacts:
    - path: "tsconfig.json"
      provides: "Full strict TypeScript configuration"
      contains: "noUncheckedIndexedAccess"
  key_links:
    - from: "tsconfig.json"
      to: "all .ts/.tsx files"
      via: "compiler options"
      pattern: "strict.*true.*noUncheckedIndexedAccess.*true"
---

<objective>
Gap sweep: verify zero tsc errors and zero test failures after all Wave 1-3 plans complete. Fix any cascade errors from parallel execution.

Purpose: Previous phases have shown that parallel wave execution can produce cascade effects (Phase 45 had 16 cascade errors, Phase 46 had 0). This sweep catches any remaining issues.
Output: Verified clean codebase — zero tsc errors, zero test failures, all Phase 47 success criteria met.
</objective>

<execution_context>
@/Users/federicomanfredi/.claude/get-shit-done/workflows/execute-plan.md
@/Users/federicomanfredi/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Run tsc --noEmit and fix any cascade errors</name>
  <files>(any files with remaining errors)</files>
  <action>
Run full TypeScript check:
```bash
npx tsc --noEmit 2>&1 | grep -c "error TS"
```

**If zero errors:** Document and proceed to Task 2.

**If errors remain (cascade from parallel execution):**
1. List all errors: `npx tsc --noEmit 2>&1 | grep "error TS"`
2. Group by file and error type
3. Fix each error using established patterns:
   - TS7005/TS7034: Add jest.Mock type annotations
   - TS18047/TS18048: Add null/undefined checks
   - TS2322/TS2345: Fix type mismatches
   - TS2532: Add non-null assertions after guards
4. Re-run tsc to verify zero errors

Report the count of cascade errors found and fixed.
  </action>
  <verify>npx tsc --noEmit 2>&1 | grep -c "error TS" outputs 0</verify>
  <done>Zero tsc errors with strict: true + noUncheckedIndexedAccess: true.</done>
</task>

<task type="auto">
  <name>Task 2: Run full test suite and verify zero failures + document final state</name>
  <files>(any files with test fixes needed)</files>
  <action>
Run full test suite:
```bash
npx jest 2>&1 | tail -10
```

**If zero failures:** Document final numbers.

**If failures remain:**
1. Identify failing tests
2. Determine if failure is from type fix changes (regression) or pre-existing
3. Fix regressions
4. Re-run full suite

**Final documentation — verify all Phase 47 success criteria:**

1. ✅/❌ All test files pass strict TypeScript checks with proper mock typing
   - Verify: `npx tsc --noEmit 2>&1 | grep "error TS" | grep "test\.\|__tests__" | wc -l` = 0

2. ✅/❌ noUncheckedIndexedAccess: true enabled
   - Verify: `grep "noUncheckedIndexedAccess" tsconfig.json` shows true

3. ✅/❌ FormModal cancel test passes green
   - Verify: `npx jest FormModal 2>&1 | grep "cancel"` shows pass

4. ✅/❌ Worker teardown warning resolved
   - Verify: document status

5. ✅/❌ All 3032+ tests passing green
   - Verify: `npx jest 2>&1 | grep "Tests:"` shows 0 failed

Report all metrics in the SUMMARY.md.
  </action>
  <verify>npx jest 2>&1 | grep "Tests:" shows 0 failed AND npx tsc --noEmit 2>&1 | grep -c "error TS" outputs 0</verify>
  <done>Phase 47 complete. All 5 success criteria verified. Zero tsc errors, zero test failures.</done>
</task>

</tasks>

<verification>
```bash
# Critical verification 1: zero tsc errors
npx tsc --noEmit 2>&1 | grep -c "error TS"
# Expected: 0

# Critical verification 2: zero test failures
npx jest 2>&1 | tail -5
# Expected: Tests: X passed, X total (0 failed)

# Critical verification 3: tsconfig has correct options
grep -E "strict|noUncheckedIndexedAccess" tsconfig.json
# Expected: "strict": true, "noUncheckedIndexedAccess": true
```
</verification>

<success_criteria>
- 0 cascade errors (or all fixed)
- 0 tsc errors total
- 0 test failures
- All Phase 47 requirements (STRICT-02 test, STRICT-07, STRICT-08, TEST-01, TEST-02, TEST-03) verified
</success_criteria>

<output>
After completion, create `.planning/phases/47-test-strict-mode-and-index-access/47-10-SUMMARY.md`
</output>
